Wed, 25 Dec 2024 15:09:00 shadow.py[line:150] INFO {'dataset': 'ml-100k', 'model': 'BERT4Rec', 'split_seed': 2, 'gpu': 1, 'split_cf': 'split', 'train_cf': 'train'}
Wed, 25 Dec 2024 15:09:00 utils.py[line:224] INFO dataset is read from ../datasets/ml-100k.
Wed, 25 Dec 2024 15:09:01 utils.py[line:38] INFO 
Dataset Info: 

==================================================
item information: 
field     item_id   
type      token     
##        1153      
==================================================
user information: 
field     user_id   
type      token     
##        944       
==================================================
interaction information: 
field     user_id   item_id   rating    timestamp 
type      token     token     float     float     
##        944       1153      -         -         
==================================================
Sparsity: 0.909832
==================================================
Wed, 25 Dec 2024 15:09:02 utils.py[line:297] INFO Global seed set to 2019
Wed, 25 Dec 2024 15:09:02 utils.py[line:62] INFO 
Model Config: 

accelerator=gpu
activation=gelu
ann=None
batch_size=1024
cutoff=10
dataset_neg_count=None
dataset_sampler=None
dropout=0.2
early_stop_mode=max
early_stop_patience=20
embed_dim=64
epochs=100
eval_batch_size=128
excluding_hist=False
gpu=[1]
head_num=2
hidden_size=128
item_bias=False
layer_norm_eps=1e-12
layer_num=2
learner=adam
learning_rate=0.001
mask_ratio=0.2
negative_count=1
num_workers=0
pooling_type=mask
save_path=./saved/
scheduler=None
seed=2019
split_ratio=2
steal=False
test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
test_repetitive=True
topk=100
train_repetitive=True
val_metrics=['recall', 'ndcg']
weight_decay=1e-05
Wed, 25 Dec 2024 15:09:02 utils.py[line:297] INFO Global seed set to 2019
Wed, 25 Dec 2024 15:09:02 utils.py[line:62] INFO 
Model Config: 

accelerator=gpu
activation=gelu
ann=None
batch_size=1024
cutoff=10
dataset_neg_count=None
dataset_sampler=None
dropout=0.2
early_stop_mode=max
early_stop_patience=20
embed_dim=64
epochs=100
eval_batch_size=128
excluding_hist=False
gpu=[1]
head_num=2
hidden_size=128
item_bias=False
layer_norm_eps=1e-12
layer_num=2
learner=adam
learning_rate=0.001
mask_ratio=0.2
negative_count=1
num_workers=0
pooling_type=mask
save_path=./saved/
scheduler=None
seed=2019
split_ratio=2
steal=False
test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
test_repetitive=True
topk=100
train_repetitive=True
val_metrics=['recall', 'ndcg']
weight_decay=1e-05
Wed, 25 Dec 2024 15:09:02 recommender.py[line:128] INFO save_dir:/data1/home/zhihao/code/RecAudit/open-source/RecAudit/RecStudio-main
Wed, 25 Dec 2024 15:09:02 recommender.py[line:131] INFO BERT4Rec(
  (loss_fn): SoftmaxLoss()
  (score_func): InnerProductScorer()
  (item_encoder): Embedding(1154, 64, padding_idx=0)
  (query_encoder): BERT4RecQueryEncoder(
    (item_encoder): Embedding(1154, 64, padding_idx=0)
    (position_emb): Embedding(20, 64)
    (transformer_layer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
      )
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (training_pooling_layer): SeqPoolingLayer(pooling_type=mask, keepdim=False)
    (eval_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
  )
)
Wed, 25 Dec 2024 15:09:08 recommender.py[line:254] INFO Training: Epoch=  0 [recall@10=0.0478 ndcg@10=0.0212 train_loss=6.8114]
Wed, 25 Dec 2024 15:09:08 recommender.py[line:519] INFO Train time: 1.68660s. Valid time: 1.71925s
Wed, 25 Dec 2024 15:09:08 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0478
Wed, 25 Dec 2024 15:09:10 recommender.py[line:254] INFO Training: Epoch=  1 [recall@10=0.0573 ndcg@10=0.0339 train_loss=6.6090]
Wed, 25 Dec 2024 15:09:10 recommender.py[line:519] INFO Train time: 1.40664s. Valid time: 1.44704s
Wed, 25 Dec 2024 15:09:10 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0573
Wed, 25 Dec 2024 15:09:11 recommender.py[line:254] INFO Training: Epoch=  2 [recall@10=0.1274 ndcg@10=0.0623 train_loss=6.3576]
Wed, 25 Dec 2024 15:09:11 recommender.py[line:519] INFO Train time: 1.33330s. Valid time: 1.36898s
Wed, 25 Dec 2024 15:09:11 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1274
Wed, 25 Dec 2024 15:09:12 recommender.py[line:254] INFO Training: Epoch=  3 [recall@10=0.1561 ndcg@10=0.0726 train_loss=6.0513]
Wed, 25 Dec 2024 15:09:12 recommender.py[line:519] INFO Train time: 1.42788s. Valid time: 1.46735s
Wed, 25 Dec 2024 15:09:12 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1561
Wed, 25 Dec 2024 15:09:14 recommender.py[line:254] INFO Training: Epoch=  4 [recall@10=0.1561 ndcg@10=0.0756 train_loss=5.9180]
Wed, 25 Dec 2024 15:09:14 recommender.py[line:519] INFO Train time: 1.41268s. Valid time: 1.43669s
Wed, 25 Dec 2024 15:09:15 recommender.py[line:254] INFO Training: Epoch=  5 [recall@10=0.1656 ndcg@10=0.0725 train_loss=5.8383]
Wed, 25 Dec 2024 15:09:15 recommender.py[line:519] INFO Train time: 1.32511s. Valid time: 1.35277s
Wed, 25 Dec 2024 15:09:15 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1656
Wed, 25 Dec 2024 15:09:17 recommender.py[line:254] INFO Training: Epoch=  6 [recall@10=0.1497 ndcg@10=0.0702 train_loss=5.7805]
Wed, 25 Dec 2024 15:09:17 recommender.py[line:519] INFO Train time: 1.40755s. Valid time: 1.44480s
Wed, 25 Dec 2024 15:09:18 recommender.py[line:254] INFO Training: Epoch=  7 [recall@10=0.1592 ndcg@10=0.0793 train_loss=5.7368]
Wed, 25 Dec 2024 15:09:18 recommender.py[line:519] INFO Train time: 1.31587s. Valid time: 1.34345s
Wed, 25 Dec 2024 15:09:20 recommender.py[line:254] INFO Training: Epoch=  8 [recall@10=0.1561 ndcg@10=0.0752 train_loss=5.6957]
Wed, 25 Dec 2024 15:09:20 recommender.py[line:519] INFO Train time: 1.42028s. Valid time: 1.46097s
Wed, 25 Dec 2024 15:09:21 recommender.py[line:254] INFO Training: Epoch=  9 [recall@10=0.1561 ndcg@10=0.0798 train_loss=5.6664]
Wed, 25 Dec 2024 15:09:21 recommender.py[line:519] INFO Train time: 1.44430s. Valid time: 1.47862s
Wed, 25 Dec 2024 15:09:22 recommender.py[line:254] INFO Training: Epoch= 10 [recall@10=0.1624 ndcg@10=0.0776 train_loss=5.6308]
Wed, 25 Dec 2024 15:09:22 recommender.py[line:519] INFO Train time: 1.36652s. Valid time: 1.40473s
Wed, 25 Dec 2024 15:09:24 recommender.py[line:254] INFO Training: Epoch= 11 [recall@10=0.1433 ndcg@10=0.0751 train_loss=5.6142]
Wed, 25 Dec 2024 15:09:24 recommender.py[line:519] INFO Train time: 1.41602s. Valid time: 1.46061s
Wed, 25 Dec 2024 15:09:25 recommender.py[line:254] INFO Training: Epoch= 12 [recall@10=0.1497 ndcg@10=0.0731 train_loss=5.5910]
Wed, 25 Dec 2024 15:09:25 recommender.py[line:519] INFO Train time: 1.34889s. Valid time: 1.39026s
Wed, 25 Dec 2024 15:09:27 recommender.py[line:254] INFO Training: Epoch= 13 [recall@10=0.1561 ndcg@10=0.0743 train_loss=5.5756]
Wed, 25 Dec 2024 15:09:27 recommender.py[line:519] INFO Train time: 1.44915s. Valid time: 1.48268s
Wed, 25 Dec 2024 15:09:28 recommender.py[line:254] INFO Training: Epoch= 14 [recall@10=0.1529 ndcg@10=0.0729 train_loss=5.5572]
Wed, 25 Dec 2024 15:09:28 recommender.py[line:519] INFO Train time: 1.64725s. Valid time: 1.67561s
Wed, 25 Dec 2024 15:09:30 recommender.py[line:254] INFO Training: Epoch= 15 [recall@10=0.1497 ndcg@10=0.0715 train_loss=5.5391]
Wed, 25 Dec 2024 15:09:30 recommender.py[line:519] INFO Train time: 1.33719s. Valid time: 1.36972s
Wed, 25 Dec 2024 15:09:31 recommender.py[line:254] INFO Training: Epoch= 16 [recall@10=0.1465 ndcg@10=0.0712 train_loss=5.5279]
Wed, 25 Dec 2024 15:09:31 recommender.py[line:519] INFO Train time: 1.39477s. Valid time: 1.42751s
Wed, 25 Dec 2024 15:09:33 recommender.py[line:254] INFO Training: Epoch= 17 [recall@10=0.1561 ndcg@10=0.0778 train_loss=5.5186]
Wed, 25 Dec 2024 15:09:33 recommender.py[line:519] INFO Train time: 1.34591s. Valid time: 1.38773s
Wed, 25 Dec 2024 15:09:34 recommender.py[line:254] INFO Training: Epoch= 18 [recall@10=0.1561 ndcg@10=0.0702 train_loss=5.5000]
Wed, 25 Dec 2024 15:09:34 recommender.py[line:519] INFO Train time: 1.39964s. Valid time: 1.44149s
Wed, 25 Dec 2024 15:09:36 recommender.py[line:254] INFO Training: Epoch= 19 [recall@10=0.1497 ndcg@10=0.0726 train_loss=5.4929]
Wed, 25 Dec 2024 15:09:36 recommender.py[line:519] INFO Train time: 1.42113s. Valid time: 1.46077s
Wed, 25 Dec 2024 15:09:37 recommender.py[line:254] INFO Training: Epoch= 20 [recall@10=0.1561 ndcg@10=0.0768 train_loss=5.4734]
Wed, 25 Dec 2024 15:09:37 recommender.py[line:519] INFO Train time: 1.33287s. Valid time: 1.36824s
Wed, 25 Dec 2024 15:09:38 recommender.py[line:254] INFO Training: Epoch= 21 [recall@10=0.1401 ndcg@10=0.0720 train_loss=5.4691]
Wed, 25 Dec 2024 15:09:38 recommender.py[line:519] INFO Train time: 1.47424s. Valid time: 1.50259s
Wed, 25 Dec 2024 15:09:40 recommender.py[line:254] INFO Training: Epoch= 22 [recall@10=0.1369 ndcg@10=0.0706 train_loss=5.4541]
Wed, 25 Dec 2024 15:09:40 recommender.py[line:519] INFO Train time: 1.35991s. Valid time: 1.40064s
Wed, 25 Dec 2024 15:09:41 recommender.py[line:254] INFO Training: Epoch= 23 [recall@10=0.1497 ndcg@10=0.0738 train_loss=5.4439]
Wed, 25 Dec 2024 15:09:41 recommender.py[line:519] INFO Train time: 1.37999s. Valid time: 1.41814s
Wed, 25 Dec 2024 15:09:43 recommender.py[line:254] INFO Training: Epoch= 24 [recall@10=0.1497 ndcg@10=0.0743 train_loss=5.4330]
Wed, 25 Dec 2024 15:09:43 recommender.py[line:519] INFO Train time: 1.36665s. Valid time: 1.40523s
Wed, 25 Dec 2024 15:09:44 recommender.py[line:254] INFO Training: Epoch= 25 [recall@10=0.1401 ndcg@10=0.0708 train_loss=5.4267]
Wed, 25 Dec 2024 15:09:44 recommender.py[line:519] INFO Train time: 1.35325s. Valid time: 1.38238s
Wed, 25 Dec 2024 15:09:44 recommender.py[line:559] INFO Early stopped. recall@10 didn't improve for 20 epochs.
Wed, 25 Dec 2024 15:09:44 recommender.py[line:562] INFO The best score of recall@10 is 0.1656 at 5
Wed, 25 Dec 2024 15:09:44 recommender.py[line:730] INFO Best model checkpoiny saved in ./metadata/model_checkpoint/shadow_model/ml-100k/BERT4Rec/split/train/member_model_2.
Wed, 25 Dec 2024 15:09:44 shadow.py[line:57] INFO Shadow model recommendation performance:
Wed, 25 Dec 2024 15:09:44 recommender.py[line:196] INFO Testing:  [recall@10=0.0924 precision@10=0.0092 map@10=0.0208 ndcg@10=0.0371 mrr@10=0.0208 hit@10=0.0924]
Wed, 25 Dec 2024 15:09:44 recommender.py[line:128] INFO save_dir:/data1/home/zhihao/code/RecAudit/open-source/RecAudit/RecStudio-main
Wed, 25 Dec 2024 15:09:44 recommender.py[line:131] INFO BERT4Rec(
  (loss_fn): SoftmaxLoss()
  (score_func): InnerProductScorer()
  (item_encoder): Embedding(1154, 64, padding_idx=0)
  (query_encoder): BERT4RecQueryEncoder(
    (item_encoder): Embedding(1154, 64, padding_idx=0)
    (position_emb): Embedding(20, 64)
    (transformer_layer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
      )
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (training_pooling_layer): SeqPoolingLayer(pooling_type=mask, keepdim=False)
    (eval_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
  )
)
Wed, 25 Dec 2024 15:09:46 recommender.py[line:254] INFO Training: Epoch=  0 [recall@10=0.0444 ndcg@10=0.0205 train_loss=6.7865]
Wed, 25 Dec 2024 15:09:46 recommender.py[line:519] INFO Train time: 1.36474s. Valid time: 1.40504s
Wed, 25 Dec 2024 15:09:46 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0444
Wed, 25 Dec 2024 15:09:47 recommender.py[line:254] INFO Training: Epoch=  1 [recall@10=0.0603 ndcg@10=0.0346 train_loss=6.5713]
Wed, 25 Dec 2024 15:09:47 recommender.py[line:519] INFO Train time: 1.39502s. Valid time: 1.42448s
Wed, 25 Dec 2024 15:09:47 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0603
Wed, 25 Dec 2024 15:09:48 recommender.py[line:254] INFO Training: Epoch=  2 [recall@10=0.1079 ndcg@10=0.0575 train_loss=6.3619]
Wed, 25 Dec 2024 15:09:48 recommender.py[line:519] INFO Train time: 1.38072s. Valid time: 1.40928s
Wed, 25 Dec 2024 15:09:48 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1079
Wed, 25 Dec 2024 15:09:50 recommender.py[line:254] INFO Training: Epoch=  3 [recall@10=0.1270 ndcg@10=0.0615 train_loss=6.0436]
Wed, 25 Dec 2024 15:09:50 recommender.py[line:519] INFO Train time: 1.42409s. Valid time: 1.45609s
Wed, 25 Dec 2024 15:09:50 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1270
Wed, 25 Dec 2024 15:09:51 recommender.py[line:254] INFO Training: Epoch=  4 [recall@10=0.1492 ndcg@10=0.0626 train_loss=5.8780]
Wed, 25 Dec 2024 15:09:51 recommender.py[line:519] INFO Train time: 1.31776s. Valid time: 1.36377s
Wed, 25 Dec 2024 15:09:51 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1492
Wed, 25 Dec 2024 15:09:53 recommender.py[line:254] INFO Training: Epoch=  5 [recall@10=0.1333 ndcg@10=0.0615 train_loss=5.7917]
Wed, 25 Dec 2024 15:09:53 recommender.py[line:519] INFO Train time: 1.45903s. Valid time: 1.49732s
Wed, 25 Dec 2024 15:09:54 recommender.py[line:254] INFO Training: Epoch=  6 [recall@10=0.1619 ndcg@10=0.0782 train_loss=5.7240]
Wed, 25 Dec 2024 15:09:54 recommender.py[line:519] INFO Train time: 1.42103s. Valid time: 1.44903s
Wed, 25 Dec 2024 15:09:54 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1619
Wed, 25 Dec 2024 15:09:56 recommender.py[line:254] INFO Training: Epoch=  7 [recall@10=0.1651 ndcg@10=0.0788 train_loss=5.6870]
Wed, 25 Dec 2024 15:09:56 recommender.py[line:519] INFO Train time: 1.41494s. Valid time: 1.45586s
Wed, 25 Dec 2024 15:09:56 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1651
Wed, 25 Dec 2024 15:09:57 recommender.py[line:254] INFO Training: Epoch=  8 [recall@10=0.1524 ndcg@10=0.0738 train_loss=5.6527]
Wed, 25 Dec 2024 15:09:57 recommender.py[line:519] INFO Train time: 1.41804s. Valid time: 1.45049s
Wed, 25 Dec 2024 15:09:59 recommender.py[line:254] INFO Training: Epoch=  9 [recall@10=0.1619 ndcg@10=0.0836 train_loss=5.6276]
Wed, 25 Dec 2024 15:09:59 recommender.py[line:519] INFO Train time: 1.35696s. Valid time: 1.39395s
Wed, 25 Dec 2024 15:10:00 recommender.py[line:254] INFO Training: Epoch= 10 [recall@10=0.1841 ndcg@10=0.0875 train_loss=5.6064]
Wed, 25 Dec 2024 15:10:00 recommender.py[line:519] INFO Train time: 1.43665s. Valid time: 1.47026s
Wed, 25 Dec 2024 15:10:00 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1841
Wed, 25 Dec 2024 15:10:01 recommender.py[line:254] INFO Training: Epoch= 11 [recall@10=0.1619 ndcg@10=0.0809 train_loss=5.5793]
Wed, 25 Dec 2024 15:10:01 recommender.py[line:519] INFO Train time: 1.42497s. Valid time: 1.46759s
Wed, 25 Dec 2024 15:10:03 recommender.py[line:254] INFO Training: Epoch= 12 [recall@10=0.1937 ndcg@10=0.1024 train_loss=5.5718]
Wed, 25 Dec 2024 15:10:03 recommender.py[line:519] INFO Train time: 1.47209s. Valid time: 1.50299s
Wed, 25 Dec 2024 15:10:03 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1937
Wed, 25 Dec 2024 15:10:04 recommender.py[line:254] INFO Training: Epoch= 13 [recall@10=0.2063 ndcg@10=0.1105 train_loss=5.5495]
Wed, 25 Dec 2024 15:10:04 recommender.py[line:519] INFO Train time: 1.35635s. Valid time: 1.38761s
Wed, 25 Dec 2024 15:10:04 recommender.py[line:548] INFO recall@10 improved. Best value: 0.2063
Wed, 25 Dec 2024 15:10:06 recommender.py[line:254] INFO Training: Epoch= 14 [recall@10=0.1810 ndcg@10=0.1040 train_loss=5.5383]
Wed, 25 Dec 2024 15:10:06 recommender.py[line:519] INFO Train time: 1.44259s. Valid time: 1.47516s
Wed, 25 Dec 2024 15:10:07 recommender.py[line:254] INFO Training: Epoch= 15 [recall@10=0.1841 ndcg@10=0.0986 train_loss=5.5173]
Wed, 25 Dec 2024 15:10:07 recommender.py[line:519] INFO Train time: 1.47545s. Valid time: 1.51299s
Wed, 25 Dec 2024 15:10:09 recommender.py[line:254] INFO Training: Epoch= 16 [recall@10=0.1937 ndcg@10=0.1067 train_loss=5.5098]
Wed, 25 Dec 2024 15:10:09 recommender.py[line:519] INFO Train time: 1.34771s. Valid time: 1.37682s
Wed, 25 Dec 2024 15:10:10 recommender.py[line:254] INFO Training: Epoch= 17 [recall@10=0.1841 ndcg@10=0.1104 train_loss=5.4898]
Wed, 25 Dec 2024 15:10:10 recommender.py[line:519] INFO Train time: 1.48616s. Valid time: 1.52027s
Wed, 25 Dec 2024 15:10:12 recommender.py[line:254] INFO Training: Epoch= 18 [recall@10=0.1905 ndcg@10=0.1063 train_loss=5.4795]
Wed, 25 Dec 2024 15:10:12 recommender.py[line:519] INFO Train time: 1.31799s. Valid time: 1.34206s
Wed, 25 Dec 2024 15:10:13 recommender.py[line:254] INFO Training: Epoch= 19 [recall@10=0.2222 ndcg@10=0.1219 train_loss=5.4725]
Wed, 25 Dec 2024 15:10:13 recommender.py[line:519] INFO Train time: 1.39276s. Valid time: 1.43182s
Wed, 25 Dec 2024 15:10:13 recommender.py[line:548] INFO recall@10 improved. Best value: 0.2222
Wed, 25 Dec 2024 15:10:15 recommender.py[line:254] INFO Training: Epoch= 20 [recall@10=0.1810 ndcg@10=0.0988 train_loss=5.4679]
Wed, 25 Dec 2024 15:10:15 recommender.py[line:519] INFO Train time: 1.46960s. Valid time: 1.51680s
Wed, 25 Dec 2024 15:10:16 recommender.py[line:254] INFO Training: Epoch= 21 [recall@10=0.2000 ndcg@10=0.1037 train_loss=5.4454]
Wed, 25 Dec 2024 15:10:16 recommender.py[line:519] INFO Train time: 1.55555s. Valid time: 1.58826s
Wed, 25 Dec 2024 15:10:18 recommender.py[line:254] INFO Training: Epoch= 22 [recall@10=0.2095 ndcg@10=0.1115 train_loss=5.4352]
Wed, 25 Dec 2024 15:10:18 recommender.py[line:519] INFO Train time: 1.37763s. Valid time: 1.41725s
Wed, 25 Dec 2024 15:10:19 recommender.py[line:254] INFO Training: Epoch= 23 [recall@10=0.1810 ndcg@10=0.1011 train_loss=5.4304]
Wed, 25 Dec 2024 15:10:19 recommender.py[line:519] INFO Train time: 1.30666s. Valid time: 1.33349s
Wed, 25 Dec 2024 15:10:20 recommender.py[line:254] INFO Training: Epoch= 24 [recall@10=0.2000 ndcg@10=0.1042 train_loss=5.4231]
Wed, 25 Dec 2024 15:10:20 recommender.py[line:519] INFO Train time: 1.57858s. Valid time: 1.61840s
Wed, 25 Dec 2024 15:10:22 recommender.py[line:254] INFO Training: Epoch= 25 [recall@10=0.1905 ndcg@10=0.1011 train_loss=5.4122]
Wed, 25 Dec 2024 15:10:22 recommender.py[line:519] INFO Train time: 1.33501s. Valid time: 1.37137s
Wed, 25 Dec 2024 15:10:23 recommender.py[line:254] INFO Training: Epoch= 26 [recall@10=0.1968 ndcg@10=0.1106 train_loss=5.4015]
Wed, 25 Dec 2024 15:10:23 recommender.py[line:519] INFO Train time: 1.37836s. Valid time: 1.41499s
Wed, 25 Dec 2024 15:10:25 recommender.py[line:254] INFO Training: Epoch= 27 [recall@10=0.1937 ndcg@10=0.1049 train_loss=5.3917]
Wed, 25 Dec 2024 15:10:25 recommender.py[line:519] INFO Train time: 1.34955s. Valid time: 1.38052s
Wed, 25 Dec 2024 15:10:26 recommender.py[line:254] INFO Training: Epoch= 28 [recall@10=0.1873 ndcg@10=0.1047 train_loss=5.3865]
Wed, 25 Dec 2024 15:10:26 recommender.py[line:519] INFO Train time: 1.28544s. Valid time: 1.32118s
Wed, 25 Dec 2024 15:10:28 recommender.py[line:254] INFO Training: Epoch= 29 [recall@10=0.1968 ndcg@10=0.1053 train_loss=5.3849]
Wed, 25 Dec 2024 15:10:28 recommender.py[line:519] INFO Train time: 1.51189s. Valid time: 1.54858s
Wed, 25 Dec 2024 15:10:29 recommender.py[line:254] INFO Training: Epoch= 30 [recall@10=0.2095 ndcg@10=0.1100 train_loss=5.3737]
Wed, 25 Dec 2024 15:10:29 recommender.py[line:519] INFO Train time: 1.42989s. Valid time: 1.46207s
Wed, 25 Dec 2024 15:10:30 recommender.py[line:254] INFO Training: Epoch= 31 [recall@10=0.2000 ndcg@10=0.1051 train_loss=5.3591]
Wed, 25 Dec 2024 15:10:30 recommender.py[line:519] INFO Train time: 1.39341s. Valid time: 1.42701s
Wed, 25 Dec 2024 15:10:32 recommender.py[line:254] INFO Training: Epoch= 32 [recall@10=0.1873 ndcg@10=0.1033 train_loss=5.3463]
Wed, 25 Dec 2024 15:10:32 recommender.py[line:519] INFO Train time: 1.43005s. Valid time: 1.47116s
Wed, 25 Dec 2024 15:10:33 recommender.py[line:254] INFO Training: Epoch= 33 [recall@10=0.2127 ndcg@10=0.1128 train_loss=5.3383]
Wed, 25 Dec 2024 15:10:33 recommender.py[line:519] INFO Train time: 1.37828s. Valid time: 1.39642s
Wed, 25 Dec 2024 15:10:35 recommender.py[line:254] INFO Training: Epoch= 34 [recall@10=0.2159 ndcg@10=0.1174 train_loss=5.3351]
Wed, 25 Dec 2024 15:10:35 recommender.py[line:519] INFO Train time: 1.40428s. Valid time: 1.43668s
Wed, 25 Dec 2024 15:10:36 recommender.py[line:254] INFO Training: Epoch= 35 [recall@10=0.2190 ndcg@10=0.1143 train_loss=5.3222]
Wed, 25 Dec 2024 15:10:36 recommender.py[line:519] INFO Train time: 1.30033s. Valid time: 1.33512s
Wed, 25 Dec 2024 15:10:37 recommender.py[line:254] INFO Training: Epoch= 36 [recall@10=0.2095 ndcg@10=0.1064 train_loss=5.3207]
Wed, 25 Dec 2024 15:10:37 recommender.py[line:519] INFO Train time: 1.37797s. Valid time: 1.41324s
Wed, 25 Dec 2024 15:10:39 recommender.py[line:254] INFO Training: Epoch= 37 [recall@10=0.2159 ndcg@10=0.1065 train_loss=5.3067]
Wed, 25 Dec 2024 15:10:39 recommender.py[line:519] INFO Train time: 1.38026s. Valid time: 1.42129s
Wed, 25 Dec 2024 15:10:40 recommender.py[line:254] INFO Training: Epoch= 38 [recall@10=0.2190 ndcg@10=0.1110 train_loss=5.2978]
Wed, 25 Dec 2024 15:10:40 recommender.py[line:519] INFO Train time: 1.37782s. Valid time: 1.40731s
Wed, 25 Dec 2024 15:10:42 recommender.py[line:254] INFO Training: Epoch= 39 [recall@10=0.2127 ndcg@10=0.1111 train_loss=5.2971]
Wed, 25 Dec 2024 15:10:42 recommender.py[line:519] INFO Train time: 1.38962s. Valid time: 1.42843s
Wed, 25 Dec 2024 15:10:42 recommender.py[line:559] INFO Early stopped. recall@10 didn't improve for 20 epochs.
Wed, 25 Dec 2024 15:10:42 recommender.py[line:562] INFO The best score of recall@10 is 0.2222 at 19
Wed, 25 Dec 2024 15:10:42 recommender.py[line:730] INFO Best model checkpoiny saved in ./metadata/model_checkpoint/shadow_model/ml-100k/BERT4Rec/split/train/nonmember_model_2.
Wed, 25 Dec 2024 15:10:42 shadow.py[line:57] INFO Shadow model recommendation performance:
Wed, 25 Dec 2024 15:10:42 recommender.py[line:196] INFO Testing:  [recall@10=0.2159 precision@10=0.0216 map@10=0.0605 ndcg@10=0.0963 mrr@10=0.0605 hit@10=0.2159]
Wed, 25 Dec 2024 15:10:48 shadow.py[line:292] INFO End of the code.
