Wed, 25 Dec 2024 15:09:00 shadow.py[line:150] INFO {'dataset': 'ml-100k', 'model': 'BERT4Rec', 'split_seed': 6, 'gpu': 2, 'split_cf': 'split', 'train_cf': 'train'}
Wed, 25 Dec 2024 15:09:00 utils.py[line:224] INFO dataset is read from ../datasets/ml-100k.
Wed, 25 Dec 2024 15:09:00 utils.py[line:38] INFO 
Dataset Info: 

==================================================
item information: 
field     item_id   
type      token     
##        1153      
==================================================
user information: 
field     user_id   
type      token     
##        944       
==================================================
interaction information: 
field     user_id   item_id   rating    timestamp 
type      token     token     float     float     
##        944       1153      -         -         
==================================================
Sparsity: 0.909832
==================================================
Wed, 25 Dec 2024 15:09:02 utils.py[line:297] INFO Global seed set to 2019
Wed, 25 Dec 2024 15:09:02 utils.py[line:62] INFO 
Model Config: 

accelerator=gpu
activation=gelu
ann=None
batch_size=1024
cutoff=10
dataset_neg_count=None
dataset_sampler=None
dropout=0.2
early_stop_mode=max
early_stop_patience=20
embed_dim=64
epochs=100
eval_batch_size=128
excluding_hist=False
gpu=[2]
head_num=2
hidden_size=128
item_bias=False
layer_norm_eps=1e-12
layer_num=2
learner=adam
learning_rate=0.001
mask_ratio=0.2
negative_count=1
num_workers=0
pooling_type=mask
save_path=./saved/
scheduler=None
seed=2019
split_ratio=2
steal=False
test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
test_repetitive=True
topk=100
train_repetitive=True
val_metrics=['recall', 'ndcg']
weight_decay=1e-05
Wed, 25 Dec 2024 15:09:02 utils.py[line:297] INFO Global seed set to 2019
Wed, 25 Dec 2024 15:09:02 utils.py[line:62] INFO 
Model Config: 

accelerator=gpu
activation=gelu
ann=None
batch_size=1024
cutoff=10
dataset_neg_count=None
dataset_sampler=None
dropout=0.2
early_stop_mode=max
early_stop_patience=20
embed_dim=64
epochs=100
eval_batch_size=128
excluding_hist=False
gpu=[2]
head_num=2
hidden_size=128
item_bias=False
layer_norm_eps=1e-12
layer_num=2
learner=adam
learning_rate=0.001
mask_ratio=0.2
negative_count=1
num_workers=0
pooling_type=mask
save_path=./saved/
scheduler=None
seed=2019
split_ratio=2
steal=False
test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
test_repetitive=True
topk=100
train_repetitive=True
val_metrics=['recall', 'ndcg']
weight_decay=1e-05
Wed, 25 Dec 2024 15:09:02 recommender.py[line:128] INFO save_dir:/data1/home/zhihao/code/RecAudit/open-source/RecAudit/RecStudio-main
Wed, 25 Dec 2024 15:09:02 recommender.py[line:131] INFO BERT4Rec(
  (loss_fn): SoftmaxLoss()
  (score_func): InnerProductScorer()
  (item_encoder): Embedding(1154, 64, padding_idx=0)
  (query_encoder): BERT4RecQueryEncoder(
    (item_encoder): Embedding(1154, 64, padding_idx=0)
    (position_emb): Embedding(20, 64)
    (transformer_layer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
      )
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (training_pooling_layer): SeqPoolingLayer(pooling_type=mask, keepdim=False)
    (eval_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
  )
)
Wed, 25 Dec 2024 15:09:08 recommender.py[line:254] INFO Training: Epoch=  0 [recall@10=0.0510 ndcg@10=0.0213 train_loss=6.7842]
Wed, 25 Dec 2024 15:09:08 recommender.py[line:519] INFO Train time: 1.70628s. Valid time: 1.74794s
Wed, 25 Dec 2024 15:09:08 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0510
Wed, 25 Dec 2024 15:09:10 recommender.py[line:254] INFO Training: Epoch=  1 [recall@10=0.0541 ndcg@10=0.0265 train_loss=6.5805]
Wed, 25 Dec 2024 15:09:10 recommender.py[line:519] INFO Train time: 1.45564s. Valid time: 1.49069s
Wed, 25 Dec 2024 15:09:10 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0541
Wed, 25 Dec 2024 15:09:11 recommender.py[line:254] INFO Training: Epoch=  2 [recall@10=0.1146 ndcg@10=0.0553 train_loss=6.3837]
Wed, 25 Dec 2024 15:09:11 recommender.py[line:519] INFO Train time: 1.30703s. Valid time: 1.34641s
Wed, 25 Dec 2024 15:09:11 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1146
Wed, 25 Dec 2024 15:09:12 recommender.py[line:254] INFO Training: Epoch=  3 [recall@10=0.1242 ndcg@10=0.0602 train_loss=6.0642]
Wed, 25 Dec 2024 15:09:12 recommender.py[line:519] INFO Train time: 1.47512s. Valid time: 1.52282s
Wed, 25 Dec 2024 15:09:12 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1242
Wed, 25 Dec 2024 15:09:14 recommender.py[line:254] INFO Training: Epoch=  4 [recall@10=0.1242 ndcg@10=0.0577 train_loss=5.9138]
Wed, 25 Dec 2024 15:09:14 recommender.py[line:519] INFO Train time: 1.55160s. Valid time: 1.58463s
Wed, 25 Dec 2024 15:09:15 recommender.py[line:254] INFO Training: Epoch=  5 [recall@10=0.1242 ndcg@10=0.0580 train_loss=5.8355]
Wed, 25 Dec 2024 15:09:15 recommender.py[line:519] INFO Train time: 1.34650s. Valid time: 1.37880s
Wed, 25 Dec 2024 15:09:17 recommender.py[line:254] INFO Training: Epoch=  6 [recall@10=0.1242 ndcg@10=0.0538 train_loss=5.7805]
Wed, 25 Dec 2024 15:09:17 recommender.py[line:519] INFO Train time: 1.44762s. Valid time: 1.48472s
Wed, 25 Dec 2024 15:09:18 recommender.py[line:254] INFO Training: Epoch=  7 [recall@10=0.1369 ndcg@10=0.0612 train_loss=5.7357]
Wed, 25 Dec 2024 15:09:18 recommender.py[line:519] INFO Train time: 1.33540s. Valid time: 1.37164s
Wed, 25 Dec 2024 15:09:18 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1369
Wed, 25 Dec 2024 15:09:20 recommender.py[line:254] INFO Training: Epoch=  8 [recall@10=0.1306 ndcg@10=0.0628 train_loss=5.6913]
Wed, 25 Dec 2024 15:09:20 recommender.py[line:519] INFO Train time: 1.44305s. Valid time: 1.47748s
Wed, 25 Dec 2024 15:09:21 recommender.py[line:254] INFO Training: Epoch=  9 [recall@10=0.1242 ndcg@10=0.0641 train_loss=5.6661]
Wed, 25 Dec 2024 15:09:21 recommender.py[line:519] INFO Train time: 1.44502s. Valid time: 1.46869s
Wed, 25 Dec 2024 15:09:23 recommender.py[line:254] INFO Training: Epoch= 10 [recall@10=0.1338 ndcg@10=0.0628 train_loss=5.6409]
Wed, 25 Dec 2024 15:09:23 recommender.py[line:519] INFO Train time: 1.43367s. Valid time: 1.45977s
Wed, 25 Dec 2024 15:09:24 recommender.py[line:254] INFO Training: Epoch= 11 [recall@10=0.1210 ndcg@10=0.0613 train_loss=5.6211]
Wed, 25 Dec 2024 15:09:24 recommender.py[line:519] INFO Train time: 1.36391s. Valid time: 1.38796s
Wed, 25 Dec 2024 15:09:25 recommender.py[line:254] INFO Training: Epoch= 12 [recall@10=0.1338 ndcg@10=0.0624 train_loss=5.6012]
Wed, 25 Dec 2024 15:09:25 recommender.py[line:519] INFO Train time: 1.30415s. Valid time: 1.33117s
Wed, 25 Dec 2024 15:09:27 recommender.py[line:254] INFO Training: Epoch= 13 [recall@10=0.1433 ndcg@10=0.0711 train_loss=5.5827]
Wed, 25 Dec 2024 15:09:27 recommender.py[line:519] INFO Train time: 1.37260s. Valid time: 1.40464s
Wed, 25 Dec 2024 15:09:27 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1433
Wed, 25 Dec 2024 15:09:28 recommender.py[line:254] INFO Training: Epoch= 14 [recall@10=0.1274 ndcg@10=0.0628 train_loss=5.5677]
Wed, 25 Dec 2024 15:09:28 recommender.py[line:519] INFO Train time: 1.34035s. Valid time: 1.36861s
Wed, 25 Dec 2024 15:09:30 recommender.py[line:254] INFO Training: Epoch= 15 [recall@10=0.1274 ndcg@10=0.0602 train_loss=5.5483]
Wed, 25 Dec 2024 15:09:30 recommender.py[line:519] INFO Train time: 1.41869s. Valid time: 1.45345s
Wed, 25 Dec 2024 15:09:31 recommender.py[line:254] INFO Training: Epoch= 16 [recall@10=0.1274 ndcg@10=0.0631 train_loss=5.5415]
Wed, 25 Dec 2024 15:09:31 recommender.py[line:519] INFO Train time: 1.42403s. Valid time: 1.46159s
Wed, 25 Dec 2024 15:09:32 recommender.py[line:254] INFO Training: Epoch= 17 [recall@10=0.1178 ndcg@10=0.0631 train_loss=5.5321]
Wed, 25 Dec 2024 15:09:32 recommender.py[line:519] INFO Train time: 1.29287s. Valid time: 1.32772s
Wed, 25 Dec 2024 15:09:34 recommender.py[line:254] INFO Training: Epoch= 18 [recall@10=0.1306 ndcg@10=0.0593 train_loss=5.5131]
Wed, 25 Dec 2024 15:09:34 recommender.py[line:519] INFO Train time: 1.46590s. Valid time: 1.50294s
Wed, 25 Dec 2024 15:09:35 recommender.py[line:254] INFO Training: Epoch= 19 [recall@10=0.1146 ndcg@10=0.0546 train_loss=5.5085]
Wed, 25 Dec 2024 15:09:35 recommender.py[line:519] INFO Train time: 1.34134s. Valid time: 1.38505s
Wed, 25 Dec 2024 15:09:37 recommender.py[line:254] INFO Training: Epoch= 20 [recall@10=0.1369 ndcg@10=0.0686 train_loss=5.4955]
Wed, 25 Dec 2024 15:09:37 recommender.py[line:519] INFO Train time: 1.47819s. Valid time: 1.51661s
Wed, 25 Dec 2024 15:09:38 recommender.py[line:254] INFO Training: Epoch= 21 [recall@10=0.1210 ndcg@10=0.0573 train_loss=5.4810]
Wed, 25 Dec 2024 15:09:38 recommender.py[line:519] INFO Train time: 1.31237s. Valid time: 1.34134s
Wed, 25 Dec 2024 15:09:40 recommender.py[line:254] INFO Training: Epoch= 22 [recall@10=0.1306 ndcg@10=0.0687 train_loss=5.4690]
Wed, 25 Dec 2024 15:09:40 recommender.py[line:519] INFO Train time: 1.35385s. Valid time: 1.38709s
Wed, 25 Dec 2024 15:09:41 recommender.py[line:254] INFO Training: Epoch= 23 [recall@10=0.1274 ndcg@10=0.0612 train_loss=5.4671]
Wed, 25 Dec 2024 15:09:41 recommender.py[line:519] INFO Train time: 1.38639s. Valid time: 1.43355s
Wed, 25 Dec 2024 15:09:43 recommender.py[line:254] INFO Training: Epoch= 24 [recall@10=0.1306 ndcg@10=0.0691 train_loss=5.4553]
Wed, 25 Dec 2024 15:09:43 recommender.py[line:519] INFO Train time: 1.52987s. Valid time: 1.56816s
Wed, 25 Dec 2024 15:09:44 recommender.py[line:254] INFO Training: Epoch= 25 [recall@10=0.1401 ndcg@10=0.0669 train_loss=5.4354]
Wed, 25 Dec 2024 15:09:44 recommender.py[line:519] INFO Train time: 1.35918s. Valid time: 1.39378s
Wed, 25 Dec 2024 15:09:45 recommender.py[line:254] INFO Training: Epoch= 26 [recall@10=0.1242 ndcg@10=0.0680 train_loss=5.4253]
Wed, 25 Dec 2024 15:09:45 recommender.py[line:519] INFO Train time: 1.32509s. Valid time: 1.36177s
Wed, 25 Dec 2024 15:09:47 recommender.py[line:254] INFO Training: Epoch= 27 [recall@10=0.1433 ndcg@10=0.0715 train_loss=5.4211]
Wed, 25 Dec 2024 15:09:47 recommender.py[line:519] INFO Train time: 1.43914s. Valid time: 1.47705s
Wed, 25 Dec 2024 15:09:48 recommender.py[line:254] INFO Training: Epoch= 28 [recall@10=0.1338 ndcg@10=0.0632 train_loss=5.4051]
Wed, 25 Dec 2024 15:09:48 recommender.py[line:519] INFO Train time: 1.30867s. Valid time: 1.34222s
Wed, 25 Dec 2024 15:09:50 recommender.py[line:254] INFO Training: Epoch= 29 [recall@10=0.1306 ndcg@10=0.0639 train_loss=5.3960]
Wed, 25 Dec 2024 15:09:50 recommender.py[line:519] INFO Train time: 1.42273s. Valid time: 1.45705s
Wed, 25 Dec 2024 15:09:51 recommender.py[line:254] INFO Training: Epoch= 30 [recall@10=0.1338 ndcg@10=0.0736 train_loss=5.3884]
Wed, 25 Dec 2024 15:09:51 recommender.py[line:519] INFO Train time: 1.33767s. Valid time: 1.37717s
Wed, 25 Dec 2024 15:09:53 recommender.py[line:254] INFO Training: Epoch= 31 [recall@10=0.1369 ndcg@10=0.0636 train_loss=5.3827]
Wed, 25 Dec 2024 15:09:53 recommender.py[line:519] INFO Train time: 1.44394s. Valid time: 1.48725s
Wed, 25 Dec 2024 15:09:54 recommender.py[line:254] INFO Training: Epoch= 32 [recall@10=0.1401 ndcg@10=0.0677 train_loss=5.3760]
Wed, 25 Dec 2024 15:09:54 recommender.py[line:519] INFO Train time: 1.41907s. Valid time: 1.45132s
Wed, 25 Dec 2024 15:09:55 recommender.py[line:254] INFO Training: Epoch= 33 [recall@10=0.1401 ndcg@10=0.0682 train_loss=5.3586]
Wed, 25 Dec 2024 15:09:55 recommender.py[line:519] INFO Train time: 1.36415s. Valid time: 1.40501s
Wed, 25 Dec 2024 15:09:55 recommender.py[line:559] INFO Early stopped. recall@10 didn't improve for 20 epochs.
Wed, 25 Dec 2024 15:09:55 recommender.py[line:562] INFO The best score of recall@10 is 0.1433 at 13
Wed, 25 Dec 2024 15:09:55 recommender.py[line:730] INFO Best model checkpoiny saved in ./metadata/model_checkpoint/shadow_model/ml-100k/BERT4Rec/split/train/member_model_6.
Wed, 25 Dec 2024 15:09:55 shadow.py[line:57] INFO Shadow model recommendation performance:
Wed, 25 Dec 2024 15:09:55 recommender.py[line:196] INFO Testing:  [recall@10=0.1561 precision@10=0.0156 map@10=0.0627 ndcg@10=0.0842 mrr@10=0.0627 hit@10=0.1561]
Wed, 25 Dec 2024 15:09:55 recommender.py[line:128] INFO save_dir:/data1/home/zhihao/code/RecAudit/open-source/RecAudit/RecStudio-main
Wed, 25 Dec 2024 15:09:55 recommender.py[line:131] INFO BERT4Rec(
  (loss_fn): SoftmaxLoss()
  (score_func): InnerProductScorer()
  (item_encoder): Embedding(1154, 64, padding_idx=0)
  (query_encoder): BERT4RecQueryEncoder(
    (item_encoder): Embedding(1154, 64, padding_idx=0)
    (position_emb): Embedding(20, 64)
    (transformer_layer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
      )
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (training_pooling_layer): SeqPoolingLayer(pooling_type=mask, keepdim=False)
    (eval_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
  )
)
Wed, 25 Dec 2024 15:09:57 recommender.py[line:254] INFO Training: Epoch=  0 [recall@10=0.0794 ndcg@10=0.0361 train_loss=6.8174]
Wed, 25 Dec 2024 15:09:57 recommender.py[line:519] INFO Train time: 1.42480s. Valid time: 1.45980s
Wed, 25 Dec 2024 15:09:57 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0794
Wed, 25 Dec 2024 15:09:58 recommender.py[line:254] INFO Training: Epoch=  1 [recall@10=0.0984 ndcg@10=0.0449 train_loss=6.5658]
Wed, 25 Dec 2024 15:09:58 recommender.py[line:519] INFO Train time: 1.34057s. Valid time: 1.37601s
Wed, 25 Dec 2024 15:09:58 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0984
Wed, 25 Dec 2024 15:10:00 recommender.py[line:254] INFO Training: Epoch=  2 [recall@10=0.1238 ndcg@10=0.0597 train_loss=6.2027]
Wed, 25 Dec 2024 15:10:00 recommender.py[line:519] INFO Train time: 1.36109s. Valid time: 1.39425s
Wed, 25 Dec 2024 15:10:00 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1238
Wed, 25 Dec 2024 15:10:01 recommender.py[line:254] INFO Training: Epoch=  3 [recall@10=0.1460 ndcg@10=0.0739 train_loss=5.9560]
Wed, 25 Dec 2024 15:10:01 recommender.py[line:519] INFO Train time: 1.39355s. Valid time: 1.42622s
Wed, 25 Dec 2024 15:10:01 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1460
Wed, 25 Dec 2024 15:10:03 recommender.py[line:254] INFO Training: Epoch=  4 [recall@10=0.1429 ndcg@10=0.0686 train_loss=5.8447]
Wed, 25 Dec 2024 15:10:03 recommender.py[line:519] INFO Train time: 1.41154s. Valid time: 1.45638s
Wed, 25 Dec 2024 15:10:04 recommender.py[line:254] INFO Training: Epoch=  5 [recall@10=0.1587 ndcg@10=0.0765 train_loss=5.7632]
Wed, 25 Dec 2024 15:10:04 recommender.py[line:519] INFO Train time: 1.42363s. Valid time: 1.45938s
Wed, 25 Dec 2024 15:10:04 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1587
Wed, 25 Dec 2024 15:10:05 recommender.py[line:254] INFO Training: Epoch=  6 [recall@10=0.1683 ndcg@10=0.0839 train_loss=5.7119]
Wed, 25 Dec 2024 15:10:05 recommender.py[line:519] INFO Train time: 1.32128s. Valid time: 1.35620s
Wed, 25 Dec 2024 15:10:05 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1683
Wed, 25 Dec 2024 15:10:07 recommender.py[line:254] INFO Training: Epoch=  7 [recall@10=0.1651 ndcg@10=0.0895 train_loss=5.6708]
Wed, 25 Dec 2024 15:10:07 recommender.py[line:519] INFO Train time: 1.40852s. Valid time: 1.44287s
Wed, 25 Dec 2024 15:10:08 recommender.py[line:254] INFO Training: Epoch=  8 [recall@10=0.1905 ndcg@10=0.1050 train_loss=5.6419]
Wed, 25 Dec 2024 15:10:08 recommender.py[line:519] INFO Train time: 1.36715s. Valid time: 1.40795s
Wed, 25 Dec 2024 15:10:08 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1905
Wed, 25 Dec 2024 15:10:10 recommender.py[line:254] INFO Training: Epoch=  9 [recall@10=0.1873 ndcg@10=0.0977 train_loss=5.6170]
Wed, 25 Dec 2024 15:10:10 recommender.py[line:519] INFO Train time: 1.39822s. Valid time: 1.43498s
Wed, 25 Dec 2024 15:10:11 recommender.py[line:254] INFO Training: Epoch= 10 [recall@10=0.2032 ndcg@10=0.0952 train_loss=5.5961]
Wed, 25 Dec 2024 15:10:11 recommender.py[line:519] INFO Train time: 1.37541s. Valid time: 1.39925s
Wed, 25 Dec 2024 15:10:11 recommender.py[line:548] INFO recall@10 improved. Best value: 0.2032
Wed, 25 Dec 2024 15:10:12 recommender.py[line:254] INFO Training: Epoch= 11 [recall@10=0.1937 ndcg@10=0.0985 train_loss=5.5732]
Wed, 25 Dec 2024 15:10:12 recommender.py[line:519] INFO Train time: 1.31801s. Valid time: 1.35299s
Wed, 25 Dec 2024 15:10:14 recommender.py[line:254] INFO Training: Epoch= 12 [recall@10=0.1905 ndcg@10=0.0847 train_loss=5.5583]
Wed, 25 Dec 2024 15:10:14 recommender.py[line:519] INFO Train time: 1.56651s. Valid time: 1.61103s
Wed, 25 Dec 2024 15:10:16 recommender.py[line:254] INFO Training: Epoch= 13 [recall@10=0.2159 ndcg@10=0.1032 train_loss=5.5360]
Wed, 25 Dec 2024 15:10:16 recommender.py[line:519] INFO Train time: 1.41637s. Valid time: 1.45571s
Wed, 25 Dec 2024 15:10:16 recommender.py[line:548] INFO recall@10 improved. Best value: 0.2159
Wed, 25 Dec 2024 15:10:17 recommender.py[line:254] INFO Training: Epoch= 14 [recall@10=0.1968 ndcg@10=0.1058 train_loss=5.5219]
Wed, 25 Dec 2024 15:10:17 recommender.py[line:519] INFO Train time: 1.47600s. Valid time: 1.51795s
Wed, 25 Dec 2024 15:10:19 recommender.py[line:254] INFO Training: Epoch= 15 [recall@10=0.1873 ndcg@10=0.0951 train_loss=5.4975]
Wed, 25 Dec 2024 15:10:19 recommender.py[line:519] INFO Train time: 1.58840s. Valid time: 1.62005s
Wed, 25 Dec 2024 15:10:20 recommender.py[line:254] INFO Training: Epoch= 16 [recall@10=0.1841 ndcg@10=0.0880 train_loss=5.4944]
Wed, 25 Dec 2024 15:10:20 recommender.py[line:519] INFO Train time: 1.38174s. Valid time: 1.42036s
Wed, 25 Dec 2024 15:10:22 recommender.py[line:254] INFO Training: Epoch= 17 [recall@10=0.1778 ndcg@10=0.0899 train_loss=5.4698]
Wed, 25 Dec 2024 15:10:22 recommender.py[line:519] INFO Train time: 1.46672s. Valid time: 1.49984s
Wed, 25 Dec 2024 15:10:23 recommender.py[line:254] INFO Training: Epoch= 18 [recall@10=0.1683 ndcg@10=0.0804 train_loss=5.4580]
Wed, 25 Dec 2024 15:10:23 recommender.py[line:519] INFO Train time: 1.40967s. Valid time: 1.45161s
Wed, 25 Dec 2024 15:10:25 recommender.py[line:254] INFO Training: Epoch= 19 [recall@10=0.1810 ndcg@10=0.0907 train_loss=5.4362]
Wed, 25 Dec 2024 15:10:25 recommender.py[line:519] INFO Train time: 1.40132s. Valid time: 1.44406s
Wed, 25 Dec 2024 15:10:26 recommender.py[line:254] INFO Training: Epoch= 20 [recall@10=0.1778 ndcg@10=0.0910 train_loss=5.4209]
Wed, 25 Dec 2024 15:10:26 recommender.py[line:519] INFO Train time: 1.39620s. Valid time: 1.43112s
Wed, 25 Dec 2024 15:10:27 recommender.py[line:254] INFO Training: Epoch= 21 [recall@10=0.1937 ndcg@10=0.0899 train_loss=5.4026]
Wed, 25 Dec 2024 15:10:27 recommender.py[line:519] INFO Train time: 1.42550s. Valid time: 1.45842s
Wed, 25 Dec 2024 15:10:29 recommender.py[line:254] INFO Training: Epoch= 22 [recall@10=0.1778 ndcg@10=0.0960 train_loss=5.3901]
Wed, 25 Dec 2024 15:10:29 recommender.py[line:519] INFO Train time: 1.41185s. Valid time: 1.44263s
Wed, 25 Dec 2024 15:10:30 recommender.py[line:254] INFO Training: Epoch= 23 [recall@10=0.1905 ndcg@10=0.0971 train_loss=5.3800]
Wed, 25 Dec 2024 15:10:30 recommender.py[line:519] INFO Train time: 1.37927s. Valid time: 1.41125s
Wed, 25 Dec 2024 15:10:32 recommender.py[line:254] INFO Training: Epoch= 24 [recall@10=0.1937 ndcg@10=0.0999 train_loss=5.3723]
Wed, 25 Dec 2024 15:10:32 recommender.py[line:519] INFO Train time: 1.35363s. Valid time: 1.39426s
Wed, 25 Dec 2024 15:10:33 recommender.py[line:254] INFO Training: Epoch= 25 [recall@10=0.1873 ndcg@10=0.0962 train_loss=5.3607]
Wed, 25 Dec 2024 15:10:33 recommender.py[line:519] INFO Train time: 1.44693s. Valid time: 1.48674s
Wed, 25 Dec 2024 15:10:35 recommender.py[line:254] INFO Training: Epoch= 26 [recall@10=0.1873 ndcg@10=0.0957 train_loss=5.3545]
Wed, 25 Dec 2024 15:10:35 recommender.py[line:519] INFO Train time: 1.34535s. Valid time: 1.37659s
Wed, 25 Dec 2024 15:10:36 recommender.py[line:254] INFO Training: Epoch= 27 [recall@10=0.2095 ndcg@10=0.1045 train_loss=5.3353]
Wed, 25 Dec 2024 15:10:36 recommender.py[line:519] INFO Train time: 1.41928s. Valid time: 1.44845s
Wed, 25 Dec 2024 15:10:37 recommender.py[line:254] INFO Training: Epoch= 28 [recall@10=0.2032 ndcg@10=0.1005 train_loss=5.3369]
Wed, 25 Dec 2024 15:10:37 recommender.py[line:519] INFO Train time: 1.34140s. Valid time: 1.37959s
Wed, 25 Dec 2024 15:10:39 recommender.py[line:254] INFO Training: Epoch= 29 [recall@10=0.1968 ndcg@10=0.1005 train_loss=5.3169]
Wed, 25 Dec 2024 15:10:39 recommender.py[line:519] INFO Train time: 1.37237s. Valid time: 1.39764s
Wed, 25 Dec 2024 15:10:40 recommender.py[line:254] INFO Training: Epoch= 30 [recall@10=0.1905 ndcg@10=0.1038 train_loss=5.3112]
Wed, 25 Dec 2024 15:10:40 recommender.py[line:519] INFO Train time: 1.37231s. Valid time: 1.41482s
Wed, 25 Dec 2024 15:10:42 recommender.py[line:254] INFO Training: Epoch= 31 [recall@10=0.1937 ndcg@10=0.1033 train_loss=5.3024]
Wed, 25 Dec 2024 15:10:42 recommender.py[line:519] INFO Train time: 1.29070s. Valid time: 1.33226s
Wed, 25 Dec 2024 15:10:43 recommender.py[line:254] INFO Training: Epoch= 32 [recall@10=0.2095 ndcg@10=0.1050 train_loss=5.3018]
Wed, 25 Dec 2024 15:10:43 recommender.py[line:519] INFO Train time: 1.43392s. Valid time: 1.47312s
Wed, 25 Dec 2024 15:10:44 recommender.py[line:254] INFO Training: Epoch= 33 [recall@10=0.1968 ndcg@10=0.0980 train_loss=5.2922]
Wed, 25 Dec 2024 15:10:44 recommender.py[line:519] INFO Train time: 1.34646s. Valid time: 1.37634s
Wed, 25 Dec 2024 15:10:44 recommender.py[line:559] INFO Early stopped. recall@10 didn't improve for 20 epochs.
Wed, 25 Dec 2024 15:10:44 recommender.py[line:562] INFO The best score of recall@10 is 0.2159 at 13
Wed, 25 Dec 2024 15:10:44 recommender.py[line:730] INFO Best model checkpoiny saved in ./metadata/model_checkpoint/shadow_model/ml-100k/BERT4Rec/split/train/nonmember_model_6.
Wed, 25 Dec 2024 15:10:44 shadow.py[line:57] INFO Shadow model recommendation performance:
Wed, 25 Dec 2024 15:10:44 recommender.py[line:196] INFO Testing:  [recall@10=0.1587 precision@10=0.0159 map@10=0.0528 ndcg@10=0.0776 mrr@10=0.0528 hit@10=0.1587]
Wed, 25 Dec 2024 15:10:50 shadow.py[line:292] INFO End of the code.
