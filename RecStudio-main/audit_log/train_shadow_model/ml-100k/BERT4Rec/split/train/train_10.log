Wed, 25 Dec 2024 15:09:00 shadow.py[line:150] INFO {'dataset': 'ml-100k', 'model': 'BERT4Rec', 'split_seed': 10, 'gpu': 3, 'split_cf': 'split', 'train_cf': 'train'}
Wed, 25 Dec 2024 15:09:00 utils.py[line:224] INFO dataset is read from ../datasets/ml-100k.
Wed, 25 Dec 2024 15:09:01 utils.py[line:38] INFO 
Dataset Info: 

==================================================
item information: 
field     item_id   
type      token     
##        1153      
==================================================
user information: 
field     user_id   
type      token     
##        944       
==================================================
interaction information: 
field     user_id   item_id   rating    timestamp 
type      token     token     float     float     
##        944       1153      -         -         
==================================================
Sparsity: 0.909832
==================================================
Wed, 25 Dec 2024 15:09:02 utils.py[line:297] INFO Global seed set to 2019
Wed, 25 Dec 2024 15:09:02 utils.py[line:62] INFO 
Model Config: 

accelerator=gpu
activation=gelu
ann=None
batch_size=1024
cutoff=10
dataset_neg_count=None
dataset_sampler=None
dropout=0.2
early_stop_mode=max
early_stop_patience=20
embed_dim=64
epochs=100
eval_batch_size=128
excluding_hist=False
gpu=[3]
head_num=2
hidden_size=128
item_bias=False
layer_norm_eps=1e-12
layer_num=2
learner=adam
learning_rate=0.001
mask_ratio=0.2
negative_count=1
num_workers=0
pooling_type=mask
save_path=./saved/
scheduler=None
seed=2019
split_ratio=2
steal=False
test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
test_repetitive=True
topk=100
train_repetitive=True
val_metrics=['recall', 'ndcg']
weight_decay=1e-05
Wed, 25 Dec 2024 15:09:02 utils.py[line:297] INFO Global seed set to 2019
Wed, 25 Dec 2024 15:09:02 utils.py[line:62] INFO 
Model Config: 

accelerator=gpu
activation=gelu
ann=None
batch_size=1024
cutoff=10
dataset_neg_count=None
dataset_sampler=None
dropout=0.2
early_stop_mode=max
early_stop_patience=20
embed_dim=64
epochs=100
eval_batch_size=128
excluding_hist=False
gpu=[3]
head_num=2
hidden_size=128
item_bias=False
layer_norm_eps=1e-12
layer_num=2
learner=adam
learning_rate=0.001
mask_ratio=0.2
negative_count=1
num_workers=0
pooling_type=mask
save_path=./saved/
scheduler=None
seed=2019
split_ratio=2
steal=False
test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
test_repetitive=True
topk=100
train_repetitive=True
val_metrics=['recall', 'ndcg']
weight_decay=1e-05
Wed, 25 Dec 2024 15:09:02 recommender.py[line:128] INFO save_dir:/data1/home/zhihao/code/RecAudit/open-source/RecAudit/RecStudio-main
Wed, 25 Dec 2024 15:09:02 recommender.py[line:131] INFO BERT4Rec(
  (loss_fn): SoftmaxLoss()
  (score_func): InnerProductScorer()
  (item_encoder): Embedding(1154, 64, padding_idx=0)
  (query_encoder): BERT4RecQueryEncoder(
    (item_encoder): Embedding(1154, 64, padding_idx=0)
    (position_emb): Embedding(20, 64)
    (transformer_layer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
      )
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (training_pooling_layer): SeqPoolingLayer(pooling_type=mask, keepdim=False)
    (eval_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
  )
)
Wed, 25 Dec 2024 15:09:08 recommender.py[line:254] INFO Training: Epoch=  0 [recall@10=0.0573 ndcg@10=0.0270 train_loss=6.8026]
Wed, 25 Dec 2024 15:09:08 recommender.py[line:519] INFO Train time: 1.76255s. Valid time: 1.79390s
Wed, 25 Dec 2024 15:09:08 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0573
Wed, 25 Dec 2024 15:09:10 recommender.py[line:254] INFO Training: Epoch=  1 [recall@10=0.0605 ndcg@10=0.0301 train_loss=6.6150]
Wed, 25 Dec 2024 15:09:10 recommender.py[line:519] INFO Train time: 1.45557s. Valid time: 1.49268s
Wed, 25 Dec 2024 15:09:10 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0605
Wed, 25 Dec 2024 15:09:11 recommender.py[line:254] INFO Training: Epoch=  2 [recall@10=0.1529 ndcg@10=0.0720 train_loss=6.3796]
Wed, 25 Dec 2024 15:09:11 recommender.py[line:519] INFO Train time: 1.31441s. Valid time: 1.34104s
Wed, 25 Dec 2024 15:09:11 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1529
Wed, 25 Dec 2024 15:09:13 recommender.py[line:254] INFO Training: Epoch=  3 [recall@10=0.1401 ndcg@10=0.0745 train_loss=6.1092]
Wed, 25 Dec 2024 15:09:13 recommender.py[line:519] INFO Train time: 1.42337s. Valid time: 1.46135s
Wed, 25 Dec 2024 15:09:14 recommender.py[line:254] INFO Training: Epoch=  4 [recall@10=0.1242 ndcg@10=0.0623 train_loss=5.9378]
Wed, 25 Dec 2024 15:09:14 recommender.py[line:519] INFO Train time: 1.44948s. Valid time: 1.48284s
Wed, 25 Dec 2024 15:09:16 recommender.py[line:254] INFO Training: Epoch=  5 [recall@10=0.1369 ndcg@10=0.0664 train_loss=5.9153]
Wed, 25 Dec 2024 15:09:16 recommender.py[line:519] INFO Train time: 1.37770s. Valid time: 1.41293s
Wed, 25 Dec 2024 15:09:17 recommender.py[line:254] INFO Training: Epoch=  6 [recall@10=0.1274 ndcg@10=0.0633 train_loss=5.8581]
Wed, 25 Dec 2024 15:09:17 recommender.py[line:519] INFO Train time: 1.42529s. Valid time: 1.46308s
Wed, 25 Dec 2024 15:09:18 recommender.py[line:254] INFO Training: Epoch=  7 [recall@10=0.1306 ndcg@10=0.0623 train_loss=5.8122]
Wed, 25 Dec 2024 15:09:18 recommender.py[line:519] INFO Train time: 1.33359s. Valid time: 1.36990s
Wed, 25 Dec 2024 15:09:20 recommender.py[line:254] INFO Training: Epoch=  8 [recall@10=0.1369 ndcg@10=0.0665 train_loss=5.7895]
Wed, 25 Dec 2024 15:09:20 recommender.py[line:519] INFO Train time: 1.48109s. Valid time: 1.50135s
Wed, 25 Dec 2024 15:09:21 recommender.py[line:254] INFO Training: Epoch=  9 [recall@10=0.1210 ndcg@10=0.0604 train_loss=5.7692]
Wed, 25 Dec 2024 15:09:21 recommender.py[line:519] INFO Train time: 1.39596s. Valid time: 1.43247s
Wed, 25 Dec 2024 15:09:23 recommender.py[line:254] INFO Training: Epoch= 10 [recall@10=0.1242 ndcg@10=0.0716 train_loss=5.7414]
Wed, 25 Dec 2024 15:09:23 recommender.py[line:519] INFO Train time: 1.38319s. Valid time: 1.41423s
Wed, 25 Dec 2024 15:09:24 recommender.py[line:254] INFO Training: Epoch= 11 [recall@10=0.1306 ndcg@10=0.0641 train_loss=5.7123]
Wed, 25 Dec 2024 15:09:24 recommender.py[line:519] INFO Train time: 1.43533s. Valid time: 1.47358s
Wed, 25 Dec 2024 15:09:26 recommender.py[line:254] INFO Training: Epoch= 12 [recall@10=0.1274 ndcg@10=0.0600 train_loss=5.6686]
Wed, 25 Dec 2024 15:09:26 recommender.py[line:519] INFO Train time: 1.32692s. Valid time: 1.35067s
Wed, 25 Dec 2024 15:09:27 recommender.py[line:254] INFO Training: Epoch= 13 [recall@10=0.1338 ndcg@10=0.0592 train_loss=5.6765]
Wed, 25 Dec 2024 15:09:27 recommender.py[line:519] INFO Train time: 1.48480s. Valid time: 1.51984s
Wed, 25 Dec 2024 15:09:29 recommender.py[line:254] INFO Training: Epoch= 14 [recall@10=0.1338 ndcg@10=0.0581 train_loss=5.6384]
Wed, 25 Dec 2024 15:09:29 recommender.py[line:519] INFO Train time: 1.44147s. Valid time: 1.47477s
Wed, 25 Dec 2024 15:09:30 recommender.py[line:254] INFO Training: Epoch= 15 [recall@10=0.1433 ndcg@10=0.0682 train_loss=5.6627]
Wed, 25 Dec 2024 15:09:30 recommender.py[line:519] INFO Train time: 1.40120s. Valid time: 1.44017s
Wed, 25 Dec 2024 15:09:32 recommender.py[line:254] INFO Training: Epoch= 16 [recall@10=0.1338 ndcg@10=0.0673 train_loss=5.6317]
Wed, 25 Dec 2024 15:09:32 recommender.py[line:519] INFO Train time: 1.41587s. Valid time: 1.45822s
Wed, 25 Dec 2024 15:09:33 recommender.py[line:254] INFO Training: Epoch= 17 [recall@10=0.1369 ndcg@10=0.0647 train_loss=5.6169]
Wed, 25 Dec 2024 15:09:33 recommender.py[line:519] INFO Train time: 1.30983s. Valid time: 1.34767s
Wed, 25 Dec 2024 15:09:34 recommender.py[line:254] INFO Training: Epoch= 18 [recall@10=0.1369 ndcg@10=0.0594 train_loss=5.6115]
Wed, 25 Dec 2024 15:09:34 recommender.py[line:519] INFO Train time: 1.58109s. Valid time: 1.61736s
Wed, 25 Dec 2024 15:09:36 recommender.py[line:254] INFO Training: Epoch= 19 [recall@10=0.1401 ndcg@10=0.0681 train_loss=5.5889]
Wed, 25 Dec 2024 15:09:36 recommender.py[line:519] INFO Train time: 1.47808s. Valid time: 1.50762s
Wed, 25 Dec 2024 15:09:38 recommender.py[line:254] INFO Training: Epoch= 20 [recall@10=0.1529 ndcg@10=0.0716 train_loss=5.5844]
Wed, 25 Dec 2024 15:09:38 recommender.py[line:519] INFO Train time: 1.71549s. Valid time: 1.75143s
Wed, 25 Dec 2024 15:09:39 recommender.py[line:254] INFO Training: Epoch= 21 [recall@10=0.1465 ndcg@10=0.0688 train_loss=5.5541]
Wed, 25 Dec 2024 15:09:39 recommender.py[line:519] INFO Train time: 1.38306s. Valid time: 1.40686s
Wed, 25 Dec 2024 15:09:40 recommender.py[line:254] INFO Training: Epoch= 22 [recall@10=0.1465 ndcg@10=0.0733 train_loss=5.5667]
Wed, 25 Dec 2024 15:09:40 recommender.py[line:519] INFO Train time: 1.29517s. Valid time: 1.32888s
Wed, 25 Dec 2024 15:09:40 recommender.py[line:559] INFO Early stopped. recall@10 didn't improve for 20 epochs.
Wed, 25 Dec 2024 15:09:40 recommender.py[line:562] INFO The best score of recall@10 is 0.1529 at 2
Wed, 25 Dec 2024 15:09:40 recommender.py[line:730] INFO Best model checkpoiny saved in ./metadata/model_checkpoint/shadow_model/ml-100k/BERT4Rec/split/train/member_model_10.
Wed, 25 Dec 2024 15:09:41 shadow.py[line:57] INFO Shadow model recommendation performance:
Wed, 25 Dec 2024 15:09:41 recommender.py[line:196] INFO Testing:  [recall@10=0.0701 precision@10=0.0070 map@10=0.0283 ndcg@10=0.0381 mrr@10=0.0283 hit@10=0.0701]
Wed, 25 Dec 2024 15:09:41 recommender.py[line:128] INFO save_dir:/data1/home/zhihao/code/RecAudit/open-source/RecAudit/RecStudio-main
Wed, 25 Dec 2024 15:09:41 recommender.py[line:131] INFO BERT4Rec(
  (loss_fn): SoftmaxLoss()
  (score_func): InnerProductScorer()
  (item_encoder): Embedding(1154, 64, padding_idx=0)
  (query_encoder): BERT4RecQueryEncoder(
    (item_encoder): Embedding(1154, 64, padding_idx=0)
    (position_emb): Embedding(20, 64)
    (transformer_layer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
      )
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (training_pooling_layer): SeqPoolingLayer(pooling_type=mask, keepdim=False)
    (eval_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
  )
)
Wed, 25 Dec 2024 15:09:42 recommender.py[line:254] INFO Training: Epoch=  0 [recall@10=0.0381 ndcg@10=0.0157 train_loss=6.7947]
Wed, 25 Dec 2024 15:09:42 recommender.py[line:519] INFO Train time: 1.36997s. Valid time: 1.40472s
Wed, 25 Dec 2024 15:09:42 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0381
Wed, 25 Dec 2024 15:09:44 recommender.py[line:254] INFO Training: Epoch=  1 [recall@10=0.0667 ndcg@10=0.0352 train_loss=6.5838]
Wed, 25 Dec 2024 15:09:44 recommender.py[line:519] INFO Train time: 1.67227s. Valid time: 1.71426s
Wed, 25 Dec 2024 15:09:44 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0667
Wed, 25 Dec 2024 15:09:45 recommender.py[line:254] INFO Training: Epoch=  2 [recall@10=0.1397 ndcg@10=0.0702 train_loss=6.2728]
Wed, 25 Dec 2024 15:09:45 recommender.py[line:519] INFO Train time: 1.41111s. Valid time: 1.43620s
Wed, 25 Dec 2024 15:09:45 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1397
Wed, 25 Dec 2024 15:09:47 recommender.py[line:254] INFO Training: Epoch=  3 [recall@10=0.1365 ndcg@10=0.0666 train_loss=6.0086]
Wed, 25 Dec 2024 15:09:47 recommender.py[line:519] INFO Train time: 1.37667s. Valid time: 1.41562s
Wed, 25 Dec 2024 15:09:48 recommender.py[line:254] INFO Training: Epoch=  4 [recall@10=0.1270 ndcg@10=0.0615 train_loss=5.9005]
Wed, 25 Dec 2024 15:09:48 recommender.py[line:519] INFO Train time: 1.31932s. Valid time: 1.35073s
Wed, 25 Dec 2024 15:09:50 recommender.py[line:254] INFO Training: Epoch=  5 [recall@10=0.1143 ndcg@10=0.0612 train_loss=5.8337]
Wed, 25 Dec 2024 15:09:50 recommender.py[line:519] INFO Train time: 1.58477s. Valid time: 1.62624s
Wed, 25 Dec 2024 15:09:51 recommender.py[line:254] INFO Training: Epoch=  6 [recall@10=0.1143 ndcg@10=0.0629 train_loss=5.7806]
Wed, 25 Dec 2024 15:09:51 recommender.py[line:519] INFO Train time: 1.41351s. Valid time: 1.45298s
Wed, 25 Dec 2024 15:09:52 recommender.py[line:254] INFO Training: Epoch=  7 [recall@10=0.1238 ndcg@10=0.0667 train_loss=5.7393]
Wed, 25 Dec 2024 15:09:52 recommender.py[line:519] INFO Train time: 1.40428s. Valid time: 1.43289s
Wed, 25 Dec 2024 15:09:54 recommender.py[line:254] INFO Training: Epoch=  8 [recall@10=0.1587 ndcg@10=0.0752 train_loss=5.6899]
Wed, 25 Dec 2024 15:09:54 recommender.py[line:519] INFO Train time: 1.44434s. Valid time: 1.48141s
Wed, 25 Dec 2024 15:09:54 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1587
Wed, 25 Dec 2024 15:09:55 recommender.py[line:254] INFO Training: Epoch=  9 [recall@10=0.1651 ndcg@10=0.0842 train_loss=5.6558]
Wed, 25 Dec 2024 15:09:55 recommender.py[line:519] INFO Train time: 1.35981s. Valid time: 1.38315s
Wed, 25 Dec 2024 15:09:55 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1651
Wed, 25 Dec 2024 15:09:57 recommender.py[line:254] INFO Training: Epoch= 10 [recall@10=0.1683 ndcg@10=0.0842 train_loss=5.6353]
Wed, 25 Dec 2024 15:09:57 recommender.py[line:519] INFO Train time: 1.51090s. Valid time: 1.55242s
Wed, 25 Dec 2024 15:09:57 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1683
Wed, 25 Dec 2024 15:09:58 recommender.py[line:254] INFO Training: Epoch= 11 [recall@10=0.1714 ndcg@10=0.0844 train_loss=5.6037]
Wed, 25 Dec 2024 15:09:58 recommender.py[line:519] INFO Train time: 1.43069s. Valid time: 1.47648s
Wed, 25 Dec 2024 15:09:58 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1714
Wed, 25 Dec 2024 15:10:00 recommender.py[line:254] INFO Training: Epoch= 12 [recall@10=0.1714 ndcg@10=0.0894 train_loss=5.5811]
Wed, 25 Dec 2024 15:10:00 recommender.py[line:519] INFO Train time: 1.42582s. Valid time: 1.47404s
Wed, 25 Dec 2024 15:10:01 recommender.py[line:254] INFO Training: Epoch= 13 [recall@10=0.1746 ndcg@10=0.0886 train_loss=5.5641]
Wed, 25 Dec 2024 15:10:01 recommender.py[line:519] INFO Train time: 1.38644s. Valid time: 1.43042s
Wed, 25 Dec 2024 15:10:01 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1746
Wed, 25 Dec 2024 15:10:03 recommender.py[line:254] INFO Training: Epoch= 14 [recall@10=0.1714 ndcg@10=0.0892 train_loss=5.5503]
Wed, 25 Dec 2024 15:10:03 recommender.py[line:519] INFO Train time: 1.72388s. Valid time: 1.76374s
Wed, 25 Dec 2024 15:10:04 recommender.py[line:254] INFO Training: Epoch= 15 [recall@10=0.1937 ndcg@10=0.0957 train_loss=5.5228]
Wed, 25 Dec 2024 15:10:04 recommender.py[line:519] INFO Train time: 1.39794s. Valid time: 1.43328s
Wed, 25 Dec 2024 15:10:04 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1937
Wed, 25 Dec 2024 15:10:06 recommender.py[line:254] INFO Training: Epoch= 16 [recall@10=0.1746 ndcg@10=0.0980 train_loss=5.5166]
Wed, 25 Dec 2024 15:10:06 recommender.py[line:519] INFO Train time: 1.26555s. Valid time: 1.30024s
Wed, 25 Dec 2024 15:10:07 recommender.py[line:254] INFO Training: Epoch= 17 [recall@10=0.1841 ndcg@10=0.1019 train_loss=5.4987]
Wed, 25 Dec 2024 15:10:07 recommender.py[line:519] INFO Train time: 1.37066s. Valid time: 1.39703s
Wed, 25 Dec 2024 15:10:09 recommender.py[line:254] INFO Training: Epoch= 18 [recall@10=0.1810 ndcg@10=0.1026 train_loss=5.4885]
Wed, 25 Dec 2024 15:10:09 recommender.py[line:519] INFO Train time: 1.32036s. Valid time: 1.36364s
Wed, 25 Dec 2024 15:10:10 recommender.py[line:254] INFO Training: Epoch= 19 [recall@10=0.1810 ndcg@10=0.0999 train_loss=5.4853]
Wed, 25 Dec 2024 15:10:10 recommender.py[line:519] INFO Train time: 1.49975s. Valid time: 1.54408s
Wed, 25 Dec 2024 15:10:12 recommender.py[line:254] INFO Training: Epoch= 20 [recall@10=0.1905 ndcg@10=0.0987 train_loss=5.4644]
Wed, 25 Dec 2024 15:10:12 recommender.py[line:519] INFO Train time: 1.46887s. Valid time: 1.50713s
Wed, 25 Dec 2024 15:10:13 recommender.py[line:254] INFO Training: Epoch= 21 [recall@10=0.1873 ndcg@10=0.1050 train_loss=5.4558]
Wed, 25 Dec 2024 15:10:13 recommender.py[line:519] INFO Train time: 1.39086s. Valid time: 1.43255s
Wed, 25 Dec 2024 15:10:15 recommender.py[line:254] INFO Training: Epoch= 22 [recall@10=0.1841 ndcg@10=0.1030 train_loss=5.4376]
Wed, 25 Dec 2024 15:10:15 recommender.py[line:519] INFO Train time: 1.46510s. Valid time: 1.51543s
Wed, 25 Dec 2024 15:10:16 recommender.py[line:254] INFO Training: Epoch= 23 [recall@10=0.1810 ndcg@10=0.1057 train_loss=5.4277]
Wed, 25 Dec 2024 15:10:16 recommender.py[line:519] INFO Train time: 1.64804s. Valid time: 1.69012s
Wed, 25 Dec 2024 15:10:18 recommender.py[line:254] INFO Training: Epoch= 24 [recall@10=0.1778 ndcg@10=0.0977 train_loss=5.4112]
Wed, 25 Dec 2024 15:10:18 recommender.py[line:519] INFO Train time: 1.46317s. Valid time: 1.49920s
Wed, 25 Dec 2024 15:10:19 recommender.py[line:254] INFO Training: Epoch= 25 [recall@10=0.1873 ndcg@10=0.1016 train_loss=5.3996]
Wed, 25 Dec 2024 15:10:19 recommender.py[line:519] INFO Train time: 1.34908s. Valid time: 1.38744s
Wed, 25 Dec 2024 15:10:21 recommender.py[line:254] INFO Training: Epoch= 26 [recall@10=0.1746 ndcg@10=0.0948 train_loss=5.3950]
Wed, 25 Dec 2024 15:10:21 recommender.py[line:519] INFO Train time: 1.40907s. Valid time: 1.44638s
Wed, 25 Dec 2024 15:10:22 recommender.py[line:254] INFO Training: Epoch= 27 [recall@10=0.1778 ndcg@10=0.1004 train_loss=5.3902]
Wed, 25 Dec 2024 15:10:22 recommender.py[line:519] INFO Train time: 1.44853s. Valid time: 1.48617s
Wed, 25 Dec 2024 15:10:23 recommender.py[line:254] INFO Training: Epoch= 28 [recall@10=0.1714 ndcg@10=0.0896 train_loss=5.3795]
Wed, 25 Dec 2024 15:10:23 recommender.py[line:519] INFO Train time: 1.32135s. Valid time: 1.36000s
Wed, 25 Dec 2024 15:10:25 recommender.py[line:254] INFO Training: Epoch= 29 [recall@10=0.2032 ndcg@10=0.1035 train_loss=5.3666]
Wed, 25 Dec 2024 15:10:25 recommender.py[line:519] INFO Train time: 1.46026s. Valid time: 1.49405s
Wed, 25 Dec 2024 15:10:25 recommender.py[line:548] INFO recall@10 improved. Best value: 0.2032
Wed, 25 Dec 2024 15:10:26 recommender.py[line:254] INFO Training: Epoch= 30 [recall@10=0.1905 ndcg@10=0.0957 train_loss=5.3579]
Wed, 25 Dec 2024 15:10:26 recommender.py[line:519] INFO Train time: 1.38016s. Valid time: 1.41312s
Wed, 25 Dec 2024 15:10:28 recommender.py[line:254] INFO Training: Epoch= 31 [recall@10=0.1873 ndcg@10=0.0971 train_loss=5.3577]
Wed, 25 Dec 2024 15:10:28 recommender.py[line:519] INFO Train time: 1.43321s. Valid time: 1.46047s
Wed, 25 Dec 2024 15:10:29 recommender.py[line:254] INFO Training: Epoch= 32 [recall@10=0.1714 ndcg@10=0.0938 train_loss=5.3581]
Wed, 25 Dec 2024 15:10:29 recommender.py[line:519] INFO Train time: 1.48760s. Valid time: 1.51710s
Wed, 25 Dec 2024 15:10:31 recommender.py[line:254] INFO Training: Epoch= 33 [recall@10=0.1714 ndcg@10=0.0900 train_loss=5.3404]
Wed, 25 Dec 2024 15:10:31 recommender.py[line:519] INFO Train time: 1.34169s. Valid time: 1.37932s
Wed, 25 Dec 2024 15:10:32 recommender.py[line:254] INFO Training: Epoch= 34 [recall@10=0.1905 ndcg@10=0.1008 train_loss=5.3371]
Wed, 25 Dec 2024 15:10:32 recommender.py[line:519] INFO Train time: 1.36952s. Valid time: 1.41002s
Wed, 25 Dec 2024 15:10:34 recommender.py[line:254] INFO Training: Epoch= 35 [recall@10=0.1714 ndcg@10=0.0980 train_loss=5.3259]
Wed, 25 Dec 2024 15:10:34 recommender.py[line:519] INFO Train time: 1.35314s. Valid time: 1.39393s
Wed, 25 Dec 2024 15:10:35 recommender.py[line:254] INFO Training: Epoch= 36 [recall@10=0.1968 ndcg@10=0.1019 train_loss=5.3295]
Wed, 25 Dec 2024 15:10:35 recommender.py[line:519] INFO Train time: 1.42550s. Valid time: 1.45576s
Wed, 25 Dec 2024 15:10:36 recommender.py[line:254] INFO Training: Epoch= 37 [recall@10=0.1778 ndcg@10=0.0951 train_loss=5.3184]
Wed, 25 Dec 2024 15:10:36 recommender.py[line:519] INFO Train time: 1.31709s. Valid time: 1.34739s
Wed, 25 Dec 2024 15:10:38 recommender.py[line:254] INFO Training: Epoch= 38 [recall@10=0.1841 ndcg@10=0.0993 train_loss=5.3018]
Wed, 25 Dec 2024 15:10:38 recommender.py[line:519] INFO Train time: 1.43579s. Valid time: 1.46223s
Wed, 25 Dec 2024 15:10:39 recommender.py[line:254] INFO Training: Epoch= 39 [recall@10=0.1937 ndcg@10=0.0985 train_loss=5.2987]
Wed, 25 Dec 2024 15:10:39 recommender.py[line:519] INFO Train time: 1.42528s. Valid time: 1.46019s
Wed, 25 Dec 2024 15:10:41 recommender.py[line:254] INFO Training: Epoch= 40 [recall@10=0.1746 ndcg@10=0.0962 train_loss=5.2981]
Wed, 25 Dec 2024 15:10:41 recommender.py[line:519] INFO Train time: 1.33732s. Valid time: 1.37631s
Wed, 25 Dec 2024 15:10:42 recommender.py[line:254] INFO Training: Epoch= 41 [recall@10=0.1873 ndcg@10=0.1001 train_loss=5.2865]
Wed, 25 Dec 2024 15:10:42 recommender.py[line:519] INFO Train time: 1.49763s. Valid time: 1.54033s
Wed, 25 Dec 2024 15:10:44 recommender.py[line:254] INFO Training: Epoch= 42 [recall@10=0.1873 ndcg@10=0.0994 train_loss=5.2847]
Wed, 25 Dec 2024 15:10:44 recommender.py[line:519] INFO Train time: 1.33534s. Valid time: 1.36023s
Wed, 25 Dec 2024 15:10:45 recommender.py[line:254] INFO Training: Epoch= 43 [recall@10=0.1746 ndcg@10=0.0931 train_loss=5.2731]
Wed, 25 Dec 2024 15:10:45 recommender.py[line:519] INFO Train time: 1.49709s. Valid time: 1.52960s
Wed, 25 Dec 2024 15:10:47 recommender.py[line:254] INFO Training: Epoch= 44 [recall@10=0.1810 ndcg@10=0.0939 train_loss=5.2685]
Wed, 25 Dec 2024 15:10:47 recommender.py[line:519] INFO Train time: 1.43969s. Valid time: 1.47239s
Wed, 25 Dec 2024 15:10:48 recommender.py[line:254] INFO Training: Epoch= 45 [recall@10=0.1810 ndcg@10=0.0954 train_loss=5.2624]
Wed, 25 Dec 2024 15:10:48 recommender.py[line:519] INFO Train time: 1.34698s. Valid time: 1.38295s
Wed, 25 Dec 2024 15:10:49 recommender.py[line:254] INFO Training: Epoch= 46 [recall@10=0.1810 ndcg@10=0.0949 train_loss=5.2572]
Wed, 25 Dec 2024 15:10:49 recommender.py[line:519] INFO Train time: 1.44826s. Valid time: 1.48370s
Wed, 25 Dec 2024 15:10:51 recommender.py[line:254] INFO Training: Epoch= 47 [recall@10=0.1683 ndcg@10=0.0846 train_loss=5.2540]
Wed, 25 Dec 2024 15:10:51 recommender.py[line:519] INFO Train time: 1.40505s. Valid time: 1.44168s
Wed, 25 Dec 2024 15:10:52 recommender.py[line:254] INFO Training: Epoch= 48 [recall@10=0.1873 ndcg@10=0.0964 train_loss=5.2429]
Wed, 25 Dec 2024 15:10:52 recommender.py[line:519] INFO Train time: 1.46927s. Valid time: 1.50579s
Wed, 25 Dec 2024 15:10:54 recommender.py[line:254] INFO Training: Epoch= 49 [recall@10=0.1873 ndcg@10=0.0920 train_loss=5.2438]
Wed, 25 Dec 2024 15:10:54 recommender.py[line:519] INFO Train time: 1.46623s. Valid time: 1.49722s
Wed, 25 Dec 2024 15:10:54 recommender.py[line:559] INFO Early stopped. recall@10 didn't improve for 20 epochs.
Wed, 25 Dec 2024 15:10:54 recommender.py[line:562] INFO The best score of recall@10 is 0.2032 at 29
Wed, 25 Dec 2024 15:10:54 recommender.py[line:730] INFO Best model checkpoiny saved in ./metadata/model_checkpoint/shadow_model/ml-100k/BERT4Rec/split/train/nonmember_model_10.
Wed, 25 Dec 2024 15:10:54 shadow.py[line:57] INFO Shadow model recommendation performance:
Wed, 25 Dec 2024 15:10:54 recommender.py[line:196] INFO Testing:  [recall@10=0.2127 precision@10=0.0213 map@10=0.0721 ndcg@10=0.1047 mrr@10=0.0721 hit@10=0.2127]
Wed, 25 Dec 2024 15:11:00 shadow.py[line:292] INFO End of the code.
