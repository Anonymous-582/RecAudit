Wed, 25 Dec 2024 15:09:00 shadow.py[line:150] INFO {'dataset': 'ml-100k', 'model': 'BERT4Rec', 'split_seed': 15, 'gpu': 4, 'split_cf': 'split', 'train_cf': 'train'}
Wed, 25 Dec 2024 15:09:00 utils.py[line:224] INFO dataset is read from ../datasets/ml-100k.
Wed, 25 Dec 2024 15:09:00 utils.py[line:38] INFO 
Dataset Info: 

==================================================
item information: 
field     item_id   
type      token     
##        1153      
==================================================
user information: 
field     user_id   
type      token     
##        944       
==================================================
interaction information: 
field     user_id   item_id   rating    timestamp 
type      token     token     float     float     
##        944       1153      -         -         
==================================================
Sparsity: 0.909832
==================================================
Wed, 25 Dec 2024 15:09:02 utils.py[line:297] INFO Global seed set to 2019
Wed, 25 Dec 2024 15:09:02 utils.py[line:62] INFO 
Model Config: 

accelerator=gpu
activation=gelu
ann=None
batch_size=1024
cutoff=10
dataset_neg_count=None
dataset_sampler=None
dropout=0.2
early_stop_mode=max
early_stop_patience=20
embed_dim=64
epochs=100
eval_batch_size=128
excluding_hist=False
gpu=[4]
head_num=2
hidden_size=128
item_bias=False
layer_norm_eps=1e-12
layer_num=2
learner=adam
learning_rate=0.001
mask_ratio=0.2
negative_count=1
num_workers=0
pooling_type=mask
save_path=./saved/
scheduler=None
seed=2019
split_ratio=2
steal=False
test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
test_repetitive=True
topk=100
train_repetitive=True
val_metrics=['recall', 'ndcg']
weight_decay=1e-05
Wed, 25 Dec 2024 15:09:02 utils.py[line:297] INFO Global seed set to 2019
Wed, 25 Dec 2024 15:09:02 utils.py[line:62] INFO 
Model Config: 

accelerator=gpu
activation=gelu
ann=None
batch_size=1024
cutoff=10
dataset_neg_count=None
dataset_sampler=None
dropout=0.2
early_stop_mode=max
early_stop_patience=20
embed_dim=64
epochs=100
eval_batch_size=128
excluding_hist=False
gpu=[4]
head_num=2
hidden_size=128
item_bias=False
layer_norm_eps=1e-12
layer_num=2
learner=adam
learning_rate=0.001
mask_ratio=0.2
negative_count=1
num_workers=0
pooling_type=mask
save_path=./saved/
scheduler=None
seed=2019
split_ratio=2
steal=False
test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
test_repetitive=True
topk=100
train_repetitive=True
val_metrics=['recall', 'ndcg']
weight_decay=1e-05
Wed, 25 Dec 2024 15:09:02 recommender.py[line:128] INFO save_dir:/data1/home/zhihao/code/RecAudit/open-source/RecAudit/RecStudio-main
Wed, 25 Dec 2024 15:09:02 recommender.py[line:131] INFO BERT4Rec(
  (loss_fn): SoftmaxLoss()
  (score_func): InnerProductScorer()
  (item_encoder): Embedding(1154, 64, padding_idx=0)
  (query_encoder): BERT4RecQueryEncoder(
    (item_encoder): Embedding(1154, 64, padding_idx=0)
    (position_emb): Embedding(20, 64)
    (transformer_layer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
      )
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (training_pooling_layer): SeqPoolingLayer(pooling_type=mask, keepdim=False)
    (eval_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
  )
)
Wed, 25 Dec 2024 15:09:08 recommender.py[line:254] INFO Training: Epoch=  0 [recall@10=0.0478 ndcg@10=0.0263 train_loss=6.8028]
Wed, 25 Dec 2024 15:09:08 recommender.py[line:519] INFO Train time: 1.76402s. Valid time: 1.79480s
Wed, 25 Dec 2024 15:09:08 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0478
Wed, 25 Dec 2024 15:09:10 recommender.py[line:254] INFO Training: Epoch=  1 [recall@10=0.0605 ndcg@10=0.0267 train_loss=6.5812]
Wed, 25 Dec 2024 15:09:10 recommender.py[line:519] INFO Train time: 1.49916s. Valid time: 1.53807s
Wed, 25 Dec 2024 15:09:10 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0605
Wed, 25 Dec 2024 15:09:11 recommender.py[line:254] INFO Training: Epoch=  2 [recall@10=0.1306 ndcg@10=0.0640 train_loss=6.2861]
Wed, 25 Dec 2024 15:09:11 recommender.py[line:519] INFO Train time: 1.48347s. Valid time: 1.51768s
Wed, 25 Dec 2024 15:09:11 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1306
Wed, 25 Dec 2024 15:09:13 recommender.py[line:254] INFO Training: Epoch=  3 [recall@10=0.1210 ndcg@10=0.0547 train_loss=6.0100]
Wed, 25 Dec 2024 15:09:13 recommender.py[line:519] INFO Train time: 1.48547s. Valid time: 1.51725s
Wed, 25 Dec 2024 15:09:14 recommender.py[line:254] INFO Training: Epoch=  4 [recall@10=0.1306 ndcg@10=0.0561 train_loss=5.8901]
Wed, 25 Dec 2024 15:09:14 recommender.py[line:519] INFO Train time: 1.55499s. Valid time: 1.58593s
Wed, 25 Dec 2024 15:09:16 recommender.py[line:254] INFO Training: Epoch=  5 [recall@10=0.1274 ndcg@10=0.0562 train_loss=5.8273]
Wed, 25 Dec 2024 15:09:16 recommender.py[line:519] INFO Train time: 1.44956s. Valid time: 1.49165s
Wed, 25 Dec 2024 15:09:17 recommender.py[line:254] INFO Training: Epoch=  6 [recall@10=0.1274 ndcg@10=0.0566 train_loss=5.7637]
Wed, 25 Dec 2024 15:09:17 recommender.py[line:519] INFO Train time: 1.48141s. Valid time: 1.51298s
Wed, 25 Dec 2024 15:09:19 recommender.py[line:254] INFO Training: Epoch=  7 [recall@10=0.1529 ndcg@10=0.0735 train_loss=5.7153]
Wed, 25 Dec 2024 15:09:19 recommender.py[line:519] INFO Train time: 1.49318s. Valid time: 1.52657s
Wed, 25 Dec 2024 15:09:19 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1529
Wed, 25 Dec 2024 15:09:20 recommender.py[line:254] INFO Training: Epoch=  8 [recall@10=0.1306 ndcg@10=0.0585 train_loss=5.6739]
Wed, 25 Dec 2024 15:09:20 recommender.py[line:519] INFO Train time: 1.39224s. Valid time: 1.43007s
Wed, 25 Dec 2024 15:09:22 recommender.py[line:254] INFO Training: Epoch=  9 [recall@10=0.1497 ndcg@10=0.0655 train_loss=5.6661]
Wed, 25 Dec 2024 15:09:22 recommender.py[line:519] INFO Train time: 1.47098s. Valid time: 1.49802s
Wed, 25 Dec 2024 15:09:23 recommender.py[line:254] INFO Training: Epoch= 10 [recall@10=0.1433 ndcg@10=0.0657 train_loss=5.6356]
Wed, 25 Dec 2024 15:09:23 recommender.py[line:519] INFO Train time: 1.43201s. Valid time: 1.47653s
Wed, 25 Dec 2024 15:09:25 recommender.py[line:254] INFO Training: Epoch= 11 [recall@10=0.1401 ndcg@10=0.0578 train_loss=5.6090]
Wed, 25 Dec 2024 15:09:25 recommender.py[line:519] INFO Train time: 1.40755s. Valid time: 1.44704s
Wed, 25 Dec 2024 15:09:26 recommender.py[line:254] INFO Training: Epoch= 12 [recall@10=0.1465 ndcg@10=0.0673 train_loss=5.5963]
Wed, 25 Dec 2024 15:09:26 recommender.py[line:519] INFO Train time: 1.48489s. Valid time: 1.52777s
Wed, 25 Dec 2024 15:09:28 recommender.py[line:254] INFO Training: Epoch= 13 [recall@10=0.1561 ndcg@10=0.0730 train_loss=5.5785]
Wed, 25 Dec 2024 15:09:28 recommender.py[line:519] INFO Train time: 1.41208s. Valid time: 1.45064s
Wed, 25 Dec 2024 15:09:28 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1561
Wed, 25 Dec 2024 15:09:29 recommender.py[line:254] INFO Training: Epoch= 14 [recall@10=0.1465 ndcg@10=0.0745 train_loss=5.5678]
Wed, 25 Dec 2024 15:09:29 recommender.py[line:519] INFO Train time: 1.53154s. Valid time: 1.57002s
Wed, 25 Dec 2024 15:09:31 recommender.py[line:254] INFO Training: Epoch= 15 [recall@10=0.1465 ndcg@10=0.0712 train_loss=5.5501]
Wed, 25 Dec 2024 15:09:31 recommender.py[line:519] INFO Train time: 1.42056s. Valid time: 1.46091s
Wed, 25 Dec 2024 15:09:32 recommender.py[line:254] INFO Training: Epoch= 16 [recall@10=0.1529 ndcg@10=0.0755 train_loss=5.5449]
Wed, 25 Dec 2024 15:09:32 recommender.py[line:519] INFO Train time: 1.51569s. Valid time: 1.55066s
Wed, 25 Dec 2024 15:09:34 recommender.py[line:254] INFO Training: Epoch= 17 [recall@10=0.1529 ndcg@10=0.0757 train_loss=5.5317]
Wed, 25 Dec 2024 15:09:34 recommender.py[line:519] INFO Train time: 1.48770s. Valid time: 1.52162s
Wed, 25 Dec 2024 15:09:35 recommender.py[line:254] INFO Training: Epoch= 18 [recall@10=0.1529 ndcg@10=0.0701 train_loss=5.5164]
Wed, 25 Dec 2024 15:09:35 recommender.py[line:519] INFO Train time: 1.38165s. Valid time: 1.42708s
Wed, 25 Dec 2024 15:09:37 recommender.py[line:254] INFO Training: Epoch= 19 [recall@10=0.1497 ndcg@10=0.0740 train_loss=5.5088]
Wed, 25 Dec 2024 15:09:37 recommender.py[line:519] INFO Train time: 1.55871s. Valid time: 1.59839s
Wed, 25 Dec 2024 15:09:38 recommender.py[line:254] INFO Training: Epoch= 20 [recall@10=0.1561 ndcg@10=0.0691 train_loss=5.4927]
Wed, 25 Dec 2024 15:09:38 recommender.py[line:519] INFO Train time: 1.45508s. Valid time: 1.47970s
Wed, 25 Dec 2024 15:09:40 recommender.py[line:254] INFO Training: Epoch= 21 [recall@10=0.1433 ndcg@10=0.0736 train_loss=5.4796]
Wed, 25 Dec 2024 15:09:40 recommender.py[line:519] INFO Train time: 1.46508s. Valid time: 1.49499s
Wed, 25 Dec 2024 15:09:41 recommender.py[line:254] INFO Training: Epoch= 22 [recall@10=0.1815 ndcg@10=0.0868 train_loss=5.4716]
Wed, 25 Dec 2024 15:09:41 recommender.py[line:519] INFO Train time: 1.50919s. Valid time: 1.54173s
Wed, 25 Dec 2024 15:09:41 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1815
Wed, 25 Dec 2024 15:09:43 recommender.py[line:254] INFO Training: Epoch= 23 [recall@10=0.1624 ndcg@10=0.0838 train_loss=5.4649]
Wed, 25 Dec 2024 15:09:43 recommender.py[line:519] INFO Train time: 1.43504s. Valid time: 1.47297s
Wed, 25 Dec 2024 15:09:44 recommender.py[line:254] INFO Training: Epoch= 24 [recall@10=0.1720 ndcg@10=0.0818 train_loss=5.4617]
Wed, 25 Dec 2024 15:09:44 recommender.py[line:519] INFO Train time: 1.53143s. Valid time: 1.56552s
Wed, 25 Dec 2024 15:09:46 recommender.py[line:254] INFO Training: Epoch= 25 [recall@10=0.1688 ndcg@10=0.0825 train_loss=5.4394]
Wed, 25 Dec 2024 15:09:46 recommender.py[line:519] INFO Train time: 1.39743s. Valid time: 1.44121s
Wed, 25 Dec 2024 15:09:47 recommender.py[line:254] INFO Training: Epoch= 26 [recall@10=0.1561 ndcg@10=0.0796 train_loss=5.4333]
Wed, 25 Dec 2024 15:09:47 recommender.py[line:519] INFO Train time: 1.54291s. Valid time: 1.58073s
Wed, 25 Dec 2024 15:09:49 recommender.py[line:254] INFO Training: Epoch= 27 [recall@10=0.1720 ndcg@10=0.0823 train_loss=5.4226]
Wed, 25 Dec 2024 15:09:49 recommender.py[line:519] INFO Train time: 1.46639s. Valid time: 1.50087s
Wed, 25 Dec 2024 15:09:51 recommender.py[line:254] INFO Training: Epoch= 28 [recall@10=0.1656 ndcg@10=0.0819 train_loss=5.4146]
Wed, 25 Dec 2024 15:09:51 recommender.py[line:519] INFO Train time: 1.59238s. Valid time: 1.63233s
Wed, 25 Dec 2024 15:09:52 recommender.py[line:254] INFO Training: Epoch= 29 [recall@10=0.1624 ndcg@10=0.0819 train_loss=5.3984]
Wed, 25 Dec 2024 15:09:52 recommender.py[line:519] INFO Train time: 1.51612s. Valid time: 1.56127s
Wed, 25 Dec 2024 15:09:54 recommender.py[line:254] INFO Training: Epoch= 30 [recall@10=0.1720 ndcg@10=0.0860 train_loss=5.3958]
Wed, 25 Dec 2024 15:09:54 recommender.py[line:519] INFO Train time: 1.41635s. Valid time: 1.45422s
Wed, 25 Dec 2024 15:09:55 recommender.py[line:254] INFO Training: Epoch= 31 [recall@10=0.1752 ndcg@10=0.0907 train_loss=5.3874]
Wed, 25 Dec 2024 15:09:55 recommender.py[line:519] INFO Train time: 1.53301s. Valid time: 1.57300s
Wed, 25 Dec 2024 15:09:57 recommender.py[line:254] INFO Training: Epoch= 32 [recall@10=0.1624 ndcg@10=0.0780 train_loss=5.3826]
Wed, 25 Dec 2024 15:09:57 recommender.py[line:519] INFO Train time: 1.46728s. Valid time: 1.49997s
Wed, 25 Dec 2024 15:09:58 recommender.py[line:254] INFO Training: Epoch= 33 [recall@10=0.1624 ndcg@10=0.0831 train_loss=5.3702]
Wed, 25 Dec 2024 15:09:58 recommender.py[line:519] INFO Train time: 1.45461s. Valid time: 1.49138s
Wed, 25 Dec 2024 15:10:00 recommender.py[line:254] INFO Training: Epoch= 34 [recall@10=0.1656 ndcg@10=0.0851 train_loss=5.3645]
Wed, 25 Dec 2024 15:10:00 recommender.py[line:519] INFO Train time: 1.51514s. Valid time: 1.56604s
Wed, 25 Dec 2024 15:10:01 recommender.py[line:254] INFO Training: Epoch= 35 [recall@10=0.1752 ndcg@10=0.0858 train_loss=5.3539]
Wed, 25 Dec 2024 15:10:01 recommender.py[line:519] INFO Train time: 1.46649s. Valid time: 1.50146s
Wed, 25 Dec 2024 15:10:03 recommender.py[line:254] INFO Training: Epoch= 36 [recall@10=0.1815 ndcg@10=0.0851 train_loss=5.3489]
Wed, 25 Dec 2024 15:10:03 recommender.py[line:519] INFO Train time: 1.59864s. Valid time: 1.64033s
Wed, 25 Dec 2024 15:10:05 recommender.py[line:254] INFO Training: Epoch= 37 [recall@10=0.1656 ndcg@10=0.0867 train_loss=5.3413]
Wed, 25 Dec 2024 15:10:05 recommender.py[line:519] INFO Train time: 1.70399s. Valid time: 1.74248s
Wed, 25 Dec 2024 15:10:06 recommender.py[line:254] INFO Training: Epoch= 38 [recall@10=0.1752 ndcg@10=0.0841 train_loss=5.3328]
Wed, 25 Dec 2024 15:10:06 recommender.py[line:519] INFO Train time: 1.47337s. Valid time: 1.50947s
Wed, 25 Dec 2024 15:10:08 recommender.py[line:254] INFO Training: Epoch= 39 [recall@10=0.1752 ndcg@10=0.0840 train_loss=5.3293]
Wed, 25 Dec 2024 15:10:08 recommender.py[line:519] INFO Train time: 1.49654s. Valid time: 1.52999s
Wed, 25 Dec 2024 15:10:09 recommender.py[line:254] INFO Training: Epoch= 40 [recall@10=0.1720 ndcg@10=0.0888 train_loss=5.3259]
Wed, 25 Dec 2024 15:10:09 recommender.py[line:519] INFO Train time: 1.39912s. Valid time: 1.44078s
Wed, 25 Dec 2024 15:10:11 recommender.py[line:254] INFO Training: Epoch= 41 [recall@10=0.1656 ndcg@10=0.0819 train_loss=5.3168]
Wed, 25 Dec 2024 15:10:11 recommender.py[line:519] INFO Train time: 1.44433s. Valid time: 1.48733s
Wed, 25 Dec 2024 15:10:12 recommender.py[line:254] INFO Training: Epoch= 42 [recall@10=0.1783 ndcg@10=0.0886 train_loss=5.3130]
Wed, 25 Dec 2024 15:10:12 recommender.py[line:519] INFO Train time: 1.47932s. Valid time: 1.51736s
Wed, 25 Dec 2024 15:10:12 recommender.py[line:559] INFO Early stopped. recall@10 didn't improve for 20 epochs.
Wed, 25 Dec 2024 15:10:12 recommender.py[line:562] INFO The best score of recall@10 is 0.1815 at 22
Wed, 25 Dec 2024 15:10:12 recommender.py[line:730] INFO Best model checkpoiny saved in ./metadata/model_checkpoint/shadow_model/ml-100k/BERT4Rec/split/train/member_model_15.
Wed, 25 Dec 2024 15:10:12 shadow.py[line:57] INFO Shadow model recommendation performance:
Wed, 25 Dec 2024 15:10:12 recommender.py[line:196] INFO Testing:  [recall@10=0.1720 precision@10=0.0172 map@10=0.0684 ndcg@10=0.0922 mrr@10=0.0684 hit@10=0.1720]
Wed, 25 Dec 2024 15:10:12 recommender.py[line:128] INFO save_dir:/data1/home/zhihao/code/RecAudit/open-source/RecAudit/RecStudio-main
Wed, 25 Dec 2024 15:10:12 recommender.py[line:131] INFO BERT4Rec(
  (loss_fn): SoftmaxLoss()
  (score_func): InnerProductScorer()
  (item_encoder): Embedding(1154, 64, padding_idx=0)
  (query_encoder): BERT4RecQueryEncoder(
    (item_encoder): Embedding(1154, 64, padding_idx=0)
    (position_emb): Embedding(20, 64)
    (transformer_layer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
      )
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (training_pooling_layer): SeqPoolingLayer(pooling_type=mask, keepdim=False)
    (eval_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
  )
)
Wed, 25 Dec 2024 15:10:14 recommender.py[line:254] INFO Training: Epoch=  0 [recall@10=0.0381 ndcg@10=0.0237 train_loss=6.8023]
Wed, 25 Dec 2024 15:10:14 recommender.py[line:519] INFO Train time: 1.39525s. Valid time: 1.43698s
Wed, 25 Dec 2024 15:10:14 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0381
Wed, 25 Dec 2024 15:10:15 recommender.py[line:254] INFO Training: Epoch=  1 [recall@10=0.0889 ndcg@10=0.0424 train_loss=6.5475]
Wed, 25 Dec 2024 15:10:15 recommender.py[line:519] INFO Train time: 1.38143s. Valid time: 1.41505s
Wed, 25 Dec 2024 15:10:15 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0889
Wed, 25 Dec 2024 15:10:16 recommender.py[line:254] INFO Training: Epoch=  2 [recall@10=0.1429 ndcg@10=0.0726 train_loss=6.2287]
Wed, 25 Dec 2024 15:10:16 recommender.py[line:519] INFO Train time: 1.29693s. Valid time: 1.33039s
Wed, 25 Dec 2024 15:10:16 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1429
Wed, 25 Dec 2024 15:10:18 recommender.py[line:254] INFO Training: Epoch=  3 [recall@10=0.1429 ndcg@10=0.0798 train_loss=6.0022]
Wed, 25 Dec 2024 15:10:18 recommender.py[line:519] INFO Train time: 1.40186s. Valid time: 1.43992s
Wed, 25 Dec 2024 15:10:19 recommender.py[line:254] INFO Training: Epoch=  4 [recall@10=0.1365 ndcg@10=0.0734 train_loss=5.8705]
Wed, 25 Dec 2024 15:10:19 recommender.py[line:519] INFO Train time: 1.32175s. Valid time: 1.35976s
Wed, 25 Dec 2024 15:10:21 recommender.py[line:254] INFO Training: Epoch=  5 [recall@10=0.1429 ndcg@10=0.0693 train_loss=5.7977]
Wed, 25 Dec 2024 15:10:21 recommender.py[line:519] INFO Train time: 1.39301s. Valid time: 1.43409s
Wed, 25 Dec 2024 15:10:22 recommender.py[line:254] INFO Training: Epoch=  6 [recall@10=0.1397 ndcg@10=0.0740 train_loss=5.7393]
Wed, 25 Dec 2024 15:10:22 recommender.py[line:519] INFO Train time: 1.37839s. Valid time: 1.41696s
Wed, 25 Dec 2024 15:10:24 recommender.py[line:254] INFO Training: Epoch=  7 [recall@10=0.1492 ndcg@10=0.0800 train_loss=5.6924]
Wed, 25 Dec 2024 15:10:24 recommender.py[line:519] INFO Train time: 1.37539s. Valid time: 1.42095s
Wed, 25 Dec 2024 15:10:24 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1492
Wed, 25 Dec 2024 15:10:25 recommender.py[line:254] INFO Training: Epoch=  8 [recall@10=0.1714 ndcg@10=0.0837 train_loss=5.6581]
Wed, 25 Dec 2024 15:10:25 recommender.py[line:519] INFO Train time: 1.37345s. Valid time: 1.40877s
Wed, 25 Dec 2024 15:10:25 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1714
Wed, 25 Dec 2024 15:10:26 recommender.py[line:254] INFO Training: Epoch=  9 [recall@10=0.1778 ndcg@10=0.0864 train_loss=5.6265]
Wed, 25 Dec 2024 15:10:26 recommender.py[line:519] INFO Train time: 1.31893s. Valid time: 1.35340s
Wed, 25 Dec 2024 15:10:26 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1778
Wed, 25 Dec 2024 15:10:28 recommender.py[line:254] INFO Training: Epoch= 10 [recall@10=0.1714 ndcg@10=0.0936 train_loss=5.6014]
Wed, 25 Dec 2024 15:10:28 recommender.py[line:519] INFO Train time: 1.33740s. Valid time: 1.37607s
Wed, 25 Dec 2024 15:10:29 recommender.py[line:254] INFO Training: Epoch= 11 [recall@10=0.1746 ndcg@10=0.0954 train_loss=5.5800]
Wed, 25 Dec 2024 15:10:29 recommender.py[line:519] INFO Train time: 1.34335s. Valid time: 1.37367s
Wed, 25 Dec 2024 15:10:30 recommender.py[line:254] INFO Training: Epoch= 12 [recall@10=0.1968 ndcg@10=0.0991 train_loss=5.5540]
Wed, 25 Dec 2024 15:10:30 recommender.py[line:519] INFO Train time: 1.40985s. Valid time: 1.44220s
Wed, 25 Dec 2024 15:10:30 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1968
Wed, 25 Dec 2024 15:10:32 recommender.py[line:254] INFO Training: Epoch= 13 [recall@10=0.1746 ndcg@10=0.0907 train_loss=5.5317]
Wed, 25 Dec 2024 15:10:32 recommender.py[line:519] INFO Train time: 1.36815s. Valid time: 1.41187s
Wed, 25 Dec 2024 15:10:33 recommender.py[line:254] INFO Training: Epoch= 14 [recall@10=0.1905 ndcg@10=0.0966 train_loss=5.5250]
Wed, 25 Dec 2024 15:10:33 recommender.py[line:519] INFO Train time: 1.41946s. Valid time: 1.46056s
Wed, 25 Dec 2024 15:10:35 recommender.py[line:254] INFO Training: Epoch= 15 [recall@10=0.1810 ndcg@10=0.0920 train_loss=5.4860]
Wed, 25 Dec 2024 15:10:35 recommender.py[line:519] INFO Train time: 1.43175s. Valid time: 1.47069s
Wed, 25 Dec 2024 15:10:36 recommender.py[line:254] INFO Training: Epoch= 16 [recall@10=0.1651 ndcg@10=0.0868 train_loss=5.4733]
Wed, 25 Dec 2024 15:10:36 recommender.py[line:519] INFO Train time: 1.36114s. Valid time: 1.40639s
Wed, 25 Dec 2024 15:10:38 recommender.py[line:254] INFO Training: Epoch= 17 [recall@10=0.1841 ndcg@10=0.0901 train_loss=5.4595]
Wed, 25 Dec 2024 15:10:38 recommender.py[line:519] INFO Train time: 1.39580s. Valid time: 1.43303s
Wed, 25 Dec 2024 15:10:39 recommender.py[line:254] INFO Training: Epoch= 18 [recall@10=0.1746 ndcg@10=0.0954 train_loss=5.4494]
Wed, 25 Dec 2024 15:10:39 recommender.py[line:519] INFO Train time: 1.37446s. Valid time: 1.42254s
Wed, 25 Dec 2024 15:10:41 recommender.py[line:254] INFO Training: Epoch= 19 [recall@10=0.1778 ndcg@10=0.0946 train_loss=5.4323]
Wed, 25 Dec 2024 15:10:41 recommender.py[line:519] INFO Train time: 1.46153s. Valid time: 1.49408s
Wed, 25 Dec 2024 15:10:42 recommender.py[line:254] INFO Training: Epoch= 20 [recall@10=0.1651 ndcg@10=0.0875 train_loss=5.4194]
Wed, 25 Dec 2024 15:10:42 recommender.py[line:519] INFO Train time: 1.40623s. Valid time: 1.44105s
Wed, 25 Dec 2024 15:10:44 recommender.py[line:254] INFO Training: Epoch= 21 [recall@10=0.1905 ndcg@10=0.0946 train_loss=5.4066]
Wed, 25 Dec 2024 15:10:44 recommender.py[line:519] INFO Train time: 1.43912s. Valid time: 1.47223s
Wed, 25 Dec 2024 15:10:45 recommender.py[line:254] INFO Training: Epoch= 22 [recall@10=0.1937 ndcg@10=0.1048 train_loss=5.3972]
Wed, 25 Dec 2024 15:10:45 recommender.py[line:519] INFO Train time: 1.42009s. Valid time: 1.45610s
Wed, 25 Dec 2024 15:10:46 recommender.py[line:254] INFO Training: Epoch= 23 [recall@10=0.1841 ndcg@10=0.0910 train_loss=5.3810]
Wed, 25 Dec 2024 15:10:46 recommender.py[line:519] INFO Train time: 1.39483s. Valid time: 1.43598s
Wed, 25 Dec 2024 15:10:48 recommender.py[line:254] INFO Training: Epoch= 24 [recall@10=0.1810 ndcg@10=0.0961 train_loss=5.3662]
Wed, 25 Dec 2024 15:10:48 recommender.py[line:519] INFO Train time: 1.45432s. Valid time: 1.49829s
Wed, 25 Dec 2024 15:10:49 recommender.py[line:254] INFO Training: Epoch= 25 [recall@10=0.1746 ndcg@10=0.0957 train_loss=5.3697]
Wed, 25 Dec 2024 15:10:49 recommender.py[line:519] INFO Train time: 1.35743s. Valid time: 1.39390s
Wed, 25 Dec 2024 15:10:51 recommender.py[line:254] INFO Training: Epoch= 26 [recall@10=0.1778 ndcg@10=0.0997 train_loss=5.3505]
Wed, 25 Dec 2024 15:10:51 recommender.py[line:519] INFO Train time: 1.43767s. Valid time: 1.47944s
Wed, 25 Dec 2024 15:10:52 recommender.py[line:254] INFO Training: Epoch= 27 [recall@10=0.1714 ndcg@10=0.0902 train_loss=5.3388]
Wed, 25 Dec 2024 15:10:52 recommender.py[line:519] INFO Train time: 1.49369s. Valid time: 1.52775s
Wed, 25 Dec 2024 15:10:54 recommender.py[line:254] INFO Training: Epoch= 28 [recall@10=0.1746 ndcg@10=0.0967 train_loss=5.3288]
Wed, 25 Dec 2024 15:10:54 recommender.py[line:519] INFO Train time: 1.67588s. Valid time: 1.71761s
Wed, 25 Dec 2024 15:10:55 recommender.py[line:254] INFO Training: Epoch= 29 [recall@10=0.1746 ndcg@10=0.0941 train_loss=5.3199]
Wed, 25 Dec 2024 15:10:55 recommender.py[line:519] INFO Train time: 1.38326s. Valid time: 1.42230s
Wed, 25 Dec 2024 15:10:57 recommender.py[line:254] INFO Training: Epoch= 30 [recall@10=0.1746 ndcg@10=0.0959 train_loss=5.3094]
Wed, 25 Dec 2024 15:10:57 recommender.py[line:519] INFO Train time: 1.42520s. Valid time: 1.46166s
Wed, 25 Dec 2024 15:10:59 recommender.py[line:254] INFO Training: Epoch= 31 [recall@10=0.1714 ndcg@10=0.0941 train_loss=5.3050]
Wed, 25 Dec 2024 15:10:59 recommender.py[line:519] INFO Train time: 1.56813s. Valid time: 1.60798s
Wed, 25 Dec 2024 15:11:00 recommender.py[line:254] INFO Training: Epoch= 32 [recall@10=0.1778 ndcg@10=0.1031 train_loss=5.2971]
Wed, 25 Dec 2024 15:11:00 recommender.py[line:519] INFO Train time: 1.37113s. Valid time: 1.40793s
Wed, 25 Dec 2024 15:11:00 recommender.py[line:559] INFO Early stopped. recall@10 didn't improve for 20 epochs.
Wed, 25 Dec 2024 15:11:00 recommender.py[line:562] INFO The best score of recall@10 is 0.1968 at 12
Wed, 25 Dec 2024 15:11:00 recommender.py[line:730] INFO Best model checkpoiny saved in ./metadata/model_checkpoint/shadow_model/ml-100k/BERT4Rec/split/train/nonmember_model_15.
Wed, 25 Dec 2024 15:11:00 shadow.py[line:57] INFO Shadow model recommendation performance:
Wed, 25 Dec 2024 15:11:00 recommender.py[line:196] INFO Testing:  [recall@10=0.1365 precision@10=0.0137 map@10=0.0557 ndcg@10=0.0745 mrr@10=0.0557 hit@10=0.1365]
Wed, 25 Dec 2024 15:11:07 shadow.py[line:292] INFO End of the code.
