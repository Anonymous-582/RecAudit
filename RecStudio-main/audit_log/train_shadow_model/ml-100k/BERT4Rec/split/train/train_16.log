Wed, 25 Dec 2024 15:09:00 shadow.py[line:150] INFO {'dataset': 'ml-100k', 'model': 'BERT4Rec', 'split_seed': 16, 'gpu': 4, 'split_cf': 'split', 'train_cf': 'train'}
Wed, 25 Dec 2024 15:09:00 utils.py[line:224] INFO dataset is read from ../datasets/ml-100k.
Wed, 25 Dec 2024 15:09:01 utils.py[line:38] INFO 
Dataset Info: 

==================================================
item information: 
field     item_id   
type      token     
##        1153      
==================================================
user information: 
field     user_id   
type      token     
##        944       
==================================================
interaction information: 
field     user_id   item_id   rating    timestamp 
type      token     token     float     float     
##        944       1153      -         -         
==================================================
Sparsity: 0.909832
==================================================
Wed, 25 Dec 2024 15:09:02 utils.py[line:297] INFO Global seed set to 2019
Wed, 25 Dec 2024 15:09:02 utils.py[line:62] INFO 
Model Config: 

accelerator=gpu
activation=gelu
ann=None
batch_size=1024
cutoff=10
dataset_neg_count=None
dataset_sampler=None
dropout=0.2
early_stop_mode=max
early_stop_patience=20
embed_dim=64
epochs=100
eval_batch_size=128
excluding_hist=False
gpu=[4]
head_num=2
hidden_size=128
item_bias=False
layer_norm_eps=1e-12
layer_num=2
learner=adam
learning_rate=0.001
mask_ratio=0.2
negative_count=1
num_workers=0
pooling_type=mask
save_path=./saved/
scheduler=None
seed=2019
split_ratio=2
steal=False
test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
test_repetitive=True
topk=100
train_repetitive=True
val_metrics=['recall', 'ndcg']
weight_decay=1e-05
Wed, 25 Dec 2024 15:09:02 utils.py[line:297] INFO Global seed set to 2019
Wed, 25 Dec 2024 15:09:02 utils.py[line:62] INFO 
Model Config: 

accelerator=gpu
activation=gelu
ann=None
batch_size=1024
cutoff=10
dataset_neg_count=None
dataset_sampler=None
dropout=0.2
early_stop_mode=max
early_stop_patience=20
embed_dim=64
epochs=100
eval_batch_size=128
excluding_hist=False
gpu=[4]
head_num=2
hidden_size=128
item_bias=False
layer_norm_eps=1e-12
layer_num=2
learner=adam
learning_rate=0.001
mask_ratio=0.2
negative_count=1
num_workers=0
pooling_type=mask
save_path=./saved/
scheduler=None
seed=2019
split_ratio=2
steal=False
test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
test_repetitive=True
topk=100
train_repetitive=True
val_metrics=['recall', 'ndcg']
weight_decay=1e-05
Wed, 25 Dec 2024 15:09:02 recommender.py[line:128] INFO save_dir:/data1/home/zhihao/code/RecAudit/open-source/RecAudit/RecStudio-main
Wed, 25 Dec 2024 15:09:02 recommender.py[line:131] INFO BERT4Rec(
  (loss_fn): SoftmaxLoss()
  (score_func): InnerProductScorer()
  (item_encoder): Embedding(1154, 64, padding_idx=0)
  (query_encoder): BERT4RecQueryEncoder(
    (item_encoder): Embedding(1154, 64, padding_idx=0)
    (position_emb): Embedding(20, 64)
    (transformer_layer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
      )
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (training_pooling_layer): SeqPoolingLayer(pooling_type=mask, keepdim=False)
    (eval_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
  )
)
Wed, 25 Dec 2024 15:09:09 recommender.py[line:254] INFO Training: Epoch=  0 [recall@10=0.0414 ndcg@10=0.0214 train_loss=6.8018]
Wed, 25 Dec 2024 15:09:09 recommender.py[line:519] INFO Train time: 1.95500s. Valid time: 1.99467s
Wed, 25 Dec 2024 15:09:09 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0414
Wed, 25 Dec 2024 15:09:10 recommender.py[line:254] INFO Training: Epoch=  1 [recall@10=0.0510 ndcg@10=0.0284 train_loss=6.5883]
Wed, 25 Dec 2024 15:09:10 recommender.py[line:519] INFO Train time: 1.50915s. Valid time: 1.54679s
Wed, 25 Dec 2024 15:09:10 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0510
Wed, 25 Dec 2024 15:09:12 recommender.py[line:254] INFO Training: Epoch=  2 [recall@10=0.1465 ndcg@10=0.0762 train_loss=6.2869]
Wed, 25 Dec 2024 15:09:12 recommender.py[line:519] INFO Train time: 1.76385s. Valid time: 1.80499s
Wed, 25 Dec 2024 15:09:12 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1465
Wed, 25 Dec 2024 15:09:14 recommender.py[line:254] INFO Training: Epoch=  3 [recall@10=0.1306 ndcg@10=0.0661 train_loss=6.0039]
Wed, 25 Dec 2024 15:09:14 recommender.py[line:519] INFO Train time: 1.47051s. Valid time: 1.49575s
Wed, 25 Dec 2024 15:09:15 recommender.py[line:254] INFO Training: Epoch=  4 [recall@10=0.1433 ndcg@10=0.0740 train_loss=5.8863]
Wed, 25 Dec 2024 15:09:15 recommender.py[line:519] INFO Train time: 1.51243s. Valid time: 1.54330s
Wed, 25 Dec 2024 15:09:17 recommender.py[line:254] INFO Training: Epoch=  5 [recall@10=0.1401 ndcg@10=0.0696 train_loss=5.8126]
Wed, 25 Dec 2024 15:09:17 recommender.py[line:519] INFO Train time: 1.46332s. Valid time: 1.50023s
Wed, 25 Dec 2024 15:09:18 recommender.py[line:254] INFO Training: Epoch=  6 [recall@10=0.1146 ndcg@10=0.0568 train_loss=5.7582]
Wed, 25 Dec 2024 15:09:18 recommender.py[line:519] INFO Train time: 1.45225s. Valid time: 1.48775s
Wed, 25 Dec 2024 15:09:20 recommender.py[line:254] INFO Training: Epoch=  7 [recall@10=0.1433 ndcg@10=0.0680 train_loss=5.7083]
Wed, 25 Dec 2024 15:09:20 recommender.py[line:519] INFO Train time: 1.47558s. Valid time: 1.50698s
Wed, 25 Dec 2024 15:09:21 recommender.py[line:254] INFO Training: Epoch=  8 [recall@10=0.1465 ndcg@10=0.0708 train_loss=5.6809]
Wed, 25 Dec 2024 15:09:21 recommender.py[line:519] INFO Train time: 1.45556s. Valid time: 1.49096s
Wed, 25 Dec 2024 15:09:23 recommender.py[line:254] INFO Training: Epoch=  9 [recall@10=0.1561 ndcg@10=0.0772 train_loss=5.6414]
Wed, 25 Dec 2024 15:09:23 recommender.py[line:519] INFO Train time: 1.54979s. Valid time: 1.57976s
Wed, 25 Dec 2024 15:09:23 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1561
Wed, 25 Dec 2024 15:09:24 recommender.py[line:254] INFO Training: Epoch= 10 [recall@10=0.1465 ndcg@10=0.0721 train_loss=5.6285]
Wed, 25 Dec 2024 15:09:24 recommender.py[line:519] INFO Train time: 1.40421s. Valid time: 1.44205s
Wed, 25 Dec 2024 15:09:26 recommender.py[line:254] INFO Training: Epoch= 11 [recall@10=0.1401 ndcg@10=0.0720 train_loss=5.6079]
Wed, 25 Dec 2024 15:09:26 recommender.py[line:519] INFO Train time: 1.49137s. Valid time: 1.53113s
Wed, 25 Dec 2024 15:09:27 recommender.py[line:254] INFO Training: Epoch= 12 [recall@10=0.1529 ndcg@10=0.0778 train_loss=5.5842]
Wed, 25 Dec 2024 15:09:27 recommender.py[line:519] INFO Train time: 1.54176s. Valid time: 1.57954s
Wed, 25 Dec 2024 15:09:29 recommender.py[line:254] INFO Training: Epoch= 13 [recall@10=0.1561 ndcg@10=0.0796 train_loss=5.5635]
Wed, 25 Dec 2024 15:09:29 recommender.py[line:519] INFO Train time: 1.47412s. Valid time: 1.51208s
Wed, 25 Dec 2024 15:09:30 recommender.py[line:254] INFO Training: Epoch= 14 [recall@10=0.1592 ndcg@10=0.0759 train_loss=5.5534]
Wed, 25 Dec 2024 15:09:30 recommender.py[line:519] INFO Train time: 1.51777s. Valid time: 1.55228s
Wed, 25 Dec 2024 15:09:30 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1592
Wed, 25 Dec 2024 15:09:32 recommender.py[line:254] INFO Training: Epoch= 15 [recall@10=0.1624 ndcg@10=0.0740 train_loss=5.5398]
Wed, 25 Dec 2024 15:09:32 recommender.py[line:519] INFO Train time: 1.50528s. Valid time: 1.54859s
Wed, 25 Dec 2024 15:09:32 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1624
Wed, 25 Dec 2024 15:09:33 recommender.py[line:254] INFO Training: Epoch= 16 [recall@10=0.1720 ndcg@10=0.0836 train_loss=5.5274]
Wed, 25 Dec 2024 15:09:33 recommender.py[line:519] INFO Train time: 1.46823s. Valid time: 1.51108s
Wed, 25 Dec 2024 15:09:33 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1720
Wed, 25 Dec 2024 15:09:35 recommender.py[line:254] INFO Training: Epoch= 17 [recall@10=0.1561 ndcg@10=0.0819 train_loss=5.5116]
Wed, 25 Dec 2024 15:09:35 recommender.py[line:519] INFO Train time: 1.52677s. Valid time: 1.55697s
Wed, 25 Dec 2024 15:09:36 recommender.py[line:254] INFO Training: Epoch= 18 [recall@10=0.1497 ndcg@10=0.0715 train_loss=5.4970]
Wed, 25 Dec 2024 15:09:36 recommender.py[line:519] INFO Train time: 1.39821s. Valid time: 1.43247s
Wed, 25 Dec 2024 15:09:38 recommender.py[line:254] INFO Training: Epoch= 19 [recall@10=0.1561 ndcg@10=0.0778 train_loss=5.4940]
Wed, 25 Dec 2024 15:09:38 recommender.py[line:519] INFO Train time: 1.85725s. Valid time: 1.89690s
Wed, 25 Dec 2024 15:09:40 recommender.py[line:254] INFO Training: Epoch= 20 [recall@10=0.1783 ndcg@10=0.0874 train_loss=5.4787]
Wed, 25 Dec 2024 15:09:40 recommender.py[line:519] INFO Train time: 1.52209s. Valid time: 1.54482s
Wed, 25 Dec 2024 15:09:40 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1783
Wed, 25 Dec 2024 15:09:41 recommender.py[line:254] INFO Training: Epoch= 21 [recall@10=0.1720 ndcg@10=0.0876 train_loss=5.4633]
Wed, 25 Dec 2024 15:09:41 recommender.py[line:519] INFO Train time: 1.43053s. Valid time: 1.46901s
Wed, 25 Dec 2024 15:09:43 recommender.py[line:254] INFO Training: Epoch= 22 [recall@10=0.1783 ndcg@10=0.0986 train_loss=5.4526]
Wed, 25 Dec 2024 15:09:43 recommender.py[line:519] INFO Train time: 1.52221s. Valid time: 1.55847s
Wed, 25 Dec 2024 15:09:44 recommender.py[line:254] INFO Training: Epoch= 23 [recall@10=0.1815 ndcg@10=0.0950 train_loss=5.4509]
Wed, 25 Dec 2024 15:09:44 recommender.py[line:519] INFO Train time: 1.45778s. Valid time: 1.48727s
Wed, 25 Dec 2024 15:09:44 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1815
Wed, 25 Dec 2024 15:09:46 recommender.py[line:254] INFO Training: Epoch= 24 [recall@10=0.1656 ndcg@10=0.0882 train_loss=5.4352]
Wed, 25 Dec 2024 15:09:46 recommender.py[line:519] INFO Train time: 1.49450s. Valid time: 1.52078s
Wed, 25 Dec 2024 15:09:47 recommender.py[line:254] INFO Training: Epoch= 25 [recall@10=0.1656 ndcg@10=0.0912 train_loss=5.4184]
Wed, 25 Dec 2024 15:09:47 recommender.py[line:519] INFO Train time: 1.55533s. Valid time: 1.58565s
Wed, 25 Dec 2024 15:09:49 recommender.py[line:254] INFO Training: Epoch= 26 [recall@10=0.1688 ndcg@10=0.0925 train_loss=5.4062]
Wed, 25 Dec 2024 15:09:49 recommender.py[line:519] INFO Train time: 1.41681s. Valid time: 1.45830s
Wed, 25 Dec 2024 15:09:50 recommender.py[line:254] INFO Training: Epoch= 27 [recall@10=0.1720 ndcg@10=0.0933 train_loss=5.3966]
Wed, 25 Dec 2024 15:09:50 recommender.py[line:519] INFO Train time: 1.50150s. Valid time: 1.53049s
Wed, 25 Dec 2024 15:09:52 recommender.py[line:254] INFO Training: Epoch= 28 [recall@10=0.1720 ndcg@10=0.0912 train_loss=5.3896]
Wed, 25 Dec 2024 15:09:52 recommender.py[line:519] INFO Train time: 1.55826s. Valid time: 1.59814s
Wed, 25 Dec 2024 15:09:54 recommender.py[line:254] INFO Training: Epoch= 29 [recall@10=0.1783 ndcg@10=0.0964 train_loss=5.3731]
Wed, 25 Dec 2024 15:09:54 recommender.py[line:519] INFO Train time: 1.51188s. Valid time: 1.54501s
Wed, 25 Dec 2024 15:09:55 recommender.py[line:254] INFO Training: Epoch= 30 [recall@10=0.1720 ndcg@10=0.0859 train_loss=5.3676]
Wed, 25 Dec 2024 15:09:55 recommender.py[line:519] INFO Train time: 1.54449s. Valid time: 1.57296s
Wed, 25 Dec 2024 15:09:57 recommender.py[line:254] INFO Training: Epoch= 31 [recall@10=0.1720 ndcg@10=0.0871 train_loss=5.3619]
Wed, 25 Dec 2024 15:09:57 recommender.py[line:519] INFO Train time: 1.43510s. Valid time: 1.48034s
Wed, 25 Dec 2024 15:09:58 recommender.py[line:254] INFO Training: Epoch= 32 [recall@10=0.1656 ndcg@10=0.0887 train_loss=5.3492]
Wed, 25 Dec 2024 15:09:58 recommender.py[line:519] INFO Train time: 1.51568s. Valid time: 1.54617s
Wed, 25 Dec 2024 15:10:00 recommender.py[line:254] INFO Training: Epoch= 33 [recall@10=0.1529 ndcg@10=0.0788 train_loss=5.3488]
Wed, 25 Dec 2024 15:10:00 recommender.py[line:519] INFO Train time: 1.52654s. Valid time: 1.55865s
Wed, 25 Dec 2024 15:10:01 recommender.py[line:254] INFO Training: Epoch= 34 [recall@10=0.1688 ndcg@10=0.0965 train_loss=5.3382]
Wed, 25 Dec 2024 15:10:01 recommender.py[line:519] INFO Train time: 1.41536s. Valid time: 1.44867s
Wed, 25 Dec 2024 15:10:03 recommender.py[line:254] INFO Training: Epoch= 35 [recall@10=0.1656 ndcg@10=0.0877 train_loss=5.3271]
Wed, 25 Dec 2024 15:10:03 recommender.py[line:519] INFO Train time: 1.65323s. Valid time: 1.68005s
Wed, 25 Dec 2024 15:10:04 recommender.py[line:254] INFO Training: Epoch= 36 [recall@10=0.1847 ndcg@10=0.0947 train_loss=5.3275]
Wed, 25 Dec 2024 15:10:04 recommender.py[line:519] INFO Train time: 1.45200s. Valid time: 1.48392s
Wed, 25 Dec 2024 15:10:04 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1847
Wed, 25 Dec 2024 15:10:06 recommender.py[line:254] INFO Training: Epoch= 37 [recall@10=0.1561 ndcg@10=0.0875 train_loss=5.3194]
Wed, 25 Dec 2024 15:10:06 recommender.py[line:519] INFO Train time: 1.54773s. Valid time: 1.58801s
Wed, 25 Dec 2024 15:10:08 recommender.py[line:254] INFO Training: Epoch= 38 [recall@10=0.1561 ndcg@10=0.0852 train_loss=5.3122]
Wed, 25 Dec 2024 15:10:08 recommender.py[line:519] INFO Train time: 1.75777s. Valid time: 1.80107s
Wed, 25 Dec 2024 15:10:09 recommender.py[line:254] INFO Training: Epoch= 39 [recall@10=0.1783 ndcg@10=0.0899 train_loss=5.2989]
Wed, 25 Dec 2024 15:10:09 recommender.py[line:519] INFO Train time: 1.54308s. Valid time: 1.58828s
Wed, 25 Dec 2024 15:10:11 recommender.py[line:254] INFO Training: Epoch= 40 [recall@10=0.1688 ndcg@10=0.0896 train_loss=5.2910]
Wed, 25 Dec 2024 15:10:11 recommender.py[line:519] INFO Train time: 1.62635s. Valid time: 1.66838s
Wed, 25 Dec 2024 15:10:13 recommender.py[line:254] INFO Training: Epoch= 41 [recall@10=0.1720 ndcg@10=0.0897 train_loss=5.2908]
Wed, 25 Dec 2024 15:10:13 recommender.py[line:519] INFO Train time: 1.50811s. Valid time: 1.54876s
Wed, 25 Dec 2024 15:10:14 recommender.py[line:254] INFO Training: Epoch= 42 [recall@10=0.1497 ndcg@10=0.0883 train_loss=5.2859]
Wed, 25 Dec 2024 15:10:14 recommender.py[line:519] INFO Train time: 1.50118s. Valid time: 1.52998s
Wed, 25 Dec 2024 15:10:16 recommender.py[line:254] INFO Training: Epoch= 43 [recall@10=0.1592 ndcg@10=0.0934 train_loss=5.2746]
Wed, 25 Dec 2024 15:10:16 recommender.py[line:519] INFO Train time: 1.45689s. Valid time: 1.49835s
Wed, 25 Dec 2024 15:10:17 recommender.py[line:254] INFO Training: Epoch= 44 [recall@10=0.1656 ndcg@10=0.0844 train_loss=5.2795]
Wed, 25 Dec 2024 15:10:17 recommender.py[line:519] INFO Train time: 1.36549s. Valid time: 1.40186s
Wed, 25 Dec 2024 15:10:19 recommender.py[line:254] INFO Training: Epoch= 45 [recall@10=0.1688 ndcg@10=0.0931 train_loss=5.2661]
Wed, 25 Dec 2024 15:10:19 recommender.py[line:519] INFO Train time: 1.47575s. Valid time: 1.51648s
Wed, 25 Dec 2024 15:10:20 recommender.py[line:254] INFO Training: Epoch= 46 [recall@10=0.1656 ndcg@10=0.0900 train_loss=5.2559]
Wed, 25 Dec 2024 15:10:20 recommender.py[line:519] INFO Train time: 1.45317s. Valid time: 1.49207s
Wed, 25 Dec 2024 15:10:22 recommender.py[line:254] INFO Training: Epoch= 47 [recall@10=0.1720 ndcg@10=0.0860 train_loss=5.2548]
Wed, 25 Dec 2024 15:10:22 recommender.py[line:519] INFO Train time: 1.45191s. Valid time: 1.48407s
Wed, 25 Dec 2024 15:10:23 recommender.py[line:254] INFO Training: Epoch= 48 [recall@10=0.1465 ndcg@10=0.0831 train_loss=5.2520]
Wed, 25 Dec 2024 15:10:23 recommender.py[line:519] INFO Train time: 1.50266s. Valid time: 1.54058s
Wed, 25 Dec 2024 15:10:25 recommender.py[line:254] INFO Training: Epoch= 49 [recall@10=0.1529 ndcg@10=0.0830 train_loss=5.2424]
Wed, 25 Dec 2024 15:10:25 recommender.py[line:519] INFO Train time: 1.44775s. Valid time: 1.48950s
Wed, 25 Dec 2024 15:10:26 recommender.py[line:254] INFO Training: Epoch= 50 [recall@10=0.1624 ndcg@10=0.0987 train_loss=5.2345]
Wed, 25 Dec 2024 15:10:26 recommender.py[line:519] INFO Train time: 1.44088s. Valid time: 1.47903s
Wed, 25 Dec 2024 15:10:28 recommender.py[line:254] INFO Training: Epoch= 51 [recall@10=0.1656 ndcg@10=0.0928 train_loss=5.2283]
Wed, 25 Dec 2024 15:10:28 recommender.py[line:519] INFO Train time: 1.46837s. Valid time: 1.51757s
Wed, 25 Dec 2024 15:10:29 recommender.py[line:254] INFO Training: Epoch= 52 [recall@10=0.1561 ndcg@10=0.0860 train_loss=5.2220]
Wed, 25 Dec 2024 15:10:29 recommender.py[line:519] INFO Train time: 1.46976s. Valid time: 1.50569s
Wed, 25 Dec 2024 15:10:31 recommender.py[line:254] INFO Training: Epoch= 53 [recall@10=0.1561 ndcg@10=0.0819 train_loss=5.2115]
Wed, 25 Dec 2024 15:10:31 recommender.py[line:519] INFO Train time: 1.49070s. Valid time: 1.52398s
Wed, 25 Dec 2024 15:10:32 recommender.py[line:254] INFO Training: Epoch= 54 [recall@10=0.1624 ndcg@10=0.0916 train_loss=5.2072]
Wed, 25 Dec 2024 15:10:32 recommender.py[line:519] INFO Train time: 1.47249s. Valid time: 1.50936s
Wed, 25 Dec 2024 15:10:34 recommender.py[line:254] INFO Training: Epoch= 55 [recall@10=0.1656 ndcg@10=0.0890 train_loss=5.2026]
Wed, 25 Dec 2024 15:10:34 recommender.py[line:519] INFO Train time: 1.42529s. Valid time: 1.46759s
Wed, 25 Dec 2024 15:10:35 recommender.py[line:254] INFO Training: Epoch= 56 [recall@10=0.1688 ndcg@10=0.0897 train_loss=5.1974]
Wed, 25 Dec 2024 15:10:35 recommender.py[line:519] INFO Train time: 1.46922s. Valid time: 1.50522s
Wed, 25 Dec 2024 15:10:35 recommender.py[line:559] INFO Early stopped. recall@10 didn't improve for 20 epochs.
Wed, 25 Dec 2024 15:10:35 recommender.py[line:562] INFO The best score of recall@10 is 0.1847 at 36
Wed, 25 Dec 2024 15:10:35 recommender.py[line:730] INFO Best model checkpoiny saved in ./metadata/model_checkpoint/shadow_model/ml-100k/BERT4Rec/split/train/member_model_16.
Wed, 25 Dec 2024 15:10:35 shadow.py[line:57] INFO Shadow model recommendation performance:
Wed, 25 Dec 2024 15:10:35 recommender.py[line:196] INFO Testing:  [recall@10=0.1752 precision@10=0.0175 map@10=0.0558 ndcg@10=0.0833 mrr@10=0.0558 hit@10=0.1752]
Wed, 25 Dec 2024 15:10:35 recommender.py[line:128] INFO save_dir:/data1/home/zhihao/code/RecAudit/open-source/RecAudit/RecStudio-main
Wed, 25 Dec 2024 15:10:35 recommender.py[line:131] INFO BERT4Rec(
  (loss_fn): SoftmaxLoss()
  (score_func): InnerProductScorer()
  (item_encoder): Embedding(1154, 64, padding_idx=0)
  (query_encoder): BERT4RecQueryEncoder(
    (item_encoder): Embedding(1154, 64, padding_idx=0)
    (position_emb): Embedding(20, 64)
    (transformer_layer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
      )
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (training_pooling_layer): SeqPoolingLayer(pooling_type=mask, keepdim=False)
    (eval_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
  )
)
Wed, 25 Dec 2024 15:10:37 recommender.py[line:254] INFO Training: Epoch=  0 [recall@10=0.0698 ndcg@10=0.0386 train_loss=6.8094]
Wed, 25 Dec 2024 15:10:37 recommender.py[line:519] INFO Train time: 1.28313s. Valid time: 1.31383s
Wed, 25 Dec 2024 15:10:37 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0698
Wed, 25 Dec 2024 15:10:38 recommender.py[line:254] INFO Training: Epoch=  1 [recall@10=0.0667 ndcg@10=0.0329 train_loss=6.5724]
Wed, 25 Dec 2024 15:10:38 recommender.py[line:519] INFO Train time: 1.33182s. Valid time: 1.36283s
Wed, 25 Dec 2024 15:10:39 recommender.py[line:254] INFO Training: Epoch=  2 [recall@10=0.1143 ndcg@10=0.0518 train_loss=6.3136]
Wed, 25 Dec 2024 15:10:39 recommender.py[line:519] INFO Train time: 1.33779s. Valid time: 1.37584s
Wed, 25 Dec 2024 15:10:39 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1143
Wed, 25 Dec 2024 15:10:41 recommender.py[line:254] INFO Training: Epoch=  3 [recall@10=0.0952 ndcg@10=0.0465 train_loss=6.0770]
Wed, 25 Dec 2024 15:10:41 recommender.py[line:519] INFO Train time: 1.26792s. Valid time: 1.31154s
Wed, 25 Dec 2024 15:10:42 recommender.py[line:254] INFO Training: Epoch=  4 [recall@10=0.1302 ndcg@10=0.0584 train_loss=5.9343]
Wed, 25 Dec 2024 15:10:42 recommender.py[line:519] INFO Train time: 1.35278s. Valid time: 1.37931s
Wed, 25 Dec 2024 15:10:42 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1302
Wed, 25 Dec 2024 15:10:43 recommender.py[line:254] INFO Training: Epoch=  5 [recall@10=0.1492 ndcg@10=0.0726 train_loss=5.8235]
Wed, 25 Dec 2024 15:10:43 recommender.py[line:519] INFO Train time: 1.26095s. Valid time: 1.30156s
Wed, 25 Dec 2024 15:10:43 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1492
Wed, 25 Dec 2024 15:10:45 recommender.py[line:254] INFO Training: Epoch=  6 [recall@10=0.1460 ndcg@10=0.0779 train_loss=5.7432]
Wed, 25 Dec 2024 15:10:45 recommender.py[line:519] INFO Train time: 1.35866s. Valid time: 1.39724s
Wed, 25 Dec 2024 15:10:46 recommender.py[line:254] INFO Training: Epoch=  7 [recall@10=0.1746 ndcg@10=0.0867 train_loss=5.6952]
Wed, 25 Dec 2024 15:10:46 recommender.py[line:519] INFO Train time: 1.31546s. Valid time: 1.35059s
Wed, 25 Dec 2024 15:10:46 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1746
Wed, 25 Dec 2024 15:10:47 recommender.py[line:254] INFO Training: Epoch=  8 [recall@10=0.1683 ndcg@10=0.0826 train_loss=5.6509]
Wed, 25 Dec 2024 15:10:47 recommender.py[line:519] INFO Train time: 1.40103s. Valid time: 1.42788s
Wed, 25 Dec 2024 15:10:49 recommender.py[line:254] INFO Training: Epoch=  9 [recall@10=0.1556 ndcg@10=0.0761 train_loss=5.6288]
Wed, 25 Dec 2024 15:10:49 recommender.py[line:519] INFO Train time: 1.34637s. Valid time: 1.38553s
Wed, 25 Dec 2024 15:10:50 recommender.py[line:254] INFO Training: Epoch= 10 [recall@10=0.1587 ndcg@10=0.0807 train_loss=5.5983]
Wed, 25 Dec 2024 15:10:50 recommender.py[line:519] INFO Train time: 1.34437s. Valid time: 1.37979s
Wed, 25 Dec 2024 15:10:52 recommender.py[line:254] INFO Training: Epoch= 11 [recall@10=0.1683 ndcg@10=0.0798 train_loss=5.5853]
Wed, 25 Dec 2024 15:10:52 recommender.py[line:519] INFO Train time: 1.32729s. Valid time: 1.37344s
Wed, 25 Dec 2024 15:10:53 recommender.py[line:254] INFO Training: Epoch= 12 [recall@10=0.1683 ndcg@10=0.0829 train_loss=5.5594]
Wed, 25 Dec 2024 15:10:53 recommender.py[line:519] INFO Train time: 1.40586s. Valid time: 1.43800s
Wed, 25 Dec 2024 15:10:54 recommender.py[line:254] INFO Training: Epoch= 13 [recall@10=0.1714 ndcg@10=0.0793 train_loss=5.5501]
Wed, 25 Dec 2024 15:10:54 recommender.py[line:519] INFO Train time: 1.37751s. Valid time: 1.41419s
Wed, 25 Dec 2024 15:10:56 recommender.py[line:254] INFO Training: Epoch= 14 [recall@10=0.1714 ndcg@10=0.0836 train_loss=5.5414]
Wed, 25 Dec 2024 15:10:56 recommender.py[line:519] INFO Train time: 1.31497s. Valid time: 1.36135s
Wed, 25 Dec 2024 15:10:57 recommender.py[line:254] INFO Training: Epoch= 15 [recall@10=0.1651 ndcg@10=0.0871 train_loss=5.5202]
Wed, 25 Dec 2024 15:10:57 recommender.py[line:519] INFO Train time: 1.37872s. Valid time: 1.42226s
Wed, 25 Dec 2024 15:10:59 recommender.py[line:254] INFO Training: Epoch= 16 [recall@10=0.1651 ndcg@10=0.0879 train_loss=5.5020]
Wed, 25 Dec 2024 15:10:59 recommender.py[line:519] INFO Train time: 1.42379s. Valid time: 1.46709s
Wed, 25 Dec 2024 15:11:00 recommender.py[line:254] INFO Training: Epoch= 17 [recall@10=0.1841 ndcg@10=0.0905 train_loss=5.4854]
Wed, 25 Dec 2024 15:11:00 recommender.py[line:519] INFO Train time: 1.34952s. Valid time: 1.38511s
Wed, 25 Dec 2024 15:11:00 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1841
Wed, 25 Dec 2024 15:11:01 recommender.py[line:254] INFO Training: Epoch= 18 [recall@10=0.1714 ndcg@10=0.0881 train_loss=5.4674]
Wed, 25 Dec 2024 15:11:01 recommender.py[line:519] INFO Train time: 1.26187s. Valid time: 1.29702s
Wed, 25 Dec 2024 15:11:03 recommender.py[line:254] INFO Training: Epoch= 19 [recall@10=0.1841 ndcg@10=0.0908 train_loss=5.4552]
Wed, 25 Dec 2024 15:11:03 recommender.py[line:519] INFO Train time: 1.30208s. Valid time: 1.34920s
Wed, 25 Dec 2024 15:11:04 recommender.py[line:254] INFO Training: Epoch= 20 [recall@10=0.1746 ndcg@10=0.0899 train_loss=5.4394]
Wed, 25 Dec 2024 15:11:04 recommender.py[line:519] INFO Train time: 1.23412s. Valid time: 1.27331s
Wed, 25 Dec 2024 15:11:05 recommender.py[line:254] INFO Training: Epoch= 21 [recall@10=0.1619 ndcg@10=0.0813 train_loss=5.4257]
Wed, 25 Dec 2024 15:11:05 recommender.py[line:519] INFO Train time: 1.33764s. Valid time: 1.37389s
Wed, 25 Dec 2024 15:11:07 recommender.py[line:254] INFO Training: Epoch= 22 [recall@10=0.1841 ndcg@10=0.0926 train_loss=5.4213]
Wed, 25 Dec 2024 15:11:07 recommender.py[line:519] INFO Train time: 1.31885s. Valid time: 1.35977s
Wed, 25 Dec 2024 15:11:08 recommender.py[line:254] INFO Training: Epoch= 23 [recall@10=0.1841 ndcg@10=0.0922 train_loss=5.4108]
Wed, 25 Dec 2024 15:11:08 recommender.py[line:519] INFO Train time: 1.14861s. Valid time: 1.17788s
Wed, 25 Dec 2024 15:11:09 recommender.py[line:254] INFO Training: Epoch= 24 [recall@10=0.1778 ndcg@10=0.0848 train_loss=5.3971]
Wed, 25 Dec 2024 15:11:09 recommender.py[line:519] INFO Train time: 1.26326s. Valid time: 1.29611s
Wed, 25 Dec 2024 15:11:10 recommender.py[line:254] INFO Training: Epoch= 25 [recall@10=0.1778 ndcg@10=0.0870 train_loss=5.3852]
Wed, 25 Dec 2024 15:11:10 recommender.py[line:519] INFO Train time: 1.09957s. Valid time: 1.12924s
Wed, 25 Dec 2024 15:11:12 recommender.py[line:254] INFO Training: Epoch= 26 [recall@10=0.1968 ndcg@10=0.0908 train_loss=5.3769]
Wed, 25 Dec 2024 15:11:12 recommender.py[line:519] INFO Train time: 1.14329s. Valid time: 1.17259s
Wed, 25 Dec 2024 15:11:12 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1968
Wed, 25 Dec 2024 15:11:13 recommender.py[line:254] INFO Training: Epoch= 27 [recall@10=0.1714 ndcg@10=0.0825 train_loss=5.3731]
Wed, 25 Dec 2024 15:11:13 recommender.py[line:519] INFO Train time: 1.14523s. Valid time: 1.17378s
Wed, 25 Dec 2024 15:11:14 recommender.py[line:254] INFO Training: Epoch= 28 [recall@10=0.1937 ndcg@10=0.0900 train_loss=5.3585]
Wed, 25 Dec 2024 15:11:14 recommender.py[line:519] INFO Train time: 1.25344s. Valid time: 1.27819s
Wed, 25 Dec 2024 15:11:15 recommender.py[line:254] INFO Training: Epoch= 29 [recall@10=0.1937 ndcg@10=0.0941 train_loss=5.3532]
Wed, 25 Dec 2024 15:11:15 recommender.py[line:519] INFO Train time: 1.15058s. Valid time: 1.17591s
Wed, 25 Dec 2024 15:11:16 recommender.py[line:254] INFO Training: Epoch= 30 [recall@10=0.1873 ndcg@10=0.0889 train_loss=5.3495]
Wed, 25 Dec 2024 15:11:16 recommender.py[line:519] INFO Train time: 1.23363s. Valid time: 1.26405s
Wed, 25 Dec 2024 15:11:18 recommender.py[line:254] INFO Training: Epoch= 31 [recall@10=0.1905 ndcg@10=0.0912 train_loss=5.3272]
Wed, 25 Dec 2024 15:11:18 recommender.py[line:519] INFO Train time: 1.24644s. Valid time: 1.27553s
Wed, 25 Dec 2024 15:11:19 recommender.py[line:254] INFO Training: Epoch= 32 [recall@10=0.1746 ndcg@10=0.0849 train_loss=5.3272]
Wed, 25 Dec 2024 15:11:19 recommender.py[line:519] INFO Train time: 1.16439s. Valid time: 1.19382s
Wed, 25 Dec 2024 15:11:20 recommender.py[line:254] INFO Training: Epoch= 33 [recall@10=0.1905 ndcg@10=0.0905 train_loss=5.3158]
Wed, 25 Dec 2024 15:11:20 recommender.py[line:519] INFO Train time: 1.20872s. Valid time: 1.23413s
Wed, 25 Dec 2024 15:11:21 recommender.py[line:254] INFO Training: Epoch= 34 [recall@10=0.1841 ndcg@10=0.0887 train_loss=5.3073]
Wed, 25 Dec 2024 15:11:21 recommender.py[line:519] INFO Train time: 1.11691s. Valid time: 1.14649s
Wed, 25 Dec 2024 15:11:23 recommender.py[line:254] INFO Training: Epoch= 35 [recall@10=0.1746 ndcg@10=0.0836 train_loss=5.2953]
Wed, 25 Dec 2024 15:11:23 recommender.py[line:519] INFO Train time: 1.25056s. Valid time: 1.27745s
Wed, 25 Dec 2024 15:11:24 recommender.py[line:254] INFO Training: Epoch= 36 [recall@10=0.1683 ndcg@10=0.0880 train_loss=5.2987]
Wed, 25 Dec 2024 15:11:24 recommender.py[line:519] INFO Train time: 1.17637s. Valid time: 1.20354s
Wed, 25 Dec 2024 15:11:25 recommender.py[line:254] INFO Training: Epoch= 37 [recall@10=0.1873 ndcg@10=0.0880 train_loss=5.2833]
Wed, 25 Dec 2024 15:11:25 recommender.py[line:519] INFO Train time: 1.22315s. Valid time: 1.24690s
Wed, 25 Dec 2024 15:11:26 recommender.py[line:254] INFO Training: Epoch= 38 [recall@10=0.1841 ndcg@10=0.0897 train_loss=5.2821]
Wed, 25 Dec 2024 15:11:26 recommender.py[line:519] INFO Train time: 1.23018s. Valid time: 1.26022s
Wed, 25 Dec 2024 15:11:28 recommender.py[line:254] INFO Training: Epoch= 39 [recall@10=0.1714 ndcg@10=0.0886 train_loss=5.2686]
Wed, 25 Dec 2024 15:11:28 recommender.py[line:519] INFO Train time: 1.30324s. Valid time: 1.32628s
Wed, 25 Dec 2024 15:11:29 recommender.py[line:254] INFO Training: Epoch= 40 [recall@10=0.1778 ndcg@10=0.0914 train_loss=5.2690]
Wed, 25 Dec 2024 15:11:29 recommender.py[line:519] INFO Train time: 1.24578s. Valid time: 1.26884s
Wed, 25 Dec 2024 15:11:30 recommender.py[line:254] INFO Training: Epoch= 41 [recall@10=0.1841 ndcg@10=0.0917 train_loss=5.2569]
Wed, 25 Dec 2024 15:11:30 recommender.py[line:519] INFO Train time: 1.17170s. Valid time: 1.19124s
Wed, 25 Dec 2024 15:11:31 recommender.py[line:254] INFO Training: Epoch= 42 [recall@10=0.1873 ndcg@10=0.0924 train_loss=5.2533]
Wed, 25 Dec 2024 15:11:31 recommender.py[line:519] INFO Train time: 1.28678s. Valid time: 1.31104s
Wed, 25 Dec 2024 15:11:33 recommender.py[line:254] INFO Training: Epoch= 43 [recall@10=0.2000 ndcg@10=0.0992 train_loss=5.2351]
Wed, 25 Dec 2024 15:11:33 recommender.py[line:519] INFO Train time: 1.25375s. Valid time: 1.28668s
Wed, 25 Dec 2024 15:11:33 recommender.py[line:548] INFO recall@10 improved. Best value: 0.2000
Wed, 25 Dec 2024 15:11:34 recommender.py[line:254] INFO Training: Epoch= 44 [recall@10=0.1841 ndcg@10=0.0902 train_loss=5.2373]
Wed, 25 Dec 2024 15:11:34 recommender.py[line:519] INFO Train time: 1.32227s. Valid time: 1.34817s
Wed, 25 Dec 2024 15:11:35 recommender.py[line:254] INFO Training: Epoch= 45 [recall@10=0.1841 ndcg@10=0.0896 train_loss=5.2328]
Wed, 25 Dec 2024 15:11:35 recommender.py[line:519] INFO Train time: 1.05633s. Valid time: 1.08099s
Wed, 25 Dec 2024 15:11:37 recommender.py[line:254] INFO Training: Epoch= 46 [recall@10=0.1587 ndcg@10=0.0842 train_loss=5.2205]
Wed, 25 Dec 2024 15:11:37 recommender.py[line:519] INFO Train time: 1.51681s. Valid time: 1.54182s
Wed, 25 Dec 2024 15:11:38 recommender.py[line:254] INFO Training: Epoch= 47 [recall@10=0.1810 ndcg@10=0.0923 train_loss=5.2130]
Wed, 25 Dec 2024 15:11:38 recommender.py[line:519] INFO Train time: 1.46438s. Valid time: 1.49448s
Wed, 25 Dec 2024 15:11:40 recommender.py[line:254] INFO Training: Epoch= 48 [recall@10=0.2000 ndcg@10=0.0980 train_loss=5.2103]
Wed, 25 Dec 2024 15:11:40 recommender.py[line:519] INFO Train time: 1.45801s. Valid time: 1.48545s
Wed, 25 Dec 2024 15:11:41 recommender.py[line:254] INFO Training: Epoch= 49 [recall@10=0.1937 ndcg@10=0.0933 train_loss=5.2074]
Wed, 25 Dec 2024 15:11:41 recommender.py[line:519] INFO Train time: 1.53430s. Valid time: 1.56001s
Wed, 25 Dec 2024 15:11:42 recommender.py[line:254] INFO Training: Epoch= 50 [recall@10=0.1873 ndcg@10=0.0984 train_loss=5.1940]
Wed, 25 Dec 2024 15:11:42 recommender.py[line:519] INFO Train time: 1.28243s. Valid time: 1.30520s
Wed, 25 Dec 2024 15:11:44 recommender.py[line:254] INFO Training: Epoch= 51 [recall@10=0.1873 ndcg@10=0.0987 train_loss=5.1954]
Wed, 25 Dec 2024 15:11:44 recommender.py[line:519] INFO Train time: 1.18524s. Valid time: 1.20810s
Wed, 25 Dec 2024 15:11:45 recommender.py[line:254] INFO Training: Epoch= 52 [recall@10=0.1905 ndcg@10=0.0962 train_loss=5.1921]
Wed, 25 Dec 2024 15:11:45 recommender.py[line:519] INFO Train time: 1.11085s. Valid time: 1.13031s
Wed, 25 Dec 2024 15:11:46 recommender.py[line:254] INFO Training: Epoch= 53 [recall@10=0.1968 ndcg@10=0.0968 train_loss=5.1709]
Wed, 25 Dec 2024 15:11:46 recommender.py[line:519] INFO Train time: 1.31746s. Valid time: 1.33723s
Wed, 25 Dec 2024 15:11:47 recommender.py[line:254] INFO Training: Epoch= 54 [recall@10=0.2000 ndcg@10=0.1013 train_loss=5.1792]
Wed, 25 Dec 2024 15:11:47 recommender.py[line:519] INFO Train time: 1.12286s. Valid time: 1.14905s
Wed, 25 Dec 2024 15:11:49 recommender.py[line:254] INFO Training: Epoch= 55 [recall@10=0.2000 ndcg@10=0.0990 train_loss=5.1623]
Wed, 25 Dec 2024 15:11:49 recommender.py[line:519] INFO Train time: 1.49068s. Valid time: 1.51578s
Wed, 25 Dec 2024 15:11:50 recommender.py[line:254] INFO Training: Epoch= 56 [recall@10=0.2000 ndcg@10=0.1041 train_loss=5.1664]
Wed, 25 Dec 2024 15:11:50 recommender.py[line:519] INFO Train time: 1.49974s. Valid time: 1.52502s
Wed, 25 Dec 2024 15:11:52 recommender.py[line:254] INFO Training: Epoch= 57 [recall@10=0.1873 ndcg@10=0.0921 train_loss=5.1523]
Wed, 25 Dec 2024 15:11:52 recommender.py[line:519] INFO Train time: 1.25272s. Valid time: 1.27121s
Wed, 25 Dec 2024 15:11:53 recommender.py[line:254] INFO Training: Epoch= 58 [recall@10=0.1937 ndcg@10=0.0974 train_loss=5.1435]
Wed, 25 Dec 2024 15:11:53 recommender.py[line:519] INFO Train time: 1.20509s. Valid time: 1.22441s
Wed, 25 Dec 2024 15:11:54 recommender.py[line:254] INFO Training: Epoch= 59 [recall@10=0.1905 ndcg@10=0.0959 train_loss=5.1396]
Wed, 25 Dec 2024 15:11:54 recommender.py[line:519] INFO Train time: 1.12244s. Valid time: 1.14087s
Wed, 25 Dec 2024 15:11:55 recommender.py[line:254] INFO Training: Epoch= 60 [recall@10=0.1714 ndcg@10=0.0931 train_loss=5.1385]
Wed, 25 Dec 2024 15:11:55 recommender.py[line:519] INFO Train time: 1.16741s. Valid time: 1.18587s
Wed, 25 Dec 2024 15:11:56 recommender.py[line:254] INFO Training: Epoch= 61 [recall@10=0.1873 ndcg@10=0.0931 train_loss=5.1297]
Wed, 25 Dec 2024 15:11:56 recommender.py[line:519] INFO Train time: 1.11135s. Valid time: 1.13078s
Wed, 25 Dec 2024 15:11:57 recommender.py[line:254] INFO Training: Epoch= 62 [recall@10=0.1968 ndcg@10=0.0998 train_loss=5.1275]
Wed, 25 Dec 2024 15:11:57 recommender.py[line:519] INFO Train time: 1.18960s. Valid time: 1.20818s
Wed, 25 Dec 2024 15:11:59 recommender.py[line:254] INFO Training: Epoch= 63 [recall@10=0.1968 ndcg@10=0.1027 train_loss=5.1189]
Wed, 25 Dec 2024 15:11:59 recommender.py[line:519] INFO Train time: 1.10205s. Valid time: 1.12096s
Wed, 25 Dec 2024 15:11:59 recommender.py[line:559] INFO Early stopped. recall@10 didn't improve for 20 epochs.
Wed, 25 Dec 2024 15:11:59 recommender.py[line:562] INFO The best score of recall@10 is 0.2000 at 43
Wed, 25 Dec 2024 15:11:59 recommender.py[line:730] INFO Best model checkpoiny saved in ./metadata/model_checkpoint/shadow_model/ml-100k/BERT4Rec/split/train/nonmember_model_16.
Wed, 25 Dec 2024 15:11:59 shadow.py[line:57] INFO Shadow model recommendation performance:
Wed, 25 Dec 2024 15:11:59 recommender.py[line:196] INFO Testing:  [recall@10=0.1905 precision@10=0.0190 map@10=0.0697 ndcg@10=0.0978 mrr@10=0.0697 hit@10=0.1905]
Wed, 25 Dec 2024 15:12:03 shadow.py[line:292] INFO End of the code.
