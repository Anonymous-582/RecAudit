Wed, 25 Dec 2024 15:09:00 shadow.py[line:150] INFO {'dataset': 'ml-100k', 'model': 'BERT4Rec', 'split_seed': 9, 'gpu': 3, 'split_cf': 'split', 'train_cf': 'train'}
Wed, 25 Dec 2024 15:09:00 utils.py[line:224] INFO dataset is read from ../datasets/ml-100k.
Wed, 25 Dec 2024 15:09:01 utils.py[line:38] INFO 
Dataset Info: 

==================================================
item information: 
field     item_id   
type      token     
##        1153      
==================================================
user information: 
field     user_id   
type      token     
##        944       
==================================================
interaction information: 
field     user_id   item_id   rating    timestamp 
type      token     token     float     float     
##        944       1153      -         -         
==================================================
Sparsity: 0.909832
==================================================
Wed, 25 Dec 2024 15:09:02 utils.py[line:297] INFO Global seed set to 2019
Wed, 25 Dec 2024 15:09:02 utils.py[line:62] INFO 
Model Config: 

accelerator=gpu
activation=gelu
ann=None
batch_size=1024
cutoff=10
dataset_neg_count=None
dataset_sampler=None
dropout=0.2
early_stop_mode=max
early_stop_patience=20
embed_dim=64
epochs=100
eval_batch_size=128
excluding_hist=False
gpu=[3]
head_num=2
hidden_size=128
item_bias=False
layer_norm_eps=1e-12
layer_num=2
learner=adam
learning_rate=0.001
mask_ratio=0.2
negative_count=1
num_workers=0
pooling_type=mask
save_path=./saved/
scheduler=None
seed=2019
split_ratio=2
steal=False
test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
test_repetitive=True
topk=100
train_repetitive=True
val_metrics=['recall', 'ndcg']
weight_decay=1e-05
Wed, 25 Dec 2024 15:09:02 utils.py[line:297] INFO Global seed set to 2019
Wed, 25 Dec 2024 15:09:02 utils.py[line:62] INFO 
Model Config: 

accelerator=gpu
activation=gelu
ann=None
batch_size=1024
cutoff=10
dataset_neg_count=None
dataset_sampler=None
dropout=0.2
early_stop_mode=max
early_stop_patience=20
embed_dim=64
epochs=100
eval_batch_size=128
excluding_hist=False
gpu=[3]
head_num=2
hidden_size=128
item_bias=False
layer_norm_eps=1e-12
layer_num=2
learner=adam
learning_rate=0.001
mask_ratio=0.2
negative_count=1
num_workers=0
pooling_type=mask
save_path=./saved/
scheduler=None
seed=2019
split_ratio=2
steal=False
test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
test_repetitive=True
topk=100
train_repetitive=True
val_metrics=['recall', 'ndcg']
weight_decay=1e-05
Wed, 25 Dec 2024 15:09:02 recommender.py[line:128] INFO save_dir:/data1/home/zhihao/code/RecAudit/open-source/RecAudit/RecStudio-main
Wed, 25 Dec 2024 15:09:02 recommender.py[line:131] INFO BERT4Rec(
  (loss_fn): SoftmaxLoss()
  (score_func): InnerProductScorer()
  (item_encoder): Embedding(1154, 64, padding_idx=0)
  (query_encoder): BERT4RecQueryEncoder(
    (item_encoder): Embedding(1154, 64, padding_idx=0)
    (position_emb): Embedding(20, 64)
    (transformer_layer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
      )
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (training_pooling_layer): SeqPoolingLayer(pooling_type=mask, keepdim=False)
    (eval_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
  )
)
Wed, 25 Dec 2024 15:09:08 recommender.py[line:254] INFO Training: Epoch=  0 [recall@10=0.0605 ndcg@10=0.0247 train_loss=6.7929]
Wed, 25 Dec 2024 15:09:08 recommender.py[line:519] INFO Train time: 1.62881s. Valid time: 1.67821s
Wed, 25 Dec 2024 15:09:08 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0605
Wed, 25 Dec 2024 15:09:10 recommender.py[line:254] INFO Training: Epoch=  1 [recall@10=0.0605 ndcg@10=0.0301 train_loss=6.5795]
Wed, 25 Dec 2024 15:09:10 recommender.py[line:519] INFO Train time: 1.35861s. Valid time: 1.39530s
Wed, 25 Dec 2024 15:09:11 recommender.py[line:254] INFO Training: Epoch=  2 [recall@10=0.1465 ndcg@10=0.0824 train_loss=6.3736]
Wed, 25 Dec 2024 15:09:11 recommender.py[line:519] INFO Train time: 1.31268s. Valid time: 1.34639s
Wed, 25 Dec 2024 15:09:11 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1465
Wed, 25 Dec 2024 15:09:12 recommender.py[line:254] INFO Training: Epoch=  3 [recall@10=0.1720 ndcg@10=0.0943 train_loss=6.0559]
Wed, 25 Dec 2024 15:09:12 recommender.py[line:519] INFO Train time: 1.37067s. Valid time: 1.40585s
Wed, 25 Dec 2024 15:09:12 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1720
Wed, 25 Dec 2024 15:09:14 recommender.py[line:254] INFO Training: Epoch=  4 [recall@10=0.1497 ndcg@10=0.0873 train_loss=5.9049]
Wed, 25 Dec 2024 15:09:14 recommender.py[line:519] INFO Train time: 1.39640s. Valid time: 1.42960s
Wed, 25 Dec 2024 15:09:15 recommender.py[line:254] INFO Training: Epoch=  5 [recall@10=0.1624 ndcg@10=0.0790 train_loss=5.8272]
Wed, 25 Dec 2024 15:09:15 recommender.py[line:519] INFO Train time: 1.38993s. Valid time: 1.42257s
Wed, 25 Dec 2024 15:09:17 recommender.py[line:254] INFO Training: Epoch=  6 [recall@10=0.1497 ndcg@10=0.0706 train_loss=5.7641]
Wed, 25 Dec 2024 15:09:17 recommender.py[line:519] INFO Train time: 1.34222s. Valid time: 1.38105s
Wed, 25 Dec 2024 15:09:18 recommender.py[line:254] INFO Training: Epoch=  7 [recall@10=0.1338 ndcg@10=0.0623 train_loss=5.7233]
Wed, 25 Dec 2024 15:09:18 recommender.py[line:519] INFO Train time: 1.30057s. Valid time: 1.33046s
Wed, 25 Dec 2024 15:09:19 recommender.py[line:254] INFO Training: Epoch=  8 [recall@10=0.1561 ndcg@10=0.0758 train_loss=5.6815]
Wed, 25 Dec 2024 15:09:19 recommender.py[line:519] INFO Train time: 1.38267s. Valid time: 1.41317s
Wed, 25 Dec 2024 15:09:21 recommender.py[line:254] INFO Training: Epoch=  9 [recall@10=0.1497 ndcg@10=0.0723 train_loss=5.6607]
Wed, 25 Dec 2024 15:09:21 recommender.py[line:519] INFO Train time: 1.67892s. Valid time: 1.71667s
Wed, 25 Dec 2024 15:09:22 recommender.py[line:254] INFO Training: Epoch= 10 [recall@10=0.1465 ndcg@10=0.0684 train_loss=5.6260]
Wed, 25 Dec 2024 15:09:22 recommender.py[line:519] INFO Train time: 1.33841s. Valid time: 1.37818s
Wed, 25 Dec 2024 15:09:24 recommender.py[line:254] INFO Training: Epoch= 11 [recall@10=0.1592 ndcg@10=0.0750 train_loss=5.6074]
Wed, 25 Dec 2024 15:09:24 recommender.py[line:519] INFO Train time: 1.35737s. Valid time: 1.39420s
Wed, 25 Dec 2024 15:09:25 recommender.py[line:254] INFO Training: Epoch= 12 [recall@10=0.1592 ndcg@10=0.0810 train_loss=5.5873]
Wed, 25 Dec 2024 15:09:25 recommender.py[line:519] INFO Train time: 1.32299s. Valid time: 1.36183s
Wed, 25 Dec 2024 15:09:27 recommender.py[line:254] INFO Training: Epoch= 13 [recall@10=0.1592 ndcg@10=0.0771 train_loss=5.5740]
Wed, 25 Dec 2024 15:09:27 recommender.py[line:519] INFO Train time: 1.39185s. Valid time: 1.42984s
Wed, 25 Dec 2024 15:09:28 recommender.py[line:254] INFO Training: Epoch= 14 [recall@10=0.1656 ndcg@10=0.0841 train_loss=5.5571]
Wed, 25 Dec 2024 15:09:28 recommender.py[line:519] INFO Train time: 1.30787s. Valid time: 1.34721s
Wed, 25 Dec 2024 15:09:29 recommender.py[line:254] INFO Training: Epoch= 15 [recall@10=0.1752 ndcg@10=0.0873 train_loss=5.5363]
Wed, 25 Dec 2024 15:09:29 recommender.py[line:519] INFO Train time: 1.40895s. Valid time: 1.44923s
Wed, 25 Dec 2024 15:09:29 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1752
Wed, 25 Dec 2024 15:09:31 recommender.py[line:254] INFO Training: Epoch= 16 [recall@10=0.1752 ndcg@10=0.0938 train_loss=5.5163]
Wed, 25 Dec 2024 15:09:31 recommender.py[line:519] INFO Train time: 1.31623s. Valid time: 1.35238s
Wed, 25 Dec 2024 15:09:32 recommender.py[line:254] INFO Training: Epoch= 17 [recall@10=0.1847 ndcg@10=0.0950 train_loss=5.5045]
Wed, 25 Dec 2024 15:09:32 recommender.py[line:519] INFO Train time: 1.29697s. Valid time: 1.33255s
Wed, 25 Dec 2024 15:09:32 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1847
Wed, 25 Dec 2024 15:09:33 recommender.py[line:254] INFO Training: Epoch= 18 [recall@10=0.1720 ndcg@10=0.0881 train_loss=5.4913]
Wed, 25 Dec 2024 15:09:33 recommender.py[line:519] INFO Train time: 1.36441s. Valid time: 1.39965s
Wed, 25 Dec 2024 15:09:35 recommender.py[line:254] INFO Training: Epoch= 19 [recall@10=0.1624 ndcg@10=0.0891 train_loss=5.4833]
Wed, 25 Dec 2024 15:09:35 recommender.py[line:519] INFO Train time: 1.38216s. Valid time: 1.41507s
Wed, 25 Dec 2024 15:09:36 recommender.py[line:254] INFO Training: Epoch= 20 [recall@10=0.1688 ndcg@10=0.0879 train_loss=5.4693]
Wed, 25 Dec 2024 15:09:36 recommender.py[line:519] INFO Train time: 1.42077s. Valid time: 1.45970s
Wed, 25 Dec 2024 15:09:38 recommender.py[line:254] INFO Training: Epoch= 21 [recall@10=0.1561 ndcg@10=0.0959 train_loss=5.4566]
Wed, 25 Dec 2024 15:09:38 recommender.py[line:519] INFO Train time: 1.39491s. Valid time: 1.42417s
Wed, 25 Dec 2024 15:09:39 recommender.py[line:254] INFO Training: Epoch= 22 [recall@10=0.1624 ndcg@10=0.0863 train_loss=5.4485]
Wed, 25 Dec 2024 15:09:39 recommender.py[line:519] INFO Train time: 1.30036s. Valid time: 1.33786s
Wed, 25 Dec 2024 15:09:40 recommender.py[line:254] INFO Training: Epoch= 23 [recall@10=0.1592 ndcg@10=0.0877 train_loss=5.4429]
Wed, 25 Dec 2024 15:09:40 recommender.py[line:519] INFO Train time: 1.35604s. Valid time: 1.38872s
Wed, 25 Dec 2024 15:09:42 recommender.py[line:254] INFO Training: Epoch= 24 [recall@10=0.1592 ndcg@10=0.0913 train_loss=5.4269]
Wed, 25 Dec 2024 15:09:42 recommender.py[line:519] INFO Train time: 1.50295s. Valid time: 1.53826s
Wed, 25 Dec 2024 15:09:43 recommender.py[line:254] INFO Training: Epoch= 25 [recall@10=0.1720 ndcg@10=0.0924 train_loss=5.4111]
Wed, 25 Dec 2024 15:09:43 recommender.py[line:519] INFO Train time: 1.43591s. Valid time: 1.46637s
Wed, 25 Dec 2024 15:09:45 recommender.py[line:254] INFO Training: Epoch= 26 [recall@10=0.1783 ndcg@10=0.0947 train_loss=5.4002]
Wed, 25 Dec 2024 15:09:45 recommender.py[line:519] INFO Train time: 1.35411s. Valid time: 1.39061s
Wed, 25 Dec 2024 15:09:46 recommender.py[line:254] INFO Training: Epoch= 27 [recall@10=0.1688 ndcg@10=0.0864 train_loss=5.3885]
Wed, 25 Dec 2024 15:09:46 recommender.py[line:519] INFO Train time: 1.51555s. Valid time: 1.54961s
Wed, 25 Dec 2024 15:09:48 recommender.py[line:254] INFO Training: Epoch= 28 [recall@10=0.1720 ndcg@10=0.0954 train_loss=5.3834]
Wed, 25 Dec 2024 15:09:48 recommender.py[line:519] INFO Train time: 1.44696s. Valid time: 1.48735s
Wed, 25 Dec 2024 15:09:49 recommender.py[line:254] INFO Training: Epoch= 29 [recall@10=0.1783 ndcg@10=0.0909 train_loss=5.3749]
Wed, 25 Dec 2024 15:09:49 recommender.py[line:519] INFO Train time: 1.31835s. Valid time: 1.35209s
Wed, 25 Dec 2024 15:09:51 recommender.py[line:254] INFO Training: Epoch= 30 [recall@10=0.1879 ndcg@10=0.0991 train_loss=5.3616]
Wed, 25 Dec 2024 15:09:51 recommender.py[line:519] INFO Train time: 1.40385s. Valid time: 1.44340s
Wed, 25 Dec 2024 15:09:51 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1879
Wed, 25 Dec 2024 15:09:52 recommender.py[line:254] INFO Training: Epoch= 31 [recall@10=0.1847 ndcg@10=0.0961 train_loss=5.3512]
Wed, 25 Dec 2024 15:09:52 recommender.py[line:519] INFO Train time: 1.32115s. Valid time: 1.35220s
Wed, 25 Dec 2024 15:09:54 recommender.py[line:254] INFO Training: Epoch= 32 [recall@10=0.1879 ndcg@10=0.0984 train_loss=5.3480]
Wed, 25 Dec 2024 15:09:54 recommender.py[line:519] INFO Train time: 1.42878s. Valid time: 1.47139s
Wed, 25 Dec 2024 15:09:55 recommender.py[line:254] INFO Training: Epoch= 33 [recall@10=0.1720 ndcg@10=0.0918 train_loss=5.3462]
Wed, 25 Dec 2024 15:09:55 recommender.py[line:519] INFO Train time: 1.39924s. Valid time: 1.44113s
Wed, 25 Dec 2024 15:09:56 recommender.py[line:254] INFO Training: Epoch= 34 [recall@10=0.1783 ndcg@10=0.0903 train_loss=5.3219]
Wed, 25 Dec 2024 15:09:56 recommender.py[line:519] INFO Train time: 1.37498s. Valid time: 1.40931s
Wed, 25 Dec 2024 15:09:58 recommender.py[line:254] INFO Training: Epoch= 35 [recall@10=0.1783 ndcg@10=0.0913 train_loss=5.3182]
Wed, 25 Dec 2024 15:09:58 recommender.py[line:519] INFO Train time: 1.39191s. Valid time: 1.43146s
Wed, 25 Dec 2024 15:09:59 recommender.py[line:254] INFO Training: Epoch= 36 [recall@10=0.1752 ndcg@10=0.0929 train_loss=5.3133]
Wed, 25 Dec 2024 15:09:59 recommender.py[line:519] INFO Train time: 1.33527s. Valid time: 1.36739s
Wed, 25 Dec 2024 15:10:01 recommender.py[line:254] INFO Training: Epoch= 37 [recall@10=0.2006 ndcg@10=0.1017 train_loss=5.3029]
Wed, 25 Dec 2024 15:10:01 recommender.py[line:519] INFO Train time: 1.36079s. Valid time: 1.39952s
Wed, 25 Dec 2024 15:10:01 recommender.py[line:548] INFO recall@10 improved. Best value: 0.2006
Wed, 25 Dec 2024 15:10:02 recommender.py[line:254] INFO Training: Epoch= 38 [recall@10=0.1592 ndcg@10=0.0897 train_loss=5.3028]
Wed, 25 Dec 2024 15:10:02 recommender.py[line:519] INFO Train time: 1.35298s. Valid time: 1.38809s
Wed, 25 Dec 2024 15:10:03 recommender.py[line:254] INFO Training: Epoch= 39 [recall@10=0.1688 ndcg@10=0.0921 train_loss=5.2915]
Wed, 25 Dec 2024 15:10:03 recommender.py[line:519] INFO Train time: 1.44142s. Valid time: 1.47687s
Wed, 25 Dec 2024 15:10:05 recommender.py[line:254] INFO Training: Epoch= 40 [recall@10=0.1943 ndcg@10=0.0954 train_loss=5.2868]
Wed, 25 Dec 2024 15:10:05 recommender.py[line:519] INFO Train time: 1.37741s. Valid time: 1.41388s
Wed, 25 Dec 2024 15:10:06 recommender.py[line:254] INFO Training: Epoch= 41 [recall@10=0.1879 ndcg@10=0.0976 train_loss=5.2722]
Wed, 25 Dec 2024 15:10:06 recommender.py[line:519] INFO Train time: 1.32589s. Valid time: 1.35962s
Wed, 25 Dec 2024 15:10:08 recommender.py[line:254] INFO Training: Epoch= 42 [recall@10=0.1879 ndcg@10=0.0990 train_loss=5.2715]
Wed, 25 Dec 2024 15:10:08 recommender.py[line:519] INFO Train time: 1.32568s. Valid time: 1.36128s
Wed, 25 Dec 2024 15:10:09 recommender.py[line:254] INFO Training: Epoch= 43 [recall@10=0.1688 ndcg@10=0.0978 train_loss=5.2610]
Wed, 25 Dec 2024 15:10:09 recommender.py[line:519] INFO Train time: 1.38928s. Valid time: 1.42613s
Wed, 25 Dec 2024 15:10:11 recommender.py[line:254] INFO Training: Epoch= 44 [recall@10=0.1688 ndcg@10=0.0957 train_loss=5.2505]
Wed, 25 Dec 2024 15:10:11 recommender.py[line:519] INFO Train time: 1.44290s. Valid time: 1.48982s
Wed, 25 Dec 2024 15:10:12 recommender.py[line:254] INFO Training: Epoch= 45 [recall@10=0.1497 ndcg@10=0.0867 train_loss=5.2554]
Wed, 25 Dec 2024 15:10:12 recommender.py[line:519] INFO Train time: 1.40524s. Valid time: 1.44736s
Wed, 25 Dec 2024 15:10:14 recommender.py[line:254] INFO Training: Epoch= 46 [recall@10=0.1529 ndcg@10=0.0931 train_loss=5.2405]
Wed, 25 Dec 2024 15:10:14 recommender.py[line:519] INFO Train time: 1.82312s. Valid time: 1.85447s
Wed, 25 Dec 2024 15:10:15 recommender.py[line:254] INFO Training: Epoch= 47 [recall@10=0.1783 ndcg@10=0.0968 train_loss=5.2398]
Wed, 25 Dec 2024 15:10:15 recommender.py[line:519] INFO Train time: 1.52458s. Valid time: 1.56537s
Wed, 25 Dec 2024 15:10:17 recommender.py[line:254] INFO Training: Epoch= 48 [recall@10=0.1752 ndcg@10=0.0929 train_loss=5.2283]
Wed, 25 Dec 2024 15:10:17 recommender.py[line:519] INFO Train time: 1.52821s. Valid time: 1.55965s
Wed, 25 Dec 2024 15:10:18 recommender.py[line:254] INFO Training: Epoch= 49 [recall@10=0.1720 ndcg@10=0.0996 train_loss=5.2087]
Wed, 25 Dec 2024 15:10:18 recommender.py[line:519] INFO Train time: 1.39642s. Valid time: 1.43116s
Wed, 25 Dec 2024 15:10:20 recommender.py[line:254] INFO Training: Epoch= 50 [recall@10=0.1720 ndcg@10=0.0963 train_loss=5.2120]
Wed, 25 Dec 2024 15:10:20 recommender.py[line:519] INFO Train time: 1.29399s. Valid time: 1.33494s
Wed, 25 Dec 2024 15:10:21 recommender.py[line:254] INFO Training: Epoch= 51 [recall@10=0.1783 ndcg@10=0.1019 train_loss=5.1961]
Wed, 25 Dec 2024 15:10:21 recommender.py[line:519] INFO Train time: 1.43439s. Valid time: 1.47423s
Wed, 25 Dec 2024 15:10:23 recommender.py[line:254] INFO Training: Epoch= 52 [recall@10=0.1783 ndcg@10=0.1000 train_loss=5.1936]
Wed, 25 Dec 2024 15:10:23 recommender.py[line:519] INFO Train time: 1.39049s. Valid time: 1.43175s
Wed, 25 Dec 2024 15:10:24 recommender.py[line:254] INFO Training: Epoch= 53 [recall@10=0.1624 ndcg@10=0.1003 train_loss=5.1910]
Wed, 25 Dec 2024 15:10:24 recommender.py[line:519] INFO Train time: 1.46128s. Valid time: 1.49713s
Wed, 25 Dec 2024 15:10:26 recommender.py[line:254] INFO Training: Epoch= 54 [recall@10=0.1815 ndcg@10=0.1043 train_loss=5.1794]
Wed, 25 Dec 2024 15:10:26 recommender.py[line:519] INFO Train time: 1.69102s. Valid time: 1.73649s
Wed, 25 Dec 2024 15:10:27 recommender.py[line:254] INFO Training: Epoch= 55 [recall@10=0.1720 ndcg@10=0.0988 train_loss=5.1771]
Wed, 25 Dec 2024 15:10:27 recommender.py[line:519] INFO Train time: 1.57433s. Valid time: 1.61426s
Wed, 25 Dec 2024 15:10:29 recommender.py[line:254] INFO Training: Epoch= 56 [recall@10=0.1815 ndcg@10=0.1007 train_loss=5.1612]
Wed, 25 Dec 2024 15:10:29 recommender.py[line:519] INFO Train time: 1.60458s. Valid time: 1.63257s
Wed, 25 Dec 2024 15:10:31 recommender.py[line:254] INFO Training: Epoch= 57 [recall@10=0.1688 ndcg@10=0.0959 train_loss=5.1666]
Wed, 25 Dec 2024 15:10:31 recommender.py[line:519] INFO Train time: 1.65303s. Valid time: 1.69622s
Wed, 25 Dec 2024 15:10:31 recommender.py[line:559] INFO Early stopped. recall@10 didn't improve for 20 epochs.
Wed, 25 Dec 2024 15:10:31 recommender.py[line:562] INFO The best score of recall@10 is 0.2006 at 37
Wed, 25 Dec 2024 15:10:31 recommender.py[line:730] INFO Best model checkpoiny saved in ./metadata/model_checkpoint/shadow_model/ml-100k/BERT4Rec/split/train/member_model_9.
Wed, 25 Dec 2024 15:10:31 shadow.py[line:57] INFO Shadow model recommendation performance:
Wed, 25 Dec 2024 15:10:31 recommender.py[line:196] INFO Testing:  [recall@10=0.1624 precision@10=0.0162 map@10=0.0695 ndcg@10=0.0913 mrr@10=0.0695 hit@10=0.1624]
Wed, 25 Dec 2024 15:10:31 recommender.py[line:128] INFO save_dir:/data1/home/zhihao/code/RecAudit/open-source/RecAudit/RecStudio-main
Wed, 25 Dec 2024 15:10:31 recommender.py[line:131] INFO BERT4Rec(
  (loss_fn): SoftmaxLoss()
  (score_func): InnerProductScorer()
  (item_encoder): Embedding(1154, 64, padding_idx=0)
  (query_encoder): BERT4RecQueryEncoder(
    (item_encoder): Embedding(1154, 64, padding_idx=0)
    (position_emb): Embedding(20, 64)
    (transformer_layer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
      )
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (training_pooling_layer): SeqPoolingLayer(pooling_type=mask, keepdim=False)
    (eval_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
  )
)
Wed, 25 Dec 2024 15:10:33 recommender.py[line:254] INFO Training: Epoch=  0 [recall@10=0.0571 ndcg@10=0.0290 train_loss=6.8027]
Wed, 25 Dec 2024 15:10:33 recommender.py[line:519] INFO Train time: 1.55829s. Valid time: 1.59421s
Wed, 25 Dec 2024 15:10:33 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0571
Wed, 25 Dec 2024 15:10:34 recommender.py[line:254] INFO Training: Epoch=  1 [recall@10=0.0603 ndcg@10=0.0347 train_loss=6.5998]
Wed, 25 Dec 2024 15:10:34 recommender.py[line:519] INFO Train time: 1.61502s. Valid time: 1.65622s
Wed, 25 Dec 2024 15:10:34 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0603
Wed, 25 Dec 2024 15:10:36 recommender.py[line:254] INFO Training: Epoch=  2 [recall@10=0.1048 ndcg@10=0.0547 train_loss=6.3270]
Wed, 25 Dec 2024 15:10:36 recommender.py[line:519] INFO Train time: 1.66803s. Valid time: 1.71675s
Wed, 25 Dec 2024 15:10:36 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1048
Wed, 25 Dec 2024 15:10:38 recommender.py[line:254] INFO Training: Epoch=  3 [recall@10=0.1175 ndcg@10=0.0590 train_loss=6.0260]
Wed, 25 Dec 2024 15:10:38 recommender.py[line:519] INFO Train time: 1.75739s. Valid time: 1.80564s
Wed, 25 Dec 2024 15:10:38 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1175
Wed, 25 Dec 2024 15:10:39 recommender.py[line:254] INFO Training: Epoch=  4 [recall@10=0.0984 ndcg@10=0.0478 train_loss=5.8935]
Wed, 25 Dec 2024 15:10:39 recommender.py[line:519] INFO Train time: 1.47805s. Valid time: 1.51113s
Wed, 25 Dec 2024 15:10:41 recommender.py[line:254] INFO Training: Epoch=  5 [recall@10=0.1206 ndcg@10=0.0557 train_loss=5.8157]
Wed, 25 Dec 2024 15:10:41 recommender.py[line:519] INFO Train time: 1.59716s. Valid time: 1.63947s
Wed, 25 Dec 2024 15:10:41 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1206
Wed, 25 Dec 2024 15:10:43 recommender.py[line:254] INFO Training: Epoch=  6 [recall@10=0.1333 ndcg@10=0.0640 train_loss=5.7563]
Wed, 25 Dec 2024 15:10:43 recommender.py[line:519] INFO Train time: 1.66857s. Valid time: 1.70649s
Wed, 25 Dec 2024 15:10:43 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1333
Wed, 25 Dec 2024 15:10:44 recommender.py[line:254] INFO Training: Epoch=  7 [recall@10=0.1429 ndcg@10=0.0694 train_loss=5.7129]
Wed, 25 Dec 2024 15:10:44 recommender.py[line:519] INFO Train time: 1.60010s. Valid time: 1.63781s
Wed, 25 Dec 2024 15:10:44 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1429
Wed, 25 Dec 2024 15:10:46 recommender.py[line:254] INFO Training: Epoch=  8 [recall@10=0.1397 ndcg@10=0.0699 train_loss=5.6728]
Wed, 25 Dec 2024 15:10:46 recommender.py[line:519] INFO Train time: 1.61655s. Valid time: 1.66083s
Wed, 25 Dec 2024 15:10:48 recommender.py[line:254] INFO Training: Epoch=  9 [recall@10=0.1746 ndcg@10=0.0830 train_loss=5.6368]
Wed, 25 Dec 2024 15:10:48 recommender.py[line:519] INFO Train time: 1.56780s. Valid time: 1.60968s
Wed, 25 Dec 2024 15:10:48 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1746
Wed, 25 Dec 2024 15:10:49 recommender.py[line:254] INFO Training: Epoch= 10 [recall@10=0.1810 ndcg@10=0.0877 train_loss=5.5994]
Wed, 25 Dec 2024 15:10:49 recommender.py[line:519] INFO Train time: 1.63922s. Valid time: 1.68068s
Wed, 25 Dec 2024 15:10:49 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1810
Wed, 25 Dec 2024 15:10:51 recommender.py[line:254] INFO Training: Epoch= 11 [recall@10=0.1968 ndcg@10=0.0886 train_loss=5.5807]
Wed, 25 Dec 2024 15:10:51 recommender.py[line:519] INFO Train time: 1.57353s. Valid time: 1.61402s
Wed, 25 Dec 2024 15:10:51 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1968
Wed, 25 Dec 2024 15:10:52 recommender.py[line:254] INFO Training: Epoch= 12 [recall@10=0.1778 ndcg@10=0.0840 train_loss=5.5575]
Wed, 25 Dec 2024 15:10:52 recommender.py[line:519] INFO Train time: 1.57435s. Valid time: 1.61680s
Wed, 25 Dec 2024 15:10:54 recommender.py[line:254] INFO Training: Epoch= 13 [recall@10=0.1873 ndcg@10=0.0922 train_loss=5.5321]
Wed, 25 Dec 2024 15:10:54 recommender.py[line:519] INFO Train time: 1.62626s. Valid time: 1.66549s
Wed, 25 Dec 2024 15:10:56 recommender.py[line:254] INFO Training: Epoch= 14 [recall@10=0.1619 ndcg@10=0.0778 train_loss=5.5163]
Wed, 25 Dec 2024 15:10:56 recommender.py[line:519] INFO Train time: 1.48454s. Valid time: 1.51730s
Wed, 25 Dec 2024 15:10:57 recommender.py[line:254] INFO Training: Epoch= 15 [recall@10=0.1873 ndcg@10=0.0919 train_loss=5.4971]
Wed, 25 Dec 2024 15:10:57 recommender.py[line:519] INFO Train time: 1.57054s. Valid time: 1.60968s
Wed, 25 Dec 2024 15:10:59 recommender.py[line:254] INFO Training: Epoch= 16 [recall@10=0.1841 ndcg@10=0.0916 train_loss=5.4817]
Wed, 25 Dec 2024 15:10:59 recommender.py[line:519] INFO Train time: 1.50109s. Valid time: 1.53106s
Wed, 25 Dec 2024 15:11:00 recommender.py[line:254] INFO Training: Epoch= 17 [recall@10=0.1714 ndcg@10=0.0832 train_loss=5.4739]
Wed, 25 Dec 2024 15:11:00 recommender.py[line:519] INFO Train time: 1.60711s. Valid time: 1.64240s
Wed, 25 Dec 2024 15:11:02 recommender.py[line:254] INFO Training: Epoch= 18 [recall@10=0.1905 ndcg@10=0.0893 train_loss=5.4638]
Wed, 25 Dec 2024 15:11:02 recommender.py[line:519] INFO Train time: 1.46828s. Valid time: 1.49706s
Wed, 25 Dec 2024 15:11:03 recommender.py[line:254] INFO Training: Epoch= 19 [recall@10=0.1778 ndcg@10=0.0835 train_loss=5.4467]
Wed, 25 Dec 2024 15:11:03 recommender.py[line:519] INFO Train time: 1.49426s. Valid time: 1.52305s
Wed, 25 Dec 2024 15:11:05 recommender.py[line:254] INFO Training: Epoch= 20 [recall@10=0.1778 ndcg@10=0.0930 train_loss=5.4379]
Wed, 25 Dec 2024 15:11:05 recommender.py[line:519] INFO Train time: 1.51168s. Valid time: 1.54222s
Wed, 25 Dec 2024 15:11:06 recommender.py[line:254] INFO Training: Epoch= 21 [recall@10=0.1746 ndcg@10=0.0801 train_loss=5.4239]
Wed, 25 Dec 2024 15:11:06 recommender.py[line:519] INFO Train time: 1.46557s. Valid time: 1.49581s
Wed, 25 Dec 2024 15:11:08 recommender.py[line:254] INFO Training: Epoch= 22 [recall@10=0.1841 ndcg@10=0.0822 train_loss=5.4125]
Wed, 25 Dec 2024 15:11:08 recommender.py[line:519] INFO Train time: 1.50716s. Valid time: 1.53451s
Wed, 25 Dec 2024 15:11:09 recommender.py[line:254] INFO Training: Epoch= 23 [recall@10=0.1905 ndcg@10=0.0876 train_loss=5.4022]
Wed, 25 Dec 2024 15:11:09 recommender.py[line:519] INFO Train time: 1.44429s. Valid time: 1.47244s
Wed, 25 Dec 2024 15:11:11 recommender.py[line:254] INFO Training: Epoch= 24 [recall@10=0.1810 ndcg@10=0.0867 train_loss=5.3958]
Wed, 25 Dec 2024 15:11:11 recommender.py[line:519] INFO Train time: 1.49582s. Valid time: 1.52188s
Wed, 25 Dec 2024 15:11:13 recommender.py[line:254] INFO Training: Epoch= 25 [recall@10=0.1778 ndcg@10=0.0853 train_loss=5.3831]
Wed, 25 Dec 2024 15:11:13 recommender.py[line:519] INFO Train time: 1.50725s. Valid time: 1.53766s
Wed, 25 Dec 2024 15:11:14 recommender.py[line:254] INFO Training: Epoch= 26 [recall@10=0.1937 ndcg@10=0.0860 train_loss=5.3773]
Wed, 25 Dec 2024 15:11:14 recommender.py[line:519] INFO Train time: 1.49908s. Valid time: 1.52315s
Wed, 25 Dec 2024 15:11:16 recommender.py[line:254] INFO Training: Epoch= 27 [recall@10=0.2063 ndcg@10=0.0956 train_loss=5.3641]
Wed, 25 Dec 2024 15:11:16 recommender.py[line:519] INFO Train time: 1.55878s. Valid time: 1.58853s
Wed, 25 Dec 2024 15:11:16 recommender.py[line:548] INFO recall@10 improved. Best value: 0.2063
Wed, 25 Dec 2024 15:11:17 recommender.py[line:254] INFO Training: Epoch= 28 [recall@10=0.1873 ndcg@10=0.0878 train_loss=5.3562]
Wed, 25 Dec 2024 15:11:17 recommender.py[line:519] INFO Train time: 1.45893s. Valid time: 1.48279s
Wed, 25 Dec 2024 15:11:19 recommender.py[line:254] INFO Training: Epoch= 29 [recall@10=0.1905 ndcg@10=0.0955 train_loss=5.3437]
Wed, 25 Dec 2024 15:11:19 recommender.py[line:519] INFO Train time: 1.36190s. Valid time: 1.38555s
Wed, 25 Dec 2024 15:11:20 recommender.py[line:254] INFO Training: Epoch= 30 [recall@10=0.2000 ndcg@10=0.0986 train_loss=5.3366]
Wed, 25 Dec 2024 15:11:20 recommender.py[line:519] INFO Train time: 1.28341s. Valid time: 1.30251s
Wed, 25 Dec 2024 15:11:21 recommender.py[line:254] INFO Training: Epoch= 31 [recall@10=0.2000 ndcg@10=0.0968 train_loss=5.3249]
Wed, 25 Dec 2024 15:11:21 recommender.py[line:519] INFO Train time: 1.35771s. Valid time: 1.38205s
Wed, 25 Dec 2024 15:11:23 recommender.py[line:254] INFO Training: Epoch= 32 [recall@10=0.2000 ndcg@10=0.1001 train_loss=5.3195]
Wed, 25 Dec 2024 15:11:23 recommender.py[line:519] INFO Train time: 1.26675s. Valid time: 1.29063s
Wed, 25 Dec 2024 15:11:24 recommender.py[line:254] INFO Training: Epoch= 33 [recall@10=0.2032 ndcg@10=0.0965 train_loss=5.3119]
Wed, 25 Dec 2024 15:11:24 recommender.py[line:519] INFO Train time: 1.10845s. Valid time: 1.13324s
Wed, 25 Dec 2024 15:11:25 recommender.py[line:254] INFO Training: Epoch= 34 [recall@10=0.1810 ndcg@10=0.0935 train_loss=5.3008]
Wed, 25 Dec 2024 15:11:25 recommender.py[line:519] INFO Train time: 1.13655s. Valid time: 1.16115s
Wed, 25 Dec 2024 15:11:26 recommender.py[line:254] INFO Training: Epoch= 35 [recall@10=0.1905 ndcg@10=0.0977 train_loss=5.3004]
Wed, 25 Dec 2024 15:11:26 recommender.py[line:519] INFO Train time: 1.11169s. Valid time: 1.13235s
Wed, 25 Dec 2024 15:11:27 recommender.py[line:254] INFO Training: Epoch= 36 [recall@10=0.1968 ndcg@10=0.0962 train_loss=5.2822]
Wed, 25 Dec 2024 15:11:27 recommender.py[line:519] INFO Train time: 1.19762s. Valid time: 1.22217s
Wed, 25 Dec 2024 15:11:28 recommender.py[line:254] INFO Training: Epoch= 37 [recall@10=0.1937 ndcg@10=0.0952 train_loss=5.2765]
Wed, 25 Dec 2024 15:11:28 recommender.py[line:519] INFO Train time: 1.20296s. Valid time: 1.22651s
Wed, 25 Dec 2024 15:11:30 recommender.py[line:254] INFO Training: Epoch= 38 [recall@10=0.1937 ndcg@10=0.1021 train_loss=5.2682]
Wed, 25 Dec 2024 15:11:30 recommender.py[line:519] INFO Train time: 1.13530s. Valid time: 1.16018s
Wed, 25 Dec 2024 15:11:31 recommender.py[line:254] INFO Training: Epoch= 39 [recall@10=0.1714 ndcg@10=0.0831 train_loss=5.2602]
Wed, 25 Dec 2024 15:11:31 recommender.py[line:519] INFO Train time: 1.16565s. Valid time: 1.19003s
Wed, 25 Dec 2024 15:11:32 recommender.py[line:254] INFO Training: Epoch= 40 [recall@10=0.1905 ndcg@10=0.0943 train_loss=5.2502]
Wed, 25 Dec 2024 15:11:32 recommender.py[line:519] INFO Train time: 1.14837s. Valid time: 1.17266s
Wed, 25 Dec 2024 15:11:33 recommender.py[line:254] INFO Training: Epoch= 41 [recall@10=0.1873 ndcg@10=0.0927 train_loss=5.2504]
Wed, 25 Dec 2024 15:11:33 recommender.py[line:519] INFO Train time: 1.26307s. Valid time: 1.28740s
Wed, 25 Dec 2024 15:11:34 recommender.py[line:254] INFO Training: Epoch= 42 [recall@10=0.1810 ndcg@10=0.0906 train_loss=5.2408]
Wed, 25 Dec 2024 15:11:34 recommender.py[line:519] INFO Train time: 1.20463s. Valid time: 1.23003s
Wed, 25 Dec 2024 15:11:36 recommender.py[line:254] INFO Training: Epoch= 43 [recall@10=0.1746 ndcg@10=0.0963 train_loss=5.2296]
Wed, 25 Dec 2024 15:11:36 recommender.py[line:519] INFO Train time: 1.15505s. Valid time: 1.17959s
Wed, 25 Dec 2024 15:11:37 recommender.py[line:254] INFO Training: Epoch= 44 [recall@10=0.2032 ndcg@10=0.0985 train_loss=5.2262]
Wed, 25 Dec 2024 15:11:37 recommender.py[line:519] INFO Train time: 1.20825s. Valid time: 1.23222s
Wed, 25 Dec 2024 15:11:38 recommender.py[line:254] INFO Training: Epoch= 45 [recall@10=0.1873 ndcg@10=0.0931 train_loss=5.2176]
Wed, 25 Dec 2024 15:11:38 recommender.py[line:519] INFO Train time: 1.14398s. Valid time: 1.16840s
Wed, 25 Dec 2024 15:11:39 recommender.py[line:254] INFO Training: Epoch= 46 [recall@10=0.1746 ndcg@10=0.0951 train_loss=5.2030]
Wed, 25 Dec 2024 15:11:39 recommender.py[line:519] INFO Train time: 1.20654s. Valid time: 1.23136s
Wed, 25 Dec 2024 15:11:40 recommender.py[line:254] INFO Training: Epoch= 47 [recall@10=0.1714 ndcg@10=0.0808 train_loss=5.2057]
Wed, 25 Dec 2024 15:11:40 recommender.py[line:519] INFO Train time: 1.20792s. Valid time: 1.23174s
Wed, 25 Dec 2024 15:11:40 recommender.py[line:559] INFO Early stopped. recall@10 didn't improve for 20 epochs.
Wed, 25 Dec 2024 15:11:40 recommender.py[line:562] INFO The best score of recall@10 is 0.2063 at 27
Wed, 25 Dec 2024 15:11:40 recommender.py[line:730] INFO Best model checkpoiny saved in ./metadata/model_checkpoint/shadow_model/ml-100k/BERT4Rec/split/train/nonmember_model_9.
Wed, 25 Dec 2024 15:11:40 shadow.py[line:57] INFO Shadow model recommendation performance:
Wed, 25 Dec 2024 15:11:41 recommender.py[line:196] INFO Testing:  [recall@10=0.1683 precision@10=0.0168 map@10=0.0657 ndcg@10=0.0894 mrr@10=0.0657 hit@10=0.1683]
Wed, 25 Dec 2024 15:11:45 shadow.py[line:292] INFO End of the code.
