Wed, 25 Dec 2024 15:09:00 shadow.py[line:150] INFO {'dataset': 'ml-100k', 'model': 'BERT4Rec', 'split_seed': 8, 'gpu': 2, 'split_cf': 'split', 'train_cf': 'train'}
Wed, 25 Dec 2024 15:09:00 utils.py[line:224] INFO dataset is read from ../datasets/ml-100k.
Wed, 25 Dec 2024 15:09:01 utils.py[line:38] INFO 
Dataset Info: 

==================================================
item information: 
field     item_id   
type      token     
##        1153      
==================================================
user information: 
field     user_id   
type      token     
##        944       
==================================================
interaction information: 
field     user_id   item_id   rating    timestamp 
type      token     token     float     float     
##        944       1153      -         -         
==================================================
Sparsity: 0.909832
==================================================
Wed, 25 Dec 2024 15:09:02 utils.py[line:297] INFO Global seed set to 2019
Wed, 25 Dec 2024 15:09:02 utils.py[line:62] INFO 
Model Config: 

accelerator=gpu
activation=gelu
ann=None
batch_size=1024
cutoff=10
dataset_neg_count=None
dataset_sampler=None
dropout=0.2
early_stop_mode=max
early_stop_patience=20
embed_dim=64
epochs=100
eval_batch_size=128
excluding_hist=False
gpu=[2]
head_num=2
hidden_size=128
item_bias=False
layer_norm_eps=1e-12
layer_num=2
learner=adam
learning_rate=0.001
mask_ratio=0.2
negative_count=1
num_workers=0
pooling_type=mask
save_path=./saved/
scheduler=None
seed=2019
split_ratio=2
steal=False
test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
test_repetitive=True
topk=100
train_repetitive=True
val_metrics=['recall', 'ndcg']
weight_decay=1e-05
Wed, 25 Dec 2024 15:09:02 utils.py[line:297] INFO Global seed set to 2019
Wed, 25 Dec 2024 15:09:02 utils.py[line:62] INFO 
Model Config: 

accelerator=gpu
activation=gelu
ann=None
batch_size=1024
cutoff=10
dataset_neg_count=None
dataset_sampler=None
dropout=0.2
early_stop_mode=max
early_stop_patience=20
embed_dim=64
epochs=100
eval_batch_size=128
excluding_hist=False
gpu=[2]
head_num=2
hidden_size=128
item_bias=False
layer_norm_eps=1e-12
layer_num=2
learner=adam
learning_rate=0.001
mask_ratio=0.2
negative_count=1
num_workers=0
pooling_type=mask
save_path=./saved/
scheduler=None
seed=2019
split_ratio=2
steal=False
test_metrics=['recall', 'precision', 'map', 'ndcg', 'mrr', 'hit']
test_repetitive=True
topk=100
train_repetitive=True
val_metrics=['recall', 'ndcg']
weight_decay=1e-05
Wed, 25 Dec 2024 15:09:02 recommender.py[line:128] INFO save_dir:/data1/home/zhihao/code/RecAudit/open-source/RecAudit/RecStudio-main
Wed, 25 Dec 2024 15:09:02 recommender.py[line:131] INFO BERT4Rec(
  (loss_fn): SoftmaxLoss()
  (score_func): InnerProductScorer()
  (item_encoder): Embedding(1154, 64, padding_idx=0)
  (query_encoder): BERT4RecQueryEncoder(
    (item_encoder): Embedding(1154, 64, padding_idx=0)
    (position_emb): Embedding(20, 64)
    (transformer_layer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
      )
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (training_pooling_layer): SeqPoolingLayer(pooling_type=mask, keepdim=False)
    (eval_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
  )
)
Wed, 25 Dec 2024 15:09:08 recommender.py[line:254] INFO Training: Epoch=  0 [recall@10=0.0510 ndcg@10=0.0187 train_loss=6.8079]
Wed, 25 Dec 2024 15:09:08 recommender.py[line:519] INFO Train time: 1.74798s. Valid time: 1.78888s
Wed, 25 Dec 2024 15:09:08 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0510
Wed, 25 Dec 2024 15:09:10 recommender.py[line:254] INFO Training: Epoch=  1 [recall@10=0.0382 ndcg@10=0.0175 train_loss=6.6059]
Wed, 25 Dec 2024 15:09:10 recommender.py[line:519] INFO Train time: 1.36680s. Valid time: 1.40886s
Wed, 25 Dec 2024 15:09:11 recommender.py[line:254] INFO Training: Epoch=  2 [recall@10=0.0955 ndcg@10=0.0415 train_loss=6.3546]
Wed, 25 Dec 2024 15:09:11 recommender.py[line:519] INFO Train time: 1.27939s. Valid time: 1.31841s
Wed, 25 Dec 2024 15:09:11 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0955
Wed, 25 Dec 2024 15:09:12 recommender.py[line:254] INFO Training: Epoch=  3 [recall@10=0.1497 ndcg@10=0.0696 train_loss=6.0578]
Wed, 25 Dec 2024 15:09:12 recommender.py[line:519] INFO Train time: 1.43859s. Valid time: 1.47371s
Wed, 25 Dec 2024 15:09:12 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1497
Wed, 25 Dec 2024 15:09:14 recommender.py[line:254] INFO Training: Epoch=  4 [recall@10=0.1306 ndcg@10=0.0606 train_loss=5.8920]
Wed, 25 Dec 2024 15:09:14 recommender.py[line:519] INFO Train time: 1.52314s. Valid time: 1.56434s
Wed, 25 Dec 2024 15:09:15 recommender.py[line:254] INFO Training: Epoch=  5 [recall@10=0.1306 ndcg@10=0.0599 train_loss=5.8097]
Wed, 25 Dec 2024 15:09:15 recommender.py[line:519] INFO Train time: 1.33455s. Valid time: 1.37193s
Wed, 25 Dec 2024 15:09:17 recommender.py[line:254] INFO Training: Epoch=  6 [recall@10=0.1561 ndcg@10=0.0660 train_loss=5.7442]
Wed, 25 Dec 2024 15:09:17 recommender.py[line:519] INFO Train time: 1.48371s. Valid time: 1.51198s
Wed, 25 Dec 2024 15:09:17 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1561
Wed, 25 Dec 2024 15:09:18 recommender.py[line:254] INFO Training: Epoch=  7 [recall@10=0.1433 ndcg@10=0.0650 train_loss=5.6929]
Wed, 25 Dec 2024 15:09:18 recommender.py[line:519] INFO Train time: 1.36959s. Valid time: 1.39303s
Wed, 25 Dec 2024 15:09:20 recommender.py[line:254] INFO Training: Epoch=  8 [recall@10=0.1433 ndcg@10=0.0634 train_loss=5.6449]
Wed, 25 Dec 2024 15:09:20 recommender.py[line:519] INFO Train time: 1.42036s. Valid time: 1.45232s
Wed, 25 Dec 2024 15:09:21 recommender.py[line:254] INFO Training: Epoch=  9 [recall@10=0.1338 ndcg@10=0.0641 train_loss=5.6128]
Wed, 25 Dec 2024 15:09:21 recommender.py[line:519] INFO Train time: 1.47988s. Valid time: 1.51862s
Wed, 25 Dec 2024 15:09:23 recommender.py[line:254] INFO Training: Epoch= 10 [recall@10=0.1465 ndcg@10=0.0686 train_loss=5.5902]
Wed, 25 Dec 2024 15:09:23 recommender.py[line:519] INFO Train time: 1.33612s. Valid time: 1.37590s
Wed, 25 Dec 2024 15:09:24 recommender.py[line:254] INFO Training: Epoch= 11 [recall@10=0.1465 ndcg@10=0.0647 train_loss=5.5725]
Wed, 25 Dec 2024 15:09:24 recommender.py[line:519] INFO Train time: 1.35716s. Valid time: 1.39743s
Wed, 25 Dec 2024 15:09:25 recommender.py[line:254] INFO Training: Epoch= 12 [recall@10=0.1401 ndcg@10=0.0689 train_loss=5.5589]
Wed, 25 Dec 2024 15:09:25 recommender.py[line:519] INFO Train time: 1.28245s. Valid time: 1.32194s
Wed, 25 Dec 2024 15:09:27 recommender.py[line:254] INFO Training: Epoch= 13 [recall@10=0.1401 ndcg@10=0.0701 train_loss=5.5403]
Wed, 25 Dec 2024 15:09:27 recommender.py[line:519] INFO Train time: 1.35921s. Valid time: 1.39931s
Wed, 25 Dec 2024 15:09:28 recommender.py[line:254] INFO Training: Epoch= 14 [recall@10=0.1497 ndcg@10=0.0746 train_loss=5.5232]
Wed, 25 Dec 2024 15:09:28 recommender.py[line:519] INFO Train time: 1.30714s. Valid time: 1.34295s
Wed, 25 Dec 2024 15:09:30 recommender.py[line:254] INFO Training: Epoch= 15 [recall@10=0.1369 ndcg@10=0.0674 train_loss=5.5146]
Wed, 25 Dec 2024 15:09:30 recommender.py[line:519] INFO Train time: 1.36639s. Valid time: 1.40892s
Wed, 25 Dec 2024 15:09:31 recommender.py[line:254] INFO Training: Epoch= 16 [recall@10=0.1592 ndcg@10=0.0780 train_loss=5.4913]
Wed, 25 Dec 2024 15:09:31 recommender.py[line:519] INFO Train time: 1.36086s. Valid time: 1.39221s
Wed, 25 Dec 2024 15:09:31 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1592
Wed, 25 Dec 2024 15:09:32 recommender.py[line:254] INFO Training: Epoch= 17 [recall@10=0.1497 ndcg@10=0.0797 train_loss=5.4864]
Wed, 25 Dec 2024 15:09:32 recommender.py[line:519] INFO Train time: 1.27862s. Valid time: 1.31710s
Wed, 25 Dec 2024 15:09:34 recommender.py[line:254] INFO Training: Epoch= 18 [recall@10=0.1561 ndcg@10=0.0758 train_loss=5.4738]
Wed, 25 Dec 2024 15:09:34 recommender.py[line:519] INFO Train time: 1.36709s. Valid time: 1.39922s
Wed, 25 Dec 2024 15:09:35 recommender.py[line:254] INFO Training: Epoch= 19 [recall@10=0.1688 ndcg@10=0.0809 train_loss=5.4580]
Wed, 25 Dec 2024 15:09:35 recommender.py[line:519] INFO Train time: 1.32542s. Valid time: 1.37298s
Wed, 25 Dec 2024 15:09:35 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1688
Wed, 25 Dec 2024 15:09:37 recommender.py[line:254] INFO Training: Epoch= 20 [recall@10=0.1752 ndcg@10=0.0885 train_loss=5.4504]
Wed, 25 Dec 2024 15:09:37 recommender.py[line:519] INFO Train time: 1.51107s. Valid time: 1.54972s
Wed, 25 Dec 2024 15:09:37 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1752
Wed, 25 Dec 2024 15:09:38 recommender.py[line:254] INFO Training: Epoch= 21 [recall@10=0.1624 ndcg@10=0.0818 train_loss=5.4400]
Wed, 25 Dec 2024 15:09:38 recommender.py[line:519] INFO Train time: 1.28320s. Valid time: 1.32813s
Wed, 25 Dec 2024 15:09:39 recommender.py[line:254] INFO Training: Epoch= 22 [recall@10=0.1752 ndcg@10=0.0848 train_loss=5.4270]
Wed, 25 Dec 2024 15:09:39 recommender.py[line:519] INFO Train time: 1.44356s. Valid time: 1.48596s
Wed, 25 Dec 2024 15:09:41 recommender.py[line:254] INFO Training: Epoch= 23 [recall@10=0.1656 ndcg@10=0.0783 train_loss=5.4264]
Wed, 25 Dec 2024 15:09:41 recommender.py[line:519] INFO Train time: 1.43682s. Valid time: 1.47018s
Wed, 25 Dec 2024 15:09:42 recommender.py[line:254] INFO Training: Epoch= 24 [recall@10=0.1592 ndcg@10=0.0774 train_loss=5.4204]
Wed, 25 Dec 2024 15:09:42 recommender.py[line:519] INFO Train time: 1.45751s. Valid time: 1.49756s
Wed, 25 Dec 2024 15:09:44 recommender.py[line:254] INFO Training: Epoch= 25 [recall@10=0.1465 ndcg@10=0.0723 train_loss=5.4066]
Wed, 25 Dec 2024 15:09:44 recommender.py[line:519] INFO Train time: 1.45086s. Valid time: 1.49281s
Wed, 25 Dec 2024 15:09:45 recommender.py[line:254] INFO Training: Epoch= 26 [recall@10=0.1433 ndcg@10=0.0745 train_loss=5.3985]
Wed, 25 Dec 2024 15:09:45 recommender.py[line:519] INFO Train time: 1.53754s. Valid time: 1.57147s
Wed, 25 Dec 2024 15:09:47 recommender.py[line:254] INFO Training: Epoch= 27 [recall@10=0.1529 ndcg@10=0.0755 train_loss=5.3837]
Wed, 25 Dec 2024 15:09:47 recommender.py[line:519] INFO Train time: 1.37222s. Valid time: 1.40404s
Wed, 25 Dec 2024 15:09:48 recommender.py[line:254] INFO Training: Epoch= 28 [recall@10=0.1433 ndcg@10=0.0704 train_loss=5.3820]
Wed, 25 Dec 2024 15:09:48 recommender.py[line:519] INFO Train time: 1.43048s. Valid time: 1.45572s
Wed, 25 Dec 2024 15:09:50 recommender.py[line:254] INFO Training: Epoch= 29 [recall@10=0.1433 ndcg@10=0.0738 train_loss=5.3657]
Wed, 25 Dec 2024 15:09:50 recommender.py[line:519] INFO Train time: 1.27262s. Valid time: 1.30920s
Wed, 25 Dec 2024 15:09:51 recommender.py[line:254] INFO Training: Epoch= 30 [recall@10=0.1529 ndcg@10=0.0725 train_loss=5.3648]
Wed, 25 Dec 2024 15:09:51 recommender.py[line:519] INFO Train time: 1.39096s. Valid time: 1.41455s
Wed, 25 Dec 2024 15:09:53 recommender.py[line:254] INFO Training: Epoch= 31 [recall@10=0.1401 ndcg@10=0.0708 train_loss=5.3520]
Wed, 25 Dec 2024 15:09:53 recommender.py[line:519] INFO Train time: 1.43401s. Valid time: 1.46521s
Wed, 25 Dec 2024 15:09:54 recommender.py[line:254] INFO Training: Epoch= 32 [recall@10=0.1656 ndcg@10=0.0771 train_loss=5.3481]
Wed, 25 Dec 2024 15:09:54 recommender.py[line:519] INFO Train time: 1.39715s. Valid time: 1.42629s
Wed, 25 Dec 2024 15:09:55 recommender.py[line:254] INFO Training: Epoch= 33 [recall@10=0.1624 ndcg@10=0.0816 train_loss=5.3347]
Wed, 25 Dec 2024 15:09:55 recommender.py[line:519] INFO Train time: 1.40225s. Valid time: 1.42793s
Wed, 25 Dec 2024 15:09:57 recommender.py[line:254] INFO Training: Epoch= 34 [recall@10=0.1529 ndcg@10=0.0748 train_loss=5.3317]
Wed, 25 Dec 2024 15:09:57 recommender.py[line:519] INFO Train time: 1.28891s. Valid time: 1.32498s
Wed, 25 Dec 2024 15:09:58 recommender.py[line:254] INFO Training: Epoch= 35 [recall@10=0.1433 ndcg@10=0.0772 train_loss=5.3132]
Wed, 25 Dec 2024 15:09:58 recommender.py[line:519] INFO Train time: 1.40657s. Valid time: 1.44476s
Wed, 25 Dec 2024 15:09:59 recommender.py[line:254] INFO Training: Epoch= 36 [recall@10=0.1497 ndcg@10=0.0741 train_loss=5.3058]
Wed, 25 Dec 2024 15:09:59 recommender.py[line:519] INFO Train time: 1.28418s. Valid time: 1.32733s
Wed, 25 Dec 2024 15:10:01 recommender.py[line:254] INFO Training: Epoch= 37 [recall@10=0.1529 ndcg@10=0.0814 train_loss=5.3022]
Wed, 25 Dec 2024 15:10:01 recommender.py[line:519] INFO Train time: 1.34727s. Valid time: 1.37731s
Wed, 25 Dec 2024 15:10:02 recommender.py[line:254] INFO Training: Epoch= 38 [recall@10=0.1497 ndcg@10=0.0768 train_loss=5.2980]
Wed, 25 Dec 2024 15:10:02 recommender.py[line:519] INFO Train time: 1.36060s. Valid time: 1.39851s
Wed, 25 Dec 2024 15:10:04 recommender.py[line:254] INFO Training: Epoch= 39 [recall@10=0.1592 ndcg@10=0.0815 train_loss=5.2838]
Wed, 25 Dec 2024 15:10:04 recommender.py[line:519] INFO Train time: 1.34206s. Valid time: 1.38017s
Wed, 25 Dec 2024 15:10:05 recommender.py[line:254] INFO Training: Epoch= 40 [recall@10=0.1465 ndcg@10=0.0756 train_loss=5.2758]
Wed, 25 Dec 2024 15:10:05 recommender.py[line:519] INFO Train time: 1.39203s. Valid time: 1.42584s
Wed, 25 Dec 2024 15:10:05 recommender.py[line:559] INFO Early stopped. recall@10 didn't improve for 20 epochs.
Wed, 25 Dec 2024 15:10:05 recommender.py[line:562] INFO The best score of recall@10 is 0.1752 at 20
Wed, 25 Dec 2024 15:10:05 recommender.py[line:730] INFO Best model checkpoiny saved in ./metadata/model_checkpoint/shadow_model/ml-100k/BERT4Rec/split/train/member_model_8.
Wed, 25 Dec 2024 15:10:05 shadow.py[line:57] INFO Shadow model recommendation performance:
Wed, 25 Dec 2024 15:10:05 recommender.py[line:196] INFO Testing:  [recall@10=0.1592 precision@10=0.0159 map@10=0.0570 ndcg@10=0.0803 mrr@10=0.0570 hit@10=0.1592]
Wed, 25 Dec 2024 15:10:05 recommender.py[line:128] INFO save_dir:/data1/home/zhihao/code/RecAudit/open-source/RecAudit/RecStudio-main
Wed, 25 Dec 2024 15:10:05 recommender.py[line:131] INFO BERT4Rec(
  (loss_fn): SoftmaxLoss()
  (score_func): InnerProductScorer()
  (item_encoder): Embedding(1154, 64, padding_idx=0)
  (query_encoder): BERT4RecQueryEncoder(
    (item_encoder): Embedding(1154, 64, padding_idx=0)
    (position_emb): Embedding(20, 64)
    (transformer_layer): TransformerEncoder(
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=64, out_features=64, bias=True)
          )
          (linear1): Linear(in_features=64, out_features=128, bias=True)
          (dropout): Dropout(p=0.2, inplace=False)
          (linear2): Linear(in_features=128, out_features=64, bias=True)
          (norm1): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (norm2): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (dropout1): Dropout(p=0.2, inplace=False)
          (dropout2): Dropout(p=0.2, inplace=False)
        )
      )
    )
    (dropout): Dropout(p=0.2, inplace=False)
    (training_pooling_layer): SeqPoolingLayer(pooling_type=mask, keepdim=False)
    (eval_pooling_layer): SeqPoolingLayer(pooling_type=last, keepdim=False)
  )
)
Wed, 25 Dec 2024 15:10:07 recommender.py[line:254] INFO Training: Epoch=  0 [recall@10=0.0571 ndcg@10=0.0370 train_loss=6.7990]
Wed, 25 Dec 2024 15:10:07 recommender.py[line:519] INFO Train time: 1.38162s. Valid time: 1.41633s
Wed, 25 Dec 2024 15:10:07 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0571
Wed, 25 Dec 2024 15:10:08 recommender.py[line:254] INFO Training: Epoch=  1 [recall@10=0.0698 ndcg@10=0.0394 train_loss=6.5704]
Wed, 25 Dec 2024 15:10:08 recommender.py[line:519] INFO Train time: 1.45745s. Valid time: 1.49182s
Wed, 25 Dec 2024 15:10:08 recommender.py[line:548] INFO recall@10 improved. Best value: 0.0698
Wed, 25 Dec 2024 15:10:10 recommender.py[line:254] INFO Training: Epoch=  2 [recall@10=0.1143 ndcg@10=0.0552 train_loss=6.2629]
Wed, 25 Dec 2024 15:10:10 recommender.py[line:519] INFO Train time: 1.49039s. Valid time: 1.52240s
Wed, 25 Dec 2024 15:10:10 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1143
Wed, 25 Dec 2024 15:10:11 recommender.py[line:254] INFO Training: Epoch=  3 [recall@10=0.1397 ndcg@10=0.0696 train_loss=6.0260]
Wed, 25 Dec 2024 15:10:11 recommender.py[line:519] INFO Train time: 1.42465s. Valid time: 1.45364s
Wed, 25 Dec 2024 15:10:11 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1397
Wed, 25 Dec 2024 15:10:13 recommender.py[line:254] INFO Training: Epoch=  4 [recall@10=0.1270 ndcg@10=0.0721 train_loss=5.9110]
Wed, 25 Dec 2024 15:10:13 recommender.py[line:519] INFO Train time: 1.44119s. Valid time: 1.47379s
Wed, 25 Dec 2024 15:10:14 recommender.py[line:254] INFO Training: Epoch=  5 [recall@10=0.1397 ndcg@10=0.0831 train_loss=5.8320]
Wed, 25 Dec 2024 15:10:14 recommender.py[line:519] INFO Train time: 1.43537s. Valid time: 1.46997s
Wed, 25 Dec 2024 15:10:16 recommender.py[line:254] INFO Training: Epoch=  6 [recall@10=0.1492 ndcg@10=0.0773 train_loss=5.7729]
Wed, 25 Dec 2024 15:10:16 recommender.py[line:519] INFO Train time: 1.57072s. Valid time: 1.60356s
Wed, 25 Dec 2024 15:10:16 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1492
Wed, 25 Dec 2024 15:10:18 recommender.py[line:254] INFO Training: Epoch=  7 [recall@10=0.1587 ndcg@10=0.0772 train_loss=5.7278]
Wed, 25 Dec 2024 15:10:18 recommender.py[line:519] INFO Train time: 1.81179s. Valid time: 1.85069s
Wed, 25 Dec 2024 15:10:18 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1587
Wed, 25 Dec 2024 15:10:19 recommender.py[line:254] INFO Training: Epoch=  8 [recall@10=0.1746 ndcg@10=0.0854 train_loss=5.6789]
Wed, 25 Dec 2024 15:10:19 recommender.py[line:519] INFO Train time: 1.81809s. Valid time: 1.86302s
Wed, 25 Dec 2024 15:10:19 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1746
Wed, 25 Dec 2024 15:10:21 recommender.py[line:254] INFO Training: Epoch=  9 [recall@10=0.1778 ndcg@10=0.0939 train_loss=5.6415]
Wed, 25 Dec 2024 15:10:21 recommender.py[line:519] INFO Train time: 1.84291s. Valid time: 1.88997s
Wed, 25 Dec 2024 15:10:21 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1778
Wed, 25 Dec 2024 15:10:23 recommender.py[line:254] INFO Training: Epoch= 10 [recall@10=0.1778 ndcg@10=0.0966 train_loss=5.6152]
Wed, 25 Dec 2024 15:10:23 recommender.py[line:519] INFO Train time: 1.51211s. Valid time: 1.54473s
Wed, 25 Dec 2024 15:10:24 recommender.py[line:254] INFO Training: Epoch= 11 [recall@10=0.1714 ndcg@10=0.0879 train_loss=5.5917]
Wed, 25 Dec 2024 15:10:24 recommender.py[line:519] INFO Train time: 1.43172s. Valid time: 1.46992s
Wed, 25 Dec 2024 15:10:26 recommender.py[line:254] INFO Training: Epoch= 12 [recall@10=0.1810 ndcg@10=0.0894 train_loss=5.5736]
Wed, 25 Dec 2024 15:10:26 recommender.py[line:519] INFO Train time: 1.44499s. Valid time: 1.49261s
Wed, 25 Dec 2024 15:10:26 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1810
Wed, 25 Dec 2024 15:10:27 recommender.py[line:254] INFO Training: Epoch= 13 [recall@10=0.1683 ndcg@10=0.1000 train_loss=5.5564]
Wed, 25 Dec 2024 15:10:27 recommender.py[line:519] INFO Train time: 1.49954s. Valid time: 1.53675s
Wed, 25 Dec 2024 15:10:29 recommender.py[line:254] INFO Training: Epoch= 14 [recall@10=0.1841 ndcg@10=0.0966 train_loss=5.5298]
Wed, 25 Dec 2024 15:10:29 recommender.py[line:519] INFO Train time: 1.52029s. Valid time: 1.55274s
Wed, 25 Dec 2024 15:10:29 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1841
Wed, 25 Dec 2024 15:10:30 recommender.py[line:254] INFO Training: Epoch= 15 [recall@10=0.1778 ndcg@10=0.0922 train_loss=5.5099]
Wed, 25 Dec 2024 15:10:30 recommender.py[line:519] INFO Train time: 1.35467s. Valid time: 1.39027s
Wed, 25 Dec 2024 15:10:32 recommender.py[line:254] INFO Training: Epoch= 16 [recall@10=0.1810 ndcg@10=0.1010 train_loss=5.4955]
Wed, 25 Dec 2024 15:10:32 recommender.py[line:519] INFO Train time: 1.41921s. Valid time: 1.44261s
Wed, 25 Dec 2024 15:10:33 recommender.py[line:254] INFO Training: Epoch= 17 [recall@10=0.1968 ndcg@10=0.1001 train_loss=5.4758]
Wed, 25 Dec 2024 15:10:33 recommender.py[line:519] INFO Train time: 1.32843s. Valid time: 1.36877s
Wed, 25 Dec 2024 15:10:33 recommender.py[line:548] INFO recall@10 improved. Best value: 0.1968
Wed, 25 Dec 2024 15:10:35 recommender.py[line:254] INFO Training: Epoch= 18 [recall@10=0.1968 ndcg@10=0.0986 train_loss=5.4748]
Wed, 25 Dec 2024 15:10:35 recommender.py[line:519] INFO Train time: 1.39855s. Valid time: 1.43435s
Wed, 25 Dec 2024 15:10:36 recommender.py[line:254] INFO Training: Epoch= 19 [recall@10=0.1937 ndcg@10=0.0997 train_loss=5.4595]
Wed, 25 Dec 2024 15:10:36 recommender.py[line:519] INFO Train time: 1.39009s. Valid time: 1.42584s
Wed, 25 Dec 2024 15:10:37 recommender.py[line:254] INFO Training: Epoch= 20 [recall@10=0.1810 ndcg@10=0.0909 train_loss=5.4393]
Wed, 25 Dec 2024 15:10:37 recommender.py[line:519] INFO Train time: 1.32228s. Valid time: 1.35795s
Wed, 25 Dec 2024 15:10:39 recommender.py[line:254] INFO Training: Epoch= 21 [recall@10=0.1810 ndcg@10=0.0950 train_loss=5.4344]
Wed, 25 Dec 2024 15:10:39 recommender.py[line:519] INFO Train time: 1.40386s. Valid time: 1.43362s
Wed, 25 Dec 2024 15:10:40 recommender.py[line:254] INFO Training: Epoch= 22 [recall@10=0.1714 ndcg@10=0.0914 train_loss=5.4204]
Wed, 25 Dec 2024 15:10:40 recommender.py[line:519] INFO Train time: 1.33106s. Valid time: 1.36980s
Wed, 25 Dec 2024 15:10:42 recommender.py[line:254] INFO Training: Epoch= 23 [recall@10=0.1937 ndcg@10=0.0962 train_loss=5.4082]
Wed, 25 Dec 2024 15:10:42 recommender.py[line:519] INFO Train time: 1.41326s. Valid time: 1.44012s
Wed, 25 Dec 2024 15:10:43 recommender.py[line:254] INFO Training: Epoch= 24 [recall@10=0.1905 ndcg@10=0.1005 train_loss=5.4008]
Wed, 25 Dec 2024 15:10:43 recommender.py[line:519] INFO Train time: 1.40672s. Valid time: 1.43919s
Wed, 25 Dec 2024 15:10:44 recommender.py[line:254] INFO Training: Epoch= 25 [recall@10=0.1810 ndcg@10=0.0985 train_loss=5.3909]
Wed, 25 Dec 2024 15:10:44 recommender.py[line:519] INFO Train time: 1.32998s. Valid time: 1.36729s
Wed, 25 Dec 2024 15:10:46 recommender.py[line:254] INFO Training: Epoch= 26 [recall@10=0.1905 ndcg@10=0.0996 train_loss=5.3779]
Wed, 25 Dec 2024 15:10:46 recommender.py[line:519] INFO Train time: 1.43846s. Valid time: 1.47191s
Wed, 25 Dec 2024 15:10:47 recommender.py[line:254] INFO Training: Epoch= 27 [recall@10=0.2000 ndcg@10=0.1025 train_loss=5.3742]
Wed, 25 Dec 2024 15:10:47 recommender.py[line:519] INFO Train time: 1.25683s. Valid time: 1.29198s
Wed, 25 Dec 2024 15:10:47 recommender.py[line:548] INFO recall@10 improved. Best value: 0.2000
Wed, 25 Dec 2024 15:10:48 recommender.py[line:254] INFO Training: Epoch= 28 [recall@10=0.1873 ndcg@10=0.0972 train_loss=5.3633]
Wed, 25 Dec 2024 15:10:48 recommender.py[line:519] INFO Train time: 1.34340s. Valid time: 1.37410s
Wed, 25 Dec 2024 15:10:50 recommender.py[line:254] INFO Training: Epoch= 29 [recall@10=0.2032 ndcg@10=0.1034 train_loss=5.3555]
Wed, 25 Dec 2024 15:10:50 recommender.py[line:519] INFO Train time: 1.36092s. Valid time: 1.39109s
Wed, 25 Dec 2024 15:10:50 recommender.py[line:548] INFO recall@10 improved. Best value: 0.2032
Wed, 25 Dec 2024 15:10:51 recommender.py[line:254] INFO Training: Epoch= 30 [recall@10=0.1905 ndcg@10=0.0966 train_loss=5.3501]
Wed, 25 Dec 2024 15:10:51 recommender.py[line:519] INFO Train time: 1.19523s. Valid time: 1.22451s
Wed, 25 Dec 2024 15:10:52 recommender.py[line:254] INFO Training: Epoch= 31 [recall@10=0.2063 ndcg@10=0.1056 train_loss=5.3361]
Wed, 25 Dec 2024 15:10:52 recommender.py[line:519] INFO Train time: 1.29257s. Valid time: 1.31976s
Wed, 25 Dec 2024 15:10:52 recommender.py[line:548] INFO recall@10 improved. Best value: 0.2063
Wed, 25 Dec 2024 15:10:54 recommender.py[line:254] INFO Training: Epoch= 32 [recall@10=0.1968 ndcg@10=0.1033 train_loss=5.3291]
Wed, 25 Dec 2024 15:10:54 recommender.py[line:519] INFO Train time: 1.19239s. Valid time: 1.21929s
Wed, 25 Dec 2024 15:10:55 recommender.py[line:254] INFO Training: Epoch= 33 [recall@10=0.1873 ndcg@10=0.1008 train_loss=5.3203]
Wed, 25 Dec 2024 15:10:55 recommender.py[line:519] INFO Train time: 1.23514s. Valid time: 1.25903s
Wed, 25 Dec 2024 15:10:56 recommender.py[line:254] INFO Training: Epoch= 34 [recall@10=0.2000 ndcg@10=0.1085 train_loss=5.3168]
Wed, 25 Dec 2024 15:10:56 recommender.py[line:519] INFO Train time: 1.22703s. Valid time: 1.24629s
Wed, 25 Dec 2024 15:10:57 recommender.py[line:254] INFO Training: Epoch= 35 [recall@10=0.1841 ndcg@10=0.1062 train_loss=5.3073]
Wed, 25 Dec 2024 15:10:57 recommender.py[line:519] INFO Train time: 1.16498s. Valid time: 1.19414s
Wed, 25 Dec 2024 15:10:59 recommender.py[line:254] INFO Training: Epoch= 36 [recall@10=0.1937 ndcg@10=0.1106 train_loss=5.2989]
Wed, 25 Dec 2024 15:10:59 recommender.py[line:519] INFO Train time: 1.28751s. Valid time: 1.31702s
Wed, 25 Dec 2024 15:11:00 recommender.py[line:254] INFO Training: Epoch= 37 [recall@10=0.2000 ndcg@10=0.1079 train_loss=5.2958]
Wed, 25 Dec 2024 15:11:00 recommender.py[line:519] INFO Train time: 1.13885s. Valid time: 1.16537s
Wed, 25 Dec 2024 15:11:01 recommender.py[line:254] INFO Training: Epoch= 38 [recall@10=0.1937 ndcg@10=0.1065 train_loss=5.2852]
Wed, 25 Dec 2024 15:11:01 recommender.py[line:519] INFO Train time: 1.20415s. Valid time: 1.23481s
Wed, 25 Dec 2024 15:11:02 recommender.py[line:254] INFO Training: Epoch= 39 [recall@10=0.1905 ndcg@10=0.1139 train_loss=5.2837]
Wed, 25 Dec 2024 15:11:02 recommender.py[line:519] INFO Train time: 1.22253s. Valid time: 1.24191s
Wed, 25 Dec 2024 15:11:04 recommender.py[line:254] INFO Training: Epoch= 40 [recall@10=0.1937 ndcg@10=0.1049 train_loss=5.2755]
Wed, 25 Dec 2024 15:11:04 recommender.py[line:519] INFO Train time: 1.17573s. Valid time: 1.20238s
Wed, 25 Dec 2024 15:11:05 recommender.py[line:254] INFO Training: Epoch= 41 [recall@10=0.1968 ndcg@10=0.1021 train_loss=5.2649]
Wed, 25 Dec 2024 15:11:05 recommender.py[line:519] INFO Train time: 1.23212s. Valid time: 1.25313s
Wed, 25 Dec 2024 15:11:06 recommender.py[line:254] INFO Training: Epoch= 42 [recall@10=0.1778 ndcg@10=0.0994 train_loss=5.2661]
Wed, 25 Dec 2024 15:11:06 recommender.py[line:519] INFO Train time: 1.23133s. Valid time: 1.25783s
Wed, 25 Dec 2024 15:11:07 recommender.py[line:254] INFO Training: Epoch= 43 [recall@10=0.1841 ndcg@10=0.1021 train_loss=5.2527]
Wed, 25 Dec 2024 15:11:07 recommender.py[line:519] INFO Train time: 1.26914s. Valid time: 1.29382s
Wed, 25 Dec 2024 15:11:09 recommender.py[line:254] INFO Training: Epoch= 44 [recall@10=0.2032 ndcg@10=0.1058 train_loss=5.2399]
Wed, 25 Dec 2024 15:11:09 recommender.py[line:519] INFO Train time: 1.29399s. Valid time: 1.31768s
Wed, 25 Dec 2024 15:11:10 recommender.py[line:254] INFO Training: Epoch= 45 [recall@10=0.1810 ndcg@10=0.1025 train_loss=5.2448]
Wed, 25 Dec 2024 15:11:10 recommender.py[line:519] INFO Train time: 1.19322s. Valid time: 1.21590s
Wed, 25 Dec 2024 15:11:11 recommender.py[line:254] INFO Training: Epoch= 46 [recall@10=0.2032 ndcg@10=0.1038 train_loss=5.2313]
Wed, 25 Dec 2024 15:11:11 recommender.py[line:519] INFO Train time: 1.22348s. Valid time: 1.24443s
Wed, 25 Dec 2024 15:11:12 recommender.py[line:254] INFO Training: Epoch= 47 [recall@10=0.1810 ndcg@10=0.0972 train_loss=5.2212]
Wed, 25 Dec 2024 15:11:12 recommender.py[line:519] INFO Train time: 1.12507s. Valid time: 1.14995s
Wed, 25 Dec 2024 15:11:13 recommender.py[line:254] INFO Training: Epoch= 48 [recall@10=0.1937 ndcg@10=0.0989 train_loss=5.2238]
Wed, 25 Dec 2024 15:11:13 recommender.py[line:519] INFO Train time: 1.17819s. Valid time: 1.19604s
Wed, 25 Dec 2024 15:11:15 recommender.py[line:254] INFO Training: Epoch= 49 [recall@10=0.1683 ndcg@10=0.0955 train_loss=5.2143]
Wed, 25 Dec 2024 15:11:15 recommender.py[line:519] INFO Train time: 1.26949s. Valid time: 1.29399s
Wed, 25 Dec 2024 15:11:16 recommender.py[line:254] INFO Training: Epoch= 50 [recall@10=0.1778 ndcg@10=0.0977 train_loss=5.2062]
Wed, 25 Dec 2024 15:11:16 recommender.py[line:519] INFO Train time: 1.19671s. Valid time: 1.21861s
Wed, 25 Dec 2024 15:11:17 recommender.py[line:254] INFO Training: Epoch= 51 [recall@10=0.1841 ndcg@10=0.0949 train_loss=5.1998]
Wed, 25 Dec 2024 15:11:17 recommender.py[line:519] INFO Train time: 1.30350s. Valid time: 1.32746s
Wed, 25 Dec 2024 15:11:17 recommender.py[line:559] INFO Early stopped. recall@10 didn't improve for 20 epochs.
Wed, 25 Dec 2024 15:11:17 recommender.py[line:562] INFO The best score of recall@10 is 0.2063 at 31
Wed, 25 Dec 2024 15:11:17 recommender.py[line:730] INFO Best model checkpoiny saved in ./metadata/model_checkpoint/shadow_model/ml-100k/BERT4Rec/split/train/nonmember_model_8.
Wed, 25 Dec 2024 15:11:17 shadow.py[line:57] INFO Shadow model recommendation performance:
Wed, 25 Dec 2024 15:11:17 recommender.py[line:196] INFO Testing:  [recall@10=0.1905 precision@10=0.0190 map@10=0.0683 ndcg@10=0.0967 mrr@10=0.0683 hit@10=0.1905]
Wed, 25 Dec 2024 15:11:22 shadow.py[line:292] INFO End of the code.
